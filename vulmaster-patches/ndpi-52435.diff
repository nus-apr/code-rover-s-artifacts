diff --git a/fuzz/fuzz_process_packet.c b/fuzz/fuzz_process_packet.c
index eb5a0a28..289fcfa6 100644
--- a/fuzz/fuzz_process_packet.c
+++ b/fuzz/fuzz_process_packet.c
@@ -7,9 +7,7 @@ struct ndpi_detection_module_struct *ndpi_info_mod = NULL;
 static ndpi_serializer json_serializer = {};
 static ndpi_serializer csv_serializer = {};
 
-int LLVMFuzzerTestOneInput(const uint8_t *Data, size_t Size) {
-  uint8_t protocol_was_guessed;
-
+ ) { return NULL ; } if ( size > SIZE_MAX ) { return opj_malloc_max ( size ) ; } if ( malloc == NULL ) { return NULL ; } 
   if (ndpi_info_mod == NULL) {
     ndpi_info_mod = ndpi_init_detection_module(ndpi_enable_ja3_plus);
     NDPI_PROTOCOL_BITMASK all, debug_bitmask;
