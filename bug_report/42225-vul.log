INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2273791313
INFO: Loaded 2 modules   (169937 inline 8-bit counters): 141709 [0x98bb620, 0x98ddfad), 28228 [0xf34b5d00, 0xf34bcb44), 
INFO: Loaded 2 PC tables (169937 PCs): 141709 [0x98ddfb0,0x99f2c18), 28228 [0xf34bcb44,0xf34f3d64), 
/out/php-fuzz-tracing-jit: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: heap-use-after-free on address 0xf4104d8c at pc 0xf33e34dc bp 0xffc2cd68 sp 0xffc2cd60
READ of size 4 at 0xf4104d8c thread T0
SCARINESS: 45 (4-byte-read-heap-use-after-free)
LLVMSymbolizer: error reading file: No such file or directory
    #0 0xf33e34db in zend_jit_fast_concat_tmp_helper /src/php-src/ext/opcache/jit/zend_jit_helpers.c:1203:19
    #1 0xe2e01425  (/dev/zero (deleted)+0x8001425)
    #2 0x8b57984 in zend_call_function /src/php-src/Zend/zend_execute_API.c:903:3
    #3 0x8b5a692 in zend_call_known_function /src/php-src/Zend/zend_execute_API.c:992:23
    #4 0x8f5f8a3 in zend_call_known_instance_method /src/php-src/Zend/zend_API.h:666:2
    #5 0x8f5f8a3 in zend_call_known_instance_method_with_0_params /src/php-src/Zend/zend_API.h:672:2
    #6 0x8f5f8a3 in zend_std_cast_object_tostring /src/php-src/Zend/zend_object_handlers.c:1828:5
    #7 0x8bbc18d in zend_parse_arg_str_weak /src/php-src/Zend/zend_API.c:660:7
    #8 0x8c4581c in zend_verify_weak_scalar_type_hint /src/php-src/Zend/zend_execute.c:737:37
    #9 0x8c46e31 in zend_verify_scalar_type_hint /src/php-src/Zend/zend_execute.c:804:9
    #10 0x8c46e31 in i_zend_check_property_type /src/php-src/Zend/zend_execute.c:918:9
    #11 0x8c46e31 in i_zend_verify_property_type /src/php-src/Zend/zend_execute.c:923:6
    #12 0x8c46e31 in zend_verify_property_type /src/php-src/Zend/zend_execute.c:932:9
    #13 0xf33f5571 in zend_jit_assign_to_typed_prop /src/php-src/ext/opcache/jit/zend_jit_helpers.c:2014:6
    #14 0xe2e00a54  (/dev/zero (deleted)+0x8000a54)
    #15 0x8c5a357 in zend_execute /src/php-src/Zend/zend_vm_execute.h:58977:2
    #16 0x90fe5f7 in fuzzer_do_request_from_buffer /src/php-src/sapi/fuzzer/fuzzer-sapi.c:276:5
    #17 0x90fca6d in LLVMFuzzerTestOneInput /src/php-src/sapi/fuzzer/fuzzer-tracing-jit.c:46:3
    #18 0x823af5e in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #19 0x822609e in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #20 0x822bdb4 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned int)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #21 0x8254ef7 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #22 0xf6c2aed4 in __libc_start_main (/lib32/libc.so.6+0x1aed4)

DEDUP_TOKEN: zend_jit_fast_concat_tmp_helper----zend_call_function
0xf4104d8c is located 12 bytes inside of 1424-byte region [0xf4104d80,0xf4105310)
freed by thread T0 here:
    #0 0x830fe26 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3
    #1 0x8ac29e9 in tracked_free /src/php-src/Zend/zend_alloc.c:2771:2
    #2 0x8ab9305 in _efree_custom /src/php-src/Zend/zend_alloc.c:2428:3
    #3 0x8ab9305 in _efree /src/php-src/Zend/zend_alloc.c:2548:3
    #4 0x8ba3c8f in zend_string_destroy /src/php-src/Zend/zend_variables.c:67:2
    #5 0x8ba2b62 in rc_dtor_func /src/php-src/Zend/zend_variables.c:57:2
    #6 0xf33f5bba in zend_assign_to_variable /src/php-src/Zend/zend_execute.h:158:5
    #7 0xf33f5bba in zend_jit_assign_to_typed_prop /src/php-src/ext/opcache/jit/zend_jit_helpers.c:2022:10
    #8 0xe2e013e6  (/dev/zero (deleted)+0x80013e6)
    #9 0x8b57984 in zend_call_function /src/php-src/Zend/zend_execute_API.c:903:3
    #10 0x8b5a692 in zend_call_known_function /src/php-src/Zend/zend_execute_API.c:992:23
    #11 0x8f5f8a3 in zend_call_known_instance_method /src/php-src/Zend/zend_API.h:666:2
    #12 0x8f5f8a3 in zend_call_known_instance_method_with_0_params /src/php-src/Zend/zend_API.h:672:2
    #13 0x8f5f8a3 in zend_std_cast_object_tostring /src/php-src/Zend/zend_object_handlers.c:1828:5
    #14 0x8bbc18d in zend_parse_arg_str_weak /src/php-src/Zend/zend_API.c:660:7
    #15 0x8c4581c in zend_verify_weak_scalar_type_hint /src/php-src/Zend/zend_execute.c:737:37
    #16 0x8c46e31 in zend_verify_scalar_type_hint /src/php-src/Zend/zend_execute.c:804:9
    #17 0x8c46e31 in i_zend_check_property_type /src/php-src/Zend/zend_execute.c:918:9
    #18 0x8c46e31 in i_zend_verify_property_type /src/php-src/Zend/zend_execute.c:923:6
    #19 0x8c46e31 in zend_verify_property_type /src/php-src/Zend/zend_execute.c:932:9
    #20 0xf33f5571 in zend_jit_assign_to_typed_prop /src/php-src/ext/opcache/jit/zend_jit_helpers.c:2014:6
    #21 0xe2e00a54  (/dev/zero (deleted)+0x8000a54)
    #22 0x8c5a357 in zend_execute /src/php-src/Zend/zend_vm_execute.h:58977:2
    #23 0x90fe5f7 in fuzzer_do_request_from_buffer /src/php-src/sapi/fuzzer/fuzzer-sapi.c:276:5
    #24 0x90fca6d in LLVMFuzzerTestOneInput /src/php-src/sapi/fuzzer/fuzzer-tracing-jit.c:46:3
    #25 0x823af5e in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #26 0x822609e in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #27 0x822bdb4 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned int)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #28 0x8254ef7 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #29 0xf6c2aed4 in __libc_start_main (/lib32/libc.so.6+0x1aed4)

DEDUP_TOKEN: free--tracked_free--_efree_custom
previously allocated by thread T0 here:
    #0 0x83100a5 in __interceptor_malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:129:3
    #1 0x8ab61e2 in tracked_malloc /src/php-src/Zend/zend_alloc.c:2752:14
    #2 0x8ab8fee in _malloc_custom /src/php-src/Zend/zend_alloc.c:2419:10
    #3 0x8ab8fee in _emalloc /src/php-src/Zend/zend_alloc.c:2538:10
    #4 0xf341538f in zend_string_alloc /src/php-src/Zend/zend_string.h:149:36
    #5 0xf341538f in zend_jit_rope_end /src/php-src/ext/opcache/jit/zend_jit_helpers.c:2555:8
    #6 0xe2e01222  (/dev/zero (deleted)+0x8001222)
    #7 0x8b57984 in zend_call_function /src/php-src/Zend/zend_execute_API.c:903:3
    #8 0x8b5a692 in zend_call_known_function /src/php-src/Zend/zend_execute_API.c:992:23
    #9 0x8f5f8a3 in zend_call_known_instance_method /src/php-src/Zend/zend_API.h:666:2
    #10 0x8f5f8a3 in zend_call_known_instance_method_with_0_params /src/php-src/Zend/zend_API.h:672:2
    #11 0x8f5f8a3 in zend_std_cast_object_tostring /src/php-src/Zend/zend_object_handlers.c:1828:5
    #12 0x8bbc18d in zend_parse_arg_str_weak /src/php-src/Zend/zend_API.c:660:7
    #13 0x8c4581c in zend_verify_weak_scalar_type_hint /src/php-src/Zend/zend_execute.c:737:37
    #14 0x8c46e31 in zend_verify_scalar_type_hint /src/php-src/Zend/zend_execute.c:804:9
    #15 0x8c46e31 in i_zend_check_property_type /src/php-src/Zend/zend_execute.c:918:9
    #16 0x8c46e31 in i_zend_verify_property_type /src/php-src/Zend/zend_execute.c:923:6
    #17 0x8c46e31 in zend_verify_property_type /src/php-src/Zend/zend_execute.c:932:9
    #18 0xf33f5571 in zend_jit_assign_to_typed_prop /src/php-src/ext/opcache/jit/zend_jit_helpers.c:2014:6
    #19 0xe2e00a54  (/dev/zero (deleted)+0x8000a54)
    #20 0x8c5a357 in zend_execute /src/php-src/Zend/zend_vm_execute.h:58977:2
    #21 0x90fe5f7 in fuzzer_do_request_from_buffer /src/php-src/sapi/fuzzer/fuzzer-sapi.c:276:5
    #22 0x90fca6d in LLVMFuzzerTestOneInput /src/php-src/sapi/fuzzer/fuzzer-tracing-jit.c:46:3
    #23 0x823af5e in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #24 0x822609e in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #25 0x822bdb4 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned int)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #26 0x8254ef7 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #27 0xf6c2aed4 in __libc_start_main (/lib32/libc.so.6+0x1aed4)

DEDUP_TOKEN: __interceptor_malloc--tracked_malloc--_malloc_custom
SUMMARY: AddressSanitizer: heap-use-after-free /src/php-src/ext/opcache/jit/zend_jit_helpers.c:1203:19 in zend_jit_fast_concat_tmp_helper
Shadow bytes around the buggy address:
  0x3e820960: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3e820970: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3e820980: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3e820990: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3e8209a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
=>0x3e8209b0: fd[fd]fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3e8209c0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3e8209d0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3e8209e0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3e8209f0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3e820a00: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==13==ABORTING
