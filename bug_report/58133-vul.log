INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2176991013
INFO: Loaded 1 modules   (17226 inline 8-bit counters): 17226 [0x84ccd8, 0x851022), 
INFO: Loaded 1 PC tables (17226 PCs): 17226 [0x788788,0x7cbc28), 
/out/affdicfuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: attempting double-free on 0x6020000000b0 in thread T0:
SCARINESS: 42 (double-free)
    #0 0x56b55d in operator delete[](void*) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:155:3
    #1 0x65f71e in HashMgr::~HashMgr() /src/hunspell/src/hunspell/hashmgr.cxx:131:5
    #2 0x573c4d in HunspellImpl::~HunspellImpl() /src/hunspell/src/hunspell/hunspell.cxx:204:5
    #3 0x5a4542 in Hunspell::~Hunspell() /src/hunspell/src/hunspell/hunspell.cxx:2030:3
    #4 0x56e439 in LLVMFuzzerTestOneInput /src/hunspell/./src/tools/affdicfuzzer.cxx:69:1
    #5 0x43ec23 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #6 0x42a382 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #7 0x42fc2c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #8 0x459162 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #9 0x74add6669082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #10 0x42054d in _start (/out/affdicfuzzer+0x42054d)

DEDUP_TOKEN: operator delete[](void*)--HashMgr::~HashMgr()--HunspellImpl::~HunspellImpl()
0x6020000000b0 is located 0 bytes inside of 2-byte region [0x6020000000b0,0x6020000000b2)
freed by thread T0 here:
    #0 0x56b55d in operator delete[](void*) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:155:3
    #1 0x65ec64 in free_flag /src/hunspell/src/hunspell/hashmgr.cxx:108:5
    #2 0x65ec64 in HashMgr::free_table() /src/hunspell/src/hunspell/hashmgr.cxx:119:7
    #3 0x65f662 in HashMgr::~HashMgr() /src/hunspell/src/hunspell/hashmgr.cxx:128:3
    #4 0x573c4d in HunspellImpl::~HunspellImpl() /src/hunspell/src/hunspell/hunspell.cxx:204:5
    #5 0x5a4542 in Hunspell::~Hunspell() /src/hunspell/src/hunspell/hunspell.cxx:2030:3
    #6 0x56e439 in LLVMFuzzerTestOneInput /src/hunspell/./src/tools/affdicfuzzer.cxx:69:1
    #7 0x43ec23 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #8 0x42a382 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #9 0x42fc2c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #10 0x459162 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #11 0x74add6669082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)

DEDUP_TOKEN: operator delete[](void*)--free_flag--HashMgr::free_table()
previously allocated by thread T0 here:
    #0 0x56ad0d in operator new[](unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:98:3
    #1 0x6696bf in HashMgr::decode_flags(unsigned short**, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, FileMgr*) const /src/hunspell/src/hunspell/hashmgr.cxx:727:17
    #2 0x66d851 in HashMgr::parse_aliasf(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, FileMgr*) /src/hunspell/src/hunspell/hashmgr.cxx:1091:33
    #3 0x65c067 in HashMgr::load_config(char const*, char const*) /src/hunspell/src/hunspell/hashmgr.cxx:986:12
    #4 0x65aadc in HashMgr::HashMgr(char const*, char const*, char const*) /src/hunspell/src/hunspell/hashmgr.cxx:93:3
    #5 0x572e4b in HunspellImpl::HunspellImpl(char const*, char const*, char const*) /src/hunspell/src/hunspell/hunspell.cxx:179:25
    #6 0x5a44ae in Hunspell::Hunspell(char const*, char const*, char const*) /src/hunspell/src/hunspell/hunspell.cxx:2026:16
    #7 0x56e20f in LLVMFuzzerTestOneInput /src/hunspell/./src/tools/affdicfuzzer.cxx:63:14
    #8 0x43ec23 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #9 0x42a382 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #10 0x42fc2c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #11 0x459162 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #12 0x74add6669082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)

DEDUP_TOKEN: operator new[](unsigned long)--HashMgr::decode_flags(unsigned short**, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, FileMgr*) const--HashMgr::parse_aliasf(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, FileMgr*)
SUMMARY: AddressSanitizer: double-free /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:155:3 in operator delete[](void*)
==13==ABORTING
