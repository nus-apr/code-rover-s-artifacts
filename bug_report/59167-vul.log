oss-fuzzshark: disabling: ip
oss-fuzzshark: disabling: udplite
oss-fuzzshark: disabling: ospf
oss-fuzzshark: disabling: bgp
oss-fuzzshark: disabling: dhcp
oss-fuzzshark: disabling: json
oss-fuzzshark: disabling: snort
oss-fuzzshark: configured for dissector: udp in table: ip.proto
INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2178405734
INFO: Loaded 1 modules   (399668 inline 8-bit counters): 399668 [0xfc47fd0, 0xfca9904), 
INFO: Loaded 1 PC tables (399668 PCs): 399668 [0xfca9908,0x102c2c48), 
/out/fuzzshark_ip_proto-udp: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: heap-use-after-free on address 0x6040001762dd at pc 0x000000530bc1 bp 0x7ffc4572d4b0 sp 0x7ffc4572cc80
READ of size 6 at 0x6040001762dd thread T0
SCARINESS: 48 (6-byte-read-heap-use-after-free)
    #0 0x530bc0 in __asan_memcpy /src/llvm-project/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3
    #1 0x2d6c4ca in wmem_memdup /src/wireshark/wsutil/wmem/wmem_miscutl.c:27:5
    #2 0x7c12ea in alloc_address_wmem /src/wireshark/epan/address.h:155:31
    #3 0x7c12ea in copy_address_wmem /src/wireshark/epan/address.h:273:5
    #4 0x7c12ea in copy_address /src/wireshark/epan/address.h:283:5
    #5 0x7ad9d9 in fragment_addresses_persistent_key /src/wireshark/epan/reassemble.c:111:2
    #6 0x7b9aa9 in insert_fd_head /src/wireshark/epan/reassemble.c:562:8
    #7 0x7b9aa9 in fragment_add_seq_single_work /src/wireshark/epan/reassemble.c:2579:4
    #8 0x7bbcc3 in fragment_add_seq_single_aging /src/wireshark/epan/reassemble.c:2710:9
    #9 0x18d95ab in dissect_mp /src/wireshark/epan/dissectors/packet-ppp.c:5779:23
    #10 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #11 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9
    #12 0x716d5f in dissector_try_uint_new /src/wireshark/epan/packet.c:1522:8
    #13 0x716d5f in dissector_try_uint /src/wireshark/epan/packet.c:1546:9
    #14 0x18eb13f in dissect_ppp_common /src/wireshark/epan/dissectors/packet-ppp.c:4826:10
    #15 0x18d96ad in dissect_ppp /src/wireshark/epan/dissectors/packet-ppp.c:5824:5
    #16 0x18d96ad in dissect_mp /src/wireshark/epan/dissectors/packet-ppp.c:5793:17
    #17 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #18 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9
    #19 0x716d5f in dissector_try_uint_new /src/wireshark/epan/packet.c:1522:8
    #20 0x716d5f in dissector_try_uint /src/wireshark/epan/packet.c:1546:9
    #21 0x18eb13f in dissect_ppp_common /src/wireshark/epan/dissectors/packet-ppp.c:4826:10
    #22 0x18d8230 in dissect_ppp_raw_hdlc /src/wireshark/epan/dissectors/packet-ppp.c:6079:17
    #23 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #24 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9
    #25 0x716382 in dissector_try_uint_new /src/wireshark/epan/packet.c:1522:8
    #26 0x108204f in dissect_gre /src/wireshark/epan/dissectors/packet-gre.c:496:14
    #27 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #28 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9
    #29 0x716382 in dissector_try_uint_new /src/wireshark/epan/packet.c:1522:8
    #30 0x12daaac in ip_try_dissect /src/wireshark/epan/dissectors/packet-ip.c:1819:7
    #31 0x131c21a in ipv6_dissect_next /src/wireshark/epan/dissectors/packet-ipv6.c:3776:9
    #32 0x131ea1c in dissect_ipv6 /src/wireshark/epan/dissectors/packet-ipv6.c:3718:5
    #33 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #34 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9
    #35 0x71320a in call_dissector_only /src/wireshark/epan/packet.c:3419:8
    #36 0x71320a in call_dissector_with_data /src/wireshark/epan/packet.c:3432:8
    #37 0x8e55c5 in dissect_6lowpan /src/wireshark/epan/dissectors/packet-6lowpan.c:1279:9
    #38 0x8e6d62 in dissect_6lowpan_heur /src/wireshark/epan/dissectors/packet-6lowpan.c:1181:5
    #39 0x71cb54 in dissector_try_heuristic /src/wireshark/epan/packet.c:2948:9
    #40 0x12a6b53 in ieee802154_dissect_frame_payload /src/wireshark/epan/dissectors/packet-ieee802154.c:3176:21
    #41 0x12b470a in dissect_ieee802154_common /src/wireshark/epan/dissectors/packet-ieee802154.c:2467:13
    #42 0x12acb6c in dissect_ieee802154_nofcs /src/wireshark/epan/dissectors/packet-ieee802154.c:2158:5
    #43 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #44 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9
    #45 0x71320a in call_dissector_only /src/wireshark/epan/packet.c:3419:8
    #46 0x71320a in call_dissector_with_data /src/wireshark/epan/packet.c:3432:8
    #47 0x1ac53e4 in dissect_scop_bridge /src/wireshark/epan/dissectors/packet-scop.c:296:5
    #48 0x1ac53e4 in dissect_scop /src/wireshark/epan/dissectors/packet-scop.c:181:13
    #49 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #50 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9
    #51 0x716d5f in dissector_try_uint_new /src/wireshark/epan/packet.c:1522:8
    #52 0x716d5f in dissector_try_uint /src/wireshark/epan/packet.c:1546:9
    #53 0x1e3e1f9 in decode_udp_ports /src/wireshark/epan/dissectors/packet-udp.c:681:27
    #54 0x1e43602 in dissect /src/wireshark/epan/dissectors/packet-udp.c:1251:9
    #55 0x1e403ec in dissect_udp /src/wireshark/epan/dissectors/packet-udp.c:1257:5
    #56 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #57 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9
    #58 0x72061f in call_dissector_only /src/wireshark/epan/packet.c:3419:8
    #59 0x72061f in call_all_postdissectors /src/wireshark/epan/packet.c:3792:3
    #60 0x100e4de in dissect_frame /src/wireshark/epan/dissectors/packet-frame.c:1465:5
    #61 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #62 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9
    #63 0x71320a in call_dissector_only /src/wireshark/epan/packet.c:3419:8
    #64 0x71320a in call_dissector_with_data /src/wireshark/epan/packet.c:3432:8
    #65 0x7128e0 in dissect_record /src/wireshark/epan/packet.c:632:3
    #66 0x7051f4 in epan_dissect_run /src/wireshark/epan/epan.c:622:2
    #67 0x56ee87 in LLVMFuzzerTestOneInput /src/wireshark/fuzz/fuzzshark.c:382:2
    #68 0x4406a3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #69 0x42be02 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #70 0x4316ac in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #71 0x45abe2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #72 0x7157d5805082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #73 0x421fcd in _start (/out/fuzzshark_ip_proto-udp+0x421fcd)

DEDUP_TOKEN: __asan_memcpy--wmem_memdup--alloc_address_wmem
0x6040001762dd is located 13 bytes inside of 45-byte region [0x6040001762d0,0x6040001762fd)
freed by thread T0 here:
    #0 0x531592 in __interceptor_free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3
    #1 0x7d97f6 in tvb_free_internal /src/wireshark/epan/tvbuff.c:93:3
    #2 0x7d97f6 in tvb_free_chain /src/wireshark/epan/tvbuff.c:118:3
    #3 0x7d97f6 in tvb_free /src/wireshark/epan/tvbuff.c:108:2
    #4 0x7af0e2 in free_fd_head /src/wireshark/epan/reassemble.c:379:3
    #5 0x7af0e2 in unref_fd_head /src/wireshark/epan/reassemble.c:399:3
    #6 0x2e2143d in g_hash_table_insert_node ghash.c.o

DEDUP_TOKEN: __interceptor_free--tvb_free_internal--tvb_free_chain
previously allocated by thread T0 here:
    #0 0x531836 in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:69:3
    #1 0x2e34a08 in g_malloc (/out/fuzzshark_ip_proto-udp+0x2e34a08)
    #2 0x7b6fb4 in fragment_add_seq_work /src/wireshark/epan/reassemble.c:2143:2
    #3 0x7b6fb4 in fragment_add_seq_common /src/wireshark/epan/reassemble.c:2241:6
    #4 0x7bad8b in fragment_add_seq_single_work /src/wireshark/epan/reassemble.c:2660:7
    #5 0x7bbcc3 in fragment_add_seq_single_aging /src/wireshark/epan/reassemble.c:2710:9
    #6 0x18d95ab in dissect_mp /src/wireshark/epan/dissectors/packet-ppp.c:5779:23
    #7 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #8 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9
    #9 0x716d5f in dissector_try_uint_new /src/wireshark/epan/packet.c:1522:8
    #10 0x716d5f in dissector_try_uint /src/wireshark/epan/packet.c:1546:9
    #11 0x18eb13f in dissect_ppp_common /src/wireshark/epan/dissectors/packet-ppp.c:4826:10
    #12 0x18d8230 in dissect_ppp_raw_hdlc /src/wireshark/epan/dissectors/packet-ppp.c:6079:17
    #13 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #14 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9
    #15 0x716382 in dissector_try_uint_new /src/wireshark/epan/packet.c:1522:8
    #16 0x108204f in dissect_gre /src/wireshark/epan/dissectors/packet-gre.c:496:14
    #17 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #18 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9
    #19 0x716382 in dissector_try_uint_new /src/wireshark/epan/packet.c:1522:8
    #20 0x12daaac in ip_try_dissect /src/wireshark/epan/dissectors/packet-ip.c:1819:7
    #21 0x131c21a in ipv6_dissect_next /src/wireshark/epan/dissectors/packet-ipv6.c:3776:9
    #22 0x131ea1c in dissect_ipv6 /src/wireshark/epan/dissectors/packet-ipv6.c:3718:5
    #23 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #24 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9
    #25 0x71320a in call_dissector_only /src/wireshark/epan/packet.c:3419:8
    #26 0x71320a in call_dissector_with_data /src/wireshark/epan/packet.c:3432:8
    #27 0x8e55c5 in dissect_6lowpan /src/wireshark/epan/dissectors/packet-6lowpan.c:1279:9
    #28 0x8e6d62 in dissect_6lowpan_heur /src/wireshark/epan/dissectors/packet-6lowpan.c:1181:5
    #29 0x71cb54 in dissector_try_heuristic /src/wireshark/epan/packet.c:2948:9
    #30 0x12a6b53 in ieee802154_dissect_frame_payload /src/wireshark/epan/dissectors/packet-ieee802154.c:3176:21
    #31 0x12b470a in dissect_ieee802154_common /src/wireshark/epan/dissectors/packet-ieee802154.c:2467:13
    #32 0x12acb6c in dissect_ieee802154_nofcs /src/wireshark/epan/dissectors/packet-ieee802154.c:2158:5
    #33 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #34 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9
    #35 0x71320a in call_dissector_only /src/wireshark/epan/packet.c:3419:8
    #36 0x71320a in call_dissector_with_data /src/wireshark/epan/packet.c:3432:8
    #37 0x1ac53e4 in dissect_scop_bridge /src/wireshark/epan/dissectors/packet-scop.c:296:5
    #38 0x1ac53e4 in dissect_scop /src/wireshark/epan/dissectors/packet-scop.c:181:13
    #39 0x71688b in call_dissector_through_handle /src/wireshark/epan/packet.c:828:9
    #40 0x71688b in call_dissector_work /src/wireshark/epan/packet.c:919:9

DEDUP_TOKEN: malloc--g_malloc--fragment_add_seq_work
SUMMARY: AddressSanitizer: heap-use-after-free /src/llvm-project/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3 in __asan_memcpy
Shadow bytes around the buggy address:
  0x0c0880026c00: fa fa 00 00 00 00 00 06 fa fa 00 00 00 00 00 00
  0x0c0880026c10: fa fa 00 00 00 00 00 00 fa fa 00 00 00 00 00 00
  0x0c0880026c20: fa fa 00 00 00 00 00 00 fa fa 00 00 00 00 00 00
  0x0c0880026c30: fa fa 00 00 00 00 00 00 fa fa 00 00 00 00 00 00
  0x0c0880026c40: fa fa 00 00 00 00 00 00 fa fa 00 00 00 00 00 00
=>0x0c0880026c50: fa fa fd fd fd fd fd fd fa fa fd[fd]fd fd fd fd
  0x0c0880026c60: fa fa 00 00 00 00 00 00 fa fa 00 00 00 00 00 00
  0x0c0880026c70: fa fa 00 00 00 00 00 00 fa fa 00 00 00 00 00 02
  0x0c0880026c80: fa fa 00 00 00 00 00 00 fa fa 00 00 00 00 00 00
  0x0c0880026c90: fa fa fd fd fd fd fd fa fa fa 00 00 00 00 05 fa
  0x0c0880026ca0: fa fa 00 00 00 00 00 00 fa fa 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==13==ABORTING
