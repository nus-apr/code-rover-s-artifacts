INFO: Seed: 2186174425
INFO: Loaded 1 modules   (20937 guards): 20937 [0xb0e260, 0xb22984), 
/out/wpantund-fuzz: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: heap-use-after-free on address 0x63100000f7c5 at pc 0x0000004ab638 bp 0x7ffc0a011370 sp 0x7ffc0a010b20
READ of size 16 at 0x63100000f7c5 thread T0
SCARINESS: 54 (multi-byte-read-heap-use-after-free)
    #0 0x4ab637 in __interceptor_inet_ntop /src/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:2269
    #1 0x5e8179 in in6_addr_to_string(in6_addr const&) /src/wpantund/src/wpantund/../util/IPv6Helpers.cpp:29:2
    #2 0x65d967 in nl::wpantund::SpinelNCPInstance::handle_ncp_spinel_value_inserted(spinel_prop_key_t, unsigned char const*, unsigned int) /src/wpantund/src/ncp-spinel/SpinelNCPInstance.cpp:2406:88
    #3 0x65efef in nl::wpantund::SpinelNCPInstance::handle_ncp_spinel_callback(unsigned int, unsigned char const*, unsigned int) /src/wpantund/src/ncp-spinel/SpinelNCPInstance.cpp:2507:11
    #4 0x673611 in nl::wpantund::SpinelNCPInstance::ncp_to_driver_pump() /src/wpantund/src/ncp-spinel/SpinelNCPInstance-DataPump.cpp:317:4
    #5 0x5dc0f5 in nl::wpantund::NCPInstanceBase::process() /src/wpantund/src/wpantund/NCPInstanceBase-AsyncIO.cpp:222:3
    #6 0x66118f in nl::wpantund::SpinelNCPInstance::process() /src/wpantund/src/ncp-spinel/SpinelNCPInstance.cpp:2768:19
    #7 0x522c8e in MainLoop::process() /src/wpantund/src/wpantund/./wpantund.cpp:535:17
    #8 0x51feab in NCPInputFuzzTarget(unsigned char const*, unsigned long) /src/wpantund/src/wpantund/wpantund-fuzz.cpp:181:13
    #9 0x520956 in LLVMFuzzerTestOneInput /src/wpantund/src/wpantund/wpantund-fuzz.cpp:238:11
    #10 0x6f0610 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:463:13
    #11 0x6f1926 in fuzzer::Fuzzer::TryDetectingAMemoryLeak(unsigned char const*, unsigned long, bool) /src/libfuzzer/FuzzerLoop.cpp:536:3
    #12 0x6cf4cd in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:274:6
    #13 0x6da7b0 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:687:9
    #14 0x6ceb38 in main /src/libfuzzer/FuzzerMain.cpp:20:10
    #15 0x75fff3ac283f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #16 0x41cf18 in _start (/out/wpantund-fuzz+0x41cf18)

DEDUP_TOKEN: __interceptor_inet_ntop--in6_addr_to_string(in6_addr const&)--nl::wpantund::SpinelNCPInstance::handle_ncp_spinel_value_inserted(spinel_prop_key_t, unsigned char const*, unsigned int)
0x63100000f7c5 is located 61381 bytes inside of 66832-byte region [0x631000000800,0x631000010d10)
freed by thread T0 here:
    #0 0x5171c0 in operator delete(void*) /src/llvm/projects/compiler-rt/lib/asan/asan_new_delete.cc:137
    #1 0x522008 in MainLoop::~MainLoop() /src/wpantund/src/wpantund/./wpantund.cpp:516:3
    #2 0x52029a in NCPInputFuzzTarget(unsigned char const*, unsigned long) /src/wpantund/src/wpantund/wpantund-fuzz.cpp:199:2
    #3 0x520956 in LLVMFuzzerTestOneInput /src/wpantund/src/wpantund/wpantund-fuzz.cpp:238:11
    #4 0x6f0610 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:463:13
    #5 0x6cf495 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:273:6
    #6 0x6da7b0 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:687:9
    #7 0x6ceb38 in main /src/libfuzzer/FuzzerMain.cpp:20:10
    #8 0x75fff3ac283f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: operator delete(void*)--MainLoop::~MainLoop()--NCPInputFuzzTarget(unsigned char const*, unsigned long)
previously allocated by thread T0 here:
    #0 0x516448 in operator new(unsigned long) /src/llvm/projects/compiler-rt/lib/asan/asan_new_delete.cc:92
    #1 0x61a11d in wpantund_ncpinstance_default_alloc /src/wpantund/src/ncp-spinel/SpinelNCPInstance.cpp:50:1
    #2 0x542347 in nl::wpantund::NCPInstance::alloc(std::__1::map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::less<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > > const&) /src/wpantund/src/wpantund/NCPInstance.cpp:125:8
    #3 0x521997 in MainLoop::MainLoop(std::__1::map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::less<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > > const&) /src/wpantund/src/wpantund/./wpantund.cpp:505:37
    #4 0x51f9ca in NCPInputFuzzTarget(unsigned char const*, unsigned long) /src/wpantund/src/wpantund/wpantund-fuzz.cpp:114:11
    #5 0x520956 in LLVMFuzzerTestOneInput /src/wpantund/src/wpantund/wpantund-fuzz.cpp:238:11
    #6 0x6f0610 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:463:13
    #7 0x6cf495 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:273:6
    #8 0x6da7b0 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:687:9
    #9 0x6ceb38 in main /src/libfuzzer/FuzzerMain.cpp:20:10
    #10 0x75fff3ac283f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: operator new(unsigned long)--wpantund_ncpinstance_default_alloc--nl::wpantund::NCPInstance::alloc(std::__1::map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::less<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > > const&)
SUMMARY: AddressSanitizer: heap-use-after-free /src/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:2269 in __interceptor_inet_ntop
Shadow bytes around the buggy address:
  0x0c627fff9ea0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fff9eb0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fff9ec0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fff9ed0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fff9ee0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
=>0x0c627fff9ef0: fd fd fd fd fd fd fd fd[fd]fd fd fd fd fd fd fd
  0x0c627fff9f00: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fff9f10: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fff9f20: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fff9f30: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fff9f40: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==13==ABORTING
