INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2308831548
INFO: Loaded 1 modules   (17522 inline 8-bit counters): 17522 [0x8a3d78, 0x8a81ea), 
INFO: Loaded 1 PC tables (17522 PCs): 17522 [0x7dc618,0x820d38), 
/out/affdicfuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==12==ERROR: AddressSanitizer: heap-use-after-free on address 0x631000034800 at pc 0x000000662072 bp 0x7ffd206fb270 sp 0x7ffd206fb268
READ of size 2 at 0x631000034800 thread T0
SCARINESS: 42 (2-byte-read-heap-use-after-free)
    #0 0x662071 in operator() /usr/local/bin/../include/c++/v1/__algorithm/comp.h:60:67
    #1 0x662071 in __lower_bound<std::__1::__less<unsigned short, int> &, unsigned short *, int> /usr/local/bin/../include/c++/v1/__algorithm/lower_bound.h:34:13
    #2 0x662071 in __binary_search<std::__1::__less<unsigned short, int> &, unsigned short *, int> /usr/local/bin/../include/c++/v1/__algorithm/binary_search.h:29:15
    #3 0x662071 in binary_search<unsigned short *, int, std::__1::__less<unsigned short, int> > /usr/local/bin/../include/c++/v1/__algorithm/binary_search.h:40:12
    #4 0x662071 in binary_search<unsigned short *, int> /usr/local/bin/../include/c++/v1/__algorithm/binary_search.h:49:12
    #5 0x662071 in free_flag /src/hunspell/src/hunspell/hashmgr.cxx:110:34
    #6 0x662071 in HashMgr::add_word(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, unsigned short*, int, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const*, bool, int) /src/hunspell/src/hunspell/hashmgr.cxx:169:5
    #7 0x65f8ba in HashMgr::load_tables(char const*, char const*) /src/hunspell/src/hunspell/hashmgr.cxx:677:9
    #8 0x65c9e7 in HashMgr::HashMgr(char const*, char const*, char const*) /src/hunspell/src/hunspell/hashmgr.cxx:99:12
    #9 0x572e4b in HunspellImpl::HunspellImpl(char const*, char const*, char const*) /src/hunspell/src/hunspell/hunspell.cxx:183:25
    #10 0x5a4e9e in Hunspell::Hunspell(char const*, char const*, char const*) /src/hunspell/src/hunspell/hunspell.cxx:2106:16
    #11 0x56e20f in LLVMFuzzerTestOneInput /src/hunspell/./src/tools/affdicfuzzer.cxx:63:14
    #12 0x43ec23 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #13 0x42a382 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #14 0x42fc2c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #15 0x459162 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #16 0x7cdda1fd9082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #17 0x42054d in _start (/out/affdicfuzzer+0x42054d)

DEDUP_TOKEN: operator()--__lower_bound<std::__1::__less<unsigned short, int> &, unsigned short *, int>--__binary_search<std::__1::__less<unsigned short, int> &, unsigned short *, int>
0x631000034800 is located 49152 bytes inside of 65936-byte region [0x631000028800,0x631000038990)
freed by thread T0 here:
    #0 0x56b45d in operator delete(void*) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:152:3
    #1 0x65e550 in HashMgr::load_config(char const*, char const*) /src/hunspell/src/hunspell/hashmgr.cxx
    #2 0x65c8cc in HashMgr::HashMgr(char const*, char const*, char const*) /src/hunspell/src/hunspell/hashmgr.cxx:96:3
    #3 0x572e4b in HunspellImpl::HunspellImpl(char const*, char const*, char const*) /src/hunspell/src/hunspell/hunspell.cxx:183:25
    #4 0x5a4e9e in Hunspell::Hunspell(char const*, char const*, char const*) /src/hunspell/src/hunspell/hunspell.cxx:2106:16
    #5 0x56e20f in LLVMFuzzerTestOneInput /src/hunspell/./src/tools/affdicfuzzer.cxx:63:14
    #6 0x43ec23 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #7 0x42a382 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #8 0x42fc2c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #9 0x459162 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #10 0x7cdda1fd9082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)

DEDUP_TOKEN: operator delete(void*)--HashMgr::load_config(char const*, char const*)--HashMgr::HashMgr(char const*, char const*, char const*)
previously allocated by thread T0 here:
    #0 0x56abfd in operator new(unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:95:3
    #1 0x65cfd8 in HashMgr::load_config(char const*, char const*) /src/hunspell/src/hunspell/hashmgr.cxx:940:21
    #2 0x65c8cc in HashMgr::HashMgr(char const*, char const*, char const*) /src/hunspell/src/hunspell/hashmgr.cxx:96:3
    #3 0x572e4b in HunspellImpl::HunspellImpl(char const*, char const*, char const*) /src/hunspell/src/hunspell/hunspell.cxx:183:25
    #4 0x5a4e9e in Hunspell::Hunspell(char const*, char const*, char const*) /src/hunspell/src/hunspell/hunspell.cxx:2106:16
    #5 0x56e20f in LLVMFuzzerTestOneInput /src/hunspell/./src/tools/affdicfuzzer.cxx:63:14
    #6 0x43ec23 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #7 0x42a382 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #8 0x42fc2c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #9 0x459162 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #10 0x7cdda1fd9082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)

DEDUP_TOKEN: operator new(unsigned long)--HashMgr::load_config(char const*, char const*)--HashMgr::HashMgr(char const*, char const*, char const*)
SUMMARY: AddressSanitizer: heap-use-after-free /usr/local/bin/../include/c++/v1/__algorithm/comp.h:60:67 in operator()
Shadow bytes around the buggy address:
  0x0c627fffe8b0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fffe8c0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fffe8d0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fffe8e0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fffe8f0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
=>0x0c627fffe900:[fd]fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fffe910: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fffe920: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fffe930: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fffe940: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c627fffe950: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==12==ABORTING
