INFO: Seed: 2185167521
INFO: Loaded 1 modules   (43841 inline 8-bit counters): 43841 [0x8800bc0, 0x880b701), 
INFO: Loaded 1 PC tables (43841 PCs): 43841 [0x86674bc,0x86bcec4), 
/out/hb-subset-fuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xed002fd1 at pc 0x081bf0e4 bp 0xffc8a448 sp 0xffc8a440
WRITE of size 1 at 0xed002fd1 thread T0
SCARINESS: 31 (1-byte-write-heap-buffer-overflow)
    #0 0x81bf0e3 in BEInt<unsigned short, 2>::operator=(unsigned short) /src/harfbuzz/src/./hb.hh:529:10
    #1 0x81bf06b in OT::IntType<unsigned short, 2u>::operator=(unsigned int) /src/harfbuzz/src/./hb-open-type.hh:62:41
    #2 0x8242b4c in bool OT::ClassDefFormat1::serialize<hb_zip_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_t const&, (hb_function_sortedness_t)0, (void*)0> >, (void*)0>(hb_serialize_context_t*, hb_zip_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_t const&, (hb_function_sortedness_t)0, (void*)0> >) /src/harfbuzz/src/./hb-ot-layout-common.hh:1658:23
    #3 0x82421ce in bool OT::ClassDef::serialize<hb_zip_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_t const&, (hb_function_sortedness_t)0, (void*)0> >, (void*)0>(hb_serialize_context_t*, hb_zip_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_t const&, (hb_function_sortedness_t)0, (void*)0> >) /src/harfbuzz/src/./hb-ot-layout-common.hh:1996:13
    #4 0x82414f1 in void OT::ClassDef_serialize<hb_zip_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_t const&, (hb_function_sortedness_t)0, (void*)0> > >(hb_serialize_context_t*, hb_zip_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_t const&, (hb_function_sortedness_t)0, (void*)0> >) /src/harfbuzz/src/./hb-ot-layout-common.hh:2078:32
    #5 0x823e8c2 in OT::ClassDef_remap_and_serialize(hb_serialize_context_t*, hb_set_t const&, hb_map_t const&, hb_sorted_vector_t<OT::HBGlyphID>&, hb_set_t const&, hb_map_t*) /src/harfbuzz/src/./hb-ot-layout-common.hh:1587:5
    #6 0x823db64 in OT::ClassDefFormat1::subset(hb_subset_context_t*, hb_map_t*) const /src/harfbuzz/src/./hb-ot-layout-common.hh:1687:5
    #7 0x823d57b in OT::ClassDef::subset(hb_subset_context_t*, hb_map_t*) const /src/harfbuzz/src/./hb-ot-layout-common.hh:2007:13
    #8 0x823d47b in _ZN19hb_subset_context_t9_dispatchIN2OT8ClassDefEJEEEDTcldtfp_6subsetfpTspcl10hb_forwardIT0_Efp1_EEERKT_11hb_priorityILj1EEDpOS3_ /src/harfbuzz/src/./hb-subset.hh:47:56
    #9 0x823caae in bool OT::OffsetTo<OT::ClassDef, OT::IntType<unsigned short, 2u>, true>::serialize_subset<>(hb_subset_context_t*, OT::OffsetTo<OT::ClassDef, OT::IntType<unsigned short, 2u>, true> const&, void const*) /src/harfbuzz/src/./hb-open-type.hh:327:19
    #10 0x8233e1d in OT::GDEF::subset(hb_subset_context_t*) const /src/harfbuzz/src/./hb-ot-layout-gdef-table.hh:553:24
    #11 0x81ad0cb in bool _subset<OT::GDEF const>(hb_subset_plan_t*) /src/harfbuzz/src/hb-subset.cc:93:26
    #12 0x81a61fe in hb_subset /src/harfbuzz/src/hb-subset.cc:256:17
    #13 0x81a2a53 in trySubset(hb_face_t*, unsigned int const*, int, bool, bool, bool) /src/harfbuzz/./test/fuzzing/hb-subset-fuzzer.cc:35:23
    #14 0x81a2884 in trySubset(hb_face_t*, unsigned int const*, int, unsigned char const*) /src/harfbuzz/./test/fuzzing/hb-subset-fuzzer.cc:63:3
    #15 0x81a26d2 in LLVMFuzzerTestOneInput /src/harfbuzz/./test/fuzzing/hb-subset-fuzzer.cc:98:5
    #16 0x80a6dd6 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:556:15
    #17 0x8093283 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:292:6
    #18 0x8098988 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned int)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:774:9
    #19 0x80bd797 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:19:10
    #20 0xf2934646 in __libc_start_main (/lib32/libc.so.6+0x18646)
    #21 0x806e258 in _start (/out/hb-subset-fuzzer+0x806e258)

DEDUP_TOKEN: BEInt<unsigned short, 2>::operator=(unsigned short)--OT::IntType<unsigned short, 2u>::operator=(unsigned int)--bool OT::ClassDefFormat1::serialize<hb_zip_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_t const&, (hb_function_sortedness_t)0, (void*)0> >, (void*)0>(hb_serialize_context_t*, hb_zip_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_iter_t<hb_sorted_array_t<OT::HBGlyphID>, hb_map_t const&, (hb_function_sortedness_t)0, (void*)0> >)
0xed002fd1 is located 0 bytes to the right of 593-byte region [0xed002d80,0xed002fd1)
allocated by thread T0 here:
    #0 0x816d707 in realloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:164:3
    #1 0x81af39d in hb_vector_t<char>::alloc(unsigned int) /src/harfbuzz/src/./hb-vector.hh:202:28
    #2 0x81ad02c in bool _subset<OT::GDEF const>(hb_subset_plan_t*) /src/harfbuzz/src/hb-subset.cc:83:9
    #3 0x81a61fe in hb_subset /src/harfbuzz/src/hb-subset.cc:256:17
    #4 0x81a2a53 in trySubset(hb_face_t*, unsigned int const*, int, bool, bool, bool) /src/harfbuzz/./test/fuzzing/hb-subset-fuzzer.cc:35:23
    #5 0x81a2884 in trySubset(hb_face_t*, unsigned int const*, int, unsigned char const*) /src/harfbuzz/./test/fuzzing/hb-subset-fuzzer.cc:63:3
    #6 0x81a26d2 in LLVMFuzzerTestOneInput /src/harfbuzz/./test/fuzzing/hb-subset-fuzzer.cc:98:5
    #7 0x80a6dd6 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:556:15
    #8 0x8093283 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:292:6
    #9 0x8098988 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned int)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:774:9
    #10 0x80bd797 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:19:10
    #11 0xf2934646 in __libc_start_main (/lib32/libc.so.6+0x18646)

DEDUP_TOKEN: realloc--hb_vector_t<char>::alloc(unsigned int)--bool _subset<OT::GDEF const>(hb_subset_plan_t*)
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/harfbuzz/src/./hb.hh:529:10 in BEInt<unsigned short, 2>::operator=(unsigned short)
Shadow bytes around the buggy address:
  0x3da005a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3da005b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x3da005c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x3da005d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x3da005e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x3da005f0: 00 00 00 00 00 00 00 00 00 00[01]fa fa fa fa fa
  0x3da00600: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3da00610: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3da00620: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3da00630: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3da00640: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==13==ABORTING
