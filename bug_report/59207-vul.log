INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2215605196
INFO: Loaded 1 modules   (159149 inline 8-bit counters): 159149 [0x3ae88c0, 0x3b0f66d), 
INFO: Loaded 1 PC tables (159149 PCs): 159149 [0x16ef620,0x195d0f0), 
/out/pdf_fuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
warning: premature end of data in flate filter
warning: unknown png predictor 232, treating as none
warning: unknown png predictor 45, treating as none
=================================================================
==13==ERROR: AddressSanitizer: heap-use-after-free on address 0x6150000006d0 at pc 0x0000006f52e0 bp 0x7fff5fb526f0 sp 0x7fff5fb526e8
WRITE of size 1 at 0x6150000006d0 thread T0
SCARINESS: 41 (1-byte-write-heap-use-after-free)
    #0 0x6f52df in pdf_cache_object /src/mupdf/source/pdf/pdf-xref.c:2497:18
    #1 0x6f715b in pdf_resolve_indirect /src/mupdf/source/pdf/pdf-xref.c:2554:12
    #2 0x6f7278 in pdf_resolve_indirect_chain /src/mupdf/source/pdf/pdf-xref.c:2581:9
    #3 0x9218b7 in pdf_array_len /src/mupdf/source/pdf/pdf-object.c:816:2
    #4 0x918f8d in pdf_load_link_annots /src/mupdf/source/pdf/pdf-link.c:629:6
    #5 0x962f2c in pdf_load_page_imp /src/mupdf/source/pdf/pdf-page.c:1139:18
    #6 0x57e475 in fz_load_chapter_page /src/mupdf/source/fitz/document.c:613:10
    #7 0x57e0a4 in fz_load_page /src/mupdf/source/fitz/document.c:475:11
    #8 0x6ca76b in fz_new_pixmap_from_page_number_with_separations /src/mupdf/source/fitz/util.c:254:9
    #9 0x6ca644 in fz_new_pixmap_from_page_number /src/mupdf/source/fitz/util.c:245:9
    #10 0x56d9d3 in LLVMFuzzerTestOneInput /src/pdf_fuzzer.cc:146:13
    #11 0x43f093 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #12 0x42a7f2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #13 0x43009c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #14 0x4595d2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #15 0x78b81b4d7082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #16 0x4209bd in _start (/out/pdf_fuzzer+0x4209bd)

DEDUP_TOKEN: pdf_cache_object--pdf_resolve_indirect--pdf_resolve_indirect_chain
0x6150000006d0 is located 336 bytes inside of 456-byte region [0x615000000580,0x615000000748)
freed by thread T0 here:
    #0 0x52ff82 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3
    #1 0x56e1f2 in fz_free_ossfuzz(void*, void*) /src/pdf_fuzzer.cc:78:3
    #2 0x65f202 in fz_free /src/mupdf/source/fitz/memory.c:163:3
    #3 0x6ece0c in ensure_solid_xref /src/mupdf/source/pdf/pdf-xref.c:248:3
    #4 0x6edbb0 in pdf_get_xref_entry_aux /src/mupdf/source/pdf/pdf-xref.c:441:2
    #5 0x6f5fa1 in pdf_get_xref_entry /src/mupdf/source/pdf/pdf-xref.c:449:9
    #6 0x6f5fa1 in pdf_get_xref_entry_no_null /src/mupdf/source/pdf/pdf-xref.c:459:26
    #7 0x6f5fa1 in pdf_load_obj_stm /src/mupdf/source/pdf/pdf-xref.c:2105:12
    #8 0x6f43fe in pdf_cache_object /src/mupdf/source/pdf/pdf-xref.c:2495:9
    #9 0x6f715b in pdf_resolve_indirect /src/mupdf/source/pdf/pdf-xref.c:2554:12
    #10 0x6f7278 in pdf_resolve_indirect_chain /src/mupdf/source/pdf/pdf-xref.c:2581:9
    #11 0x9218b7 in pdf_array_len /src/mupdf/source/pdf/pdf-object.c:816:2
    #12 0x918f8d in pdf_load_link_annots /src/mupdf/source/pdf/pdf-link.c:629:6
    #13 0x962f2c in pdf_load_page_imp /src/mupdf/source/pdf/pdf-page.c:1139:18
    #14 0x57e475 in fz_load_chapter_page /src/mupdf/source/fitz/document.c:613:10
    #15 0x57e0a4 in fz_load_page /src/mupdf/source/fitz/document.c:475:11
    #16 0x6ca76b in fz_new_pixmap_from_page_number_with_separations /src/mupdf/source/fitz/util.c:254:9
    #17 0x6ca644 in fz_new_pixmap_from_page_number /src/mupdf/source/fitz/util.c:245:9
    #18 0x56d9d3 in LLVMFuzzerTestOneInput /src/pdf_fuzzer.cc:146:13
    #19 0x43f093 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #20 0x42a7f2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #21 0x43009c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #22 0x4595d2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #23 0x78b81b4d7082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)

DEDUP_TOKEN: free--fz_free_ossfuzz(void*, void*)--fz_free
previously allocated by thread T0 here:
    #0 0x530226 in __interceptor_malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:69:3
    #1 0x56dc29 in fz_malloc_ossfuzz(void*, unsigned long) /src/pdf_fuzzer.cc:55:18
    #2 0x65e4c0 in do_scavenging_malloc /src/mupdf/source/fitz/memory.c:51:7
    #3 0x65ecf5 in fz_calloc /src/mupdf/source/fitz/memory.c:111:6
    #4 0x70ba06 in pdf_xref_find_subsection /src/mupdf/source/pdf/pdf-xref.c:1161:17
    #5 0x70bff4 in pdf_read_new_xref_section /src/mupdf/source/pdf/pdf-xref.c:1309:10
    #6 0x70a077 in pdf_read_new_xref /src/mupdf/source/pdf/pdf-xref.c:1423:5
    #7 0x70855b in pdf_read_xref /src/mupdf/source/pdf/pdf-xref.c:1464:13
    #8 0x707deb in read_xref_section /src/mupdf/source/pdf/pdf-xref.c:1479:12
    #9 0x707ad6 in pdf_read_xref_sections /src/mupdf/source/pdf/pdf-xref.c:1552:10
    #10 0x6fda46 in pdf_load_xref /src/mupdf/source/pdf/pdf-xref.c:1643:2
    #11 0x6fac1f in pdf_init_document /src/mupdf/source/pdf/pdf-xref.c:1793:4
    #12 0x6fa350 in pdf_open_document_with_stream /src/mupdf/source/pdf/pdf-xref.c:3034:3
    #13 0x57b9db in fz_open_accelerated_document_with_stream /src/mupdf/source/fitz/document.c:179:9
    #14 0x57b9db in fz_open_document_with_stream /src/mupdf/source/fitz/document.c:185:9
    #15 0x56d8db in LLVMFuzzerTestOneInput /src/pdf_fuzzer.cc:143:11
    #16 0x43f093 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #17 0x42a7f2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #18 0x43009c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #19 0x4595d2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #20 0x78b81b4d7082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)

DEDUP_TOKEN: __interceptor_malloc--fz_malloc_ossfuzz(void*, unsigned long)--do_scavenging_malloc
SUMMARY: AddressSanitizer: heap-use-after-free /src/mupdf/source/pdf/pdf-xref.c:2497:18 in pdf_cache_object
Shadow bytes around the buggy address:
  0x0c2a7fff8080: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c2a7fff8090: fd fd fd fd fd fd fd fd fd fd fd fa fa fa fa fa
  0x0c2a7fff80a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2a7fff80b0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c2a7fff80c0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
=>0x0c2a7fff80d0: fd fd fd fd fd fd fd fd fd fd[fd]fd fd fd fd fd
  0x0c2a7fff80e0: fd fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa
  0x0c2a7fff80f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2a7fff8100: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2a7fff8110: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2a7fff8120: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==13==ABORTING
