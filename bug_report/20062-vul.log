INFO: Seed: 2256473464
INFO: Loaded 1 modules   (9406 inline 8-bit counters): 9406 [0x9e50d0, 0x9e758e), 
INFO: Loaded 1 PC tables (9406 PCs): 9406 [0x9e7590,0xa0c170), 
/out/fuzz_json_decode: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: attempting double-free on 0x602000000090 in thread T0:
SCARINESS: 42 (double-free)
    #0 0x531e2d in free /src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:123:3
    #1 0x57f43d in UA_Array_delete /src/open62541/src/ua_types.c:1112:5
    #2 0x57f43d in Variant_clear /src/open62541/src/ua_types.c:421
    #3 0x5824df in UA_clear /src/open62541/src/ua_types.c:1041:5
    #4 0x6a5ca4 in UA_decodeJson /src/open62541/src/ua_types_encoding_json.c:3340:9
    #5 0x563855 in LLVMFuzzerTestOneInput /src/open62541/tests/fuzz/fuzz_json_decode.cc:26:28
    #6 0x46ba24 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:553:15
    #7 0x4565a1 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:286:6
    #8 0x45bc4a in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:717:9
    #9 0x486e32 in main /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerMain.cpp:19:10
    #10 0x7e68e46cc83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #11 0x41e6d8 in _start (/out/fuzz_json_decode+0x41e6d8)

DEDUP_TOKEN: free--UA_Array_delete--Variant_clear
0x602000000090 is located 0 bytes inside of 2-byte region [0x602000000090,0x602000000092)
freed by thread T0 here:
    #0 0x531e2d in free /src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:123:3
    #1 0x6aa2a3 in Variant_decodeJsonUnwrapExtensionObject /src/open62541/src/ua_types_encoding_json.c:2994:13
    #2 0x697940 in decodeFields /src/open62541/src/ua_types_encoding_json.c:3103:23
    #3 0x6a439d in Variant_decodeJson /src/open62541/src/ua_types_encoding_json.c:2743:15
    #4 0x6a5bda in UA_decodeJson /src/open62541/src/ua_types_encoding_json.c
    #5 0x563855 in LLVMFuzzerTestOneInput /src/open62541/tests/fuzz/fuzz_json_decode.cc:26:28
    #6 0x46ba24 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:553:15
    #7 0x4565a1 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:286:6
    #8 0x45bc4a in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:717:9
    #9 0x486e32 in main /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerMain.cpp:19:10
    #10 0x7e68e46cc83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: free--Variant_decodeJsonUnwrapExtensionObject--decodeFields
previously allocated by thread T0 here:
    #0 0x532222 in calloc /src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:154:3
    #1 0x6b789d in UA_memoryManager_calloc /src/open62541/tests/fuzz/custom_memory_manager.c:142:18
    #2 0x6aa023 in Variant_decodeJsonUnwrapExtensionObject /src/open62541/src/ua_types_encoding_json.c:2977:21
    #3 0x697940 in decodeFields /src/open62541/src/ua_types_encoding_json.c:3103:23
    #4 0x6a439d in Variant_decodeJson /src/open62541/src/ua_types_encoding_json.c:2743:15
    #5 0x6a5bda in UA_decodeJson /src/open62541/src/ua_types_encoding_json.c
    #6 0x563855 in LLVMFuzzerTestOneInput /src/open62541/tests/fuzz/fuzz_json_decode.cc:26:28
    #7 0x46ba24 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:553:15
    #8 0x4565a1 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:286:6
    #9 0x45bc4a in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:717:9
    #10 0x486e32 in main /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerMain.cpp:19:10
    #11 0x7e68e46cc83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: calloc--UA_memoryManager_calloc--Variant_decodeJsonUnwrapExtensionObject
SUMMARY: AddressSanitizer: double-free /src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:123:3 in free
==13==ABORTING
