INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2277862921
INFO: Loaded 3 modules   (224332 inline 8-bit counters): 13672 [0x7e7505d2a9e0, 0x7e7505d2df48), 959 [0x7e7505d8ba40, 0x7e7505d8bdff), 209701 [0x383b270, 0x386e595), 
INFO: Loaded 3 PC tables (224332 PCs): 13672 [0x7e7505d2df48,0x7e7505d635c8), 959 [0x7e7505d8be00,0x7e7505d8f9f0), 209701 [0x2a9e710,0x2dd1960), 
/out/gs_device_psdcmyk_fuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: heap-use-after-free on address 0x6310000dc868 at pc 0x000001083927 bp 0x7ffff43c3040 sp 0x7ffff43c3038
READ of size 8 at 0x6310000dc868 thread T0
SCARINESS: 51 (8-byte-read-heap-use-after-free)
    #0 0x1083926 in pdfi_cspace_free_callback /src/ghostpdl/./pdf/pdf_colour.c:329:14
    #1 0xa69f65 in gs_cspace_final /src/ghostpdl/./base/gscspace.c:104:9
    #2 0xf8d7c4 in restore_finalize /src/ghostpdl/./psi/isave.c:954:13
    #3 0xf8d7c4 in alloc_restore_step_in /src/ghostpdl/./psi/isave.c:759:9
    #4 0xf06247 in dorestore /src/ghostpdl/./psi/zvmem.c:193:16
    #5 0xe74290 in z2restore /src/ghostpdl/./psi/zdevice2.c:373:12
    #6 0xe93d29 in interp /src/ghostpdl/./psi/interp.c:1727:40
    #7 0xe93d29 in gs_call_interp /src/ghostpdl/./psi/interp.c:524:12
    #8 0xe93d29 in gs_interpret /src/ghostpdl/./psi/interp.c:481:12
    #9 0x577233 in gs_main_interpret /src/ghostpdl/./psi/imain.c:257:12
    #10 0x577233 in gs_main_run_string_end /src/ghostpdl/./psi/imain.c:945:12
    #11 0x577233 in gs_main_run_string_with_length /src/ghostpdl/./psi/imain.c:889:12
    #12 0x572741 in gs_main_run_string /src/ghostpdl/./psi/imain.c:870:12
    #13 0x11ddd7c in run_string /src/ghostpdl/./psi/imainarg.c:1169:12
    #14 0x11d9ea2 in swproc /src/ghostpdl/./psi/imainarg.c:367:20
    #15 0x11d6dee in gs_main_init_with_args01 /src/ghostpdl/./psi/imainarg.c:224:24
    #16 0x11ddb08 in gs_main_init_with_args /src/ghostpdl/./psi/imainarg.c:289:16
    #17 0xe7c742 in psapi_init_with_args /src/ghostpdl/./psi/psapi.c:281:12
    #18 0x56ec6a in gsapi_init_with_args /src/ghostpdl/./psi/iapi.c:253:12
    #19 0x56dd50 in fuzz_gs_device(unsigned char const*, unsigned long, int, char const*, char const*, int) /src/gs_fuzzlib.h:139:8
    #20 0x56e162 in LLVMFuzzerTestOneInput /src/gs_device_psdcmyk_fuzzer.cc:18:2
    #21 0x43f1d3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #22 0x43fcf5 in fuzzer::Fuzzer::TryDetectingAMemoryLeak(unsigned char const*, unsigned long, bool) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:687:3
    #23 0x42a97e in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:329:8
    #24 0x4301dc in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #25 0x459712 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #26 0x7e750572b082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #27 0x420afd in _start (/out/gs_device_psdcmyk_fuzzer+0x420afd)

DEDUP_TOKEN: pdfi_cspace_free_callback--gs_cspace_final--restore_finalize
0x6310000dc868 is located 104 bytes inside of 65584-byte region [0x6310000dc800,0x6310000ec830)
freed by thread T0 here:
    #0 0x5300c2 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3
    #1 0xac478c in gs_heap_free_object /src/ghostpdl/./base/gsmalloc.c:366:5
    #2 0x707daa in chunk_mem_node_free_all_slabs /src/ghostpdl/./base/gsmchunk.c:281:9
    #3 0x707daa in chunk_free_all /src/ghostpdl/./base/gsmchunk.c:298:9
    #4 0x70673c in gs_memory_chunk_release /src/ghostpdl/./base/gsmchunk.c:235:5
    #5 0x70673c in gs_memory_chunk_unwrap /src/ghostpdl/./base/gsmchunk.c:250:5
    #6 0x102b31a in pdfctx_finalize /src/ghostpdl/./psi/zpdfops.c:500:19
    #7 0xf8d7c4 in restore_finalize /src/ghostpdl/./psi/isave.c:954:13
    #8 0xf8d7c4 in alloc_restore_step_in /src/ghostpdl/./psi/isave.c:759:9
    #9 0xf06247 in dorestore /src/ghostpdl/./psi/zvmem.c:193:16
    #10 0xe74290 in z2restore /src/ghostpdl/./psi/zdevice2.c:373:12
    #11 0xe93d29 in interp /src/ghostpdl/./psi/interp.c:1727:40
    #12 0xe93d29 in gs_call_interp /src/ghostpdl/./psi/interp.c:524:12
    #13 0xe93d29 in gs_interpret /src/ghostpdl/./psi/interp.c:481:12
    #14 0x577233 in gs_main_interpret /src/ghostpdl/./psi/imain.c:257:12
    #15 0x577233 in gs_main_run_string_end /src/ghostpdl/./psi/imain.c:945:12
    #16 0x577233 in gs_main_run_string_with_length /src/ghostpdl/./psi/imain.c:889:12
    #17 0x572741 in gs_main_run_string /src/ghostpdl/./psi/imain.c:870:12
    #18 0x11ddd7c in run_string /src/ghostpdl/./psi/imainarg.c:1169:12
    #19 0x11d9ea2 in swproc /src/ghostpdl/./psi/imainarg.c:367:20
    #20 0x11d6dee in gs_main_init_with_args01 /src/ghostpdl/./psi/imainarg.c:224:24
    #21 0x11ddb08 in gs_main_init_with_args /src/ghostpdl/./psi/imainarg.c:289:16
    #22 0xe7c742 in psapi_init_with_args /src/ghostpdl/./psi/psapi.c:281:12
    #23 0x56ec6a in gsapi_init_with_args /src/ghostpdl/./psi/iapi.c:253:12
    #24 0x56dd50 in fuzz_gs_device(unsigned char const*, unsigned long, int, char const*, char const*, int) /src/gs_fuzzlib.h:139:8
    #25 0x56e162 in LLVMFuzzerTestOneInput /src/gs_device_psdcmyk_fuzzer.cc:18:2
    #26 0x43f1d3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #27 0x43fcf5 in fuzzer::Fuzzer::TryDetectingAMemoryLeak(unsigned char const*, unsigned long, bool) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:687:3
    #28 0x42a97e in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:329:8
    #29 0x4301dc in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #30 0x459712 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #31 0x7e750572b082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)

DEDUP_TOKEN: free--gs_heap_free_object--chunk_mem_node_free_all_slabs
previously allocated by thread T0 here:
    #0 0x530366 in __interceptor_malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:69:3
    #1 0xac3fd8 in gs_heap_alloc_bytes /src/ghostpdl/./base/gsmalloc.c:192:34
    #2 0x7090d1 in chunk_obj_alloc /src/ghostpdl/./base/gsmchunk.c:928:36
    #3 0x708097 in chunk_alloc_bytes /src/ghostpdl/./base/gsmchunk.c:999:12
    #4 0x103d4e9 in pdfi_create_context /src/ghostpdl/./pdf/ghostpdf.c:1742:27
    #5 0x1022c03 in zPDFInit /src/ghostpdl/./psi/zpdfops.c:1586:11
    #6 0xe93d29 in interp /src/ghostpdl/./psi/interp.c:1727:40
    #7 0xe93d29 in gs_call_interp /src/ghostpdl/./psi/interp.c:524:12
    #8 0xe93d29 in gs_interpret /src/ghostpdl/./psi/interp.c:481:12
    #9 0x577233 in gs_main_interpret /src/ghostpdl/./psi/imain.c:257:12
    #10 0x577233 in gs_main_run_string_end /src/ghostpdl/./psi/imain.c:945:12
    #11 0x577233 in gs_main_run_string_with_length /src/ghostpdl/./psi/imain.c:889:12
    #12 0x572741 in gs_main_run_string /src/ghostpdl/./psi/imain.c:870:12
    #13 0x11ddd7c in run_string /src/ghostpdl/./psi/imainarg.c:1169:12
    #14 0x11d9ea2 in swproc /src/ghostpdl/./psi/imainarg.c:367:20
    #15 0x11d6dee in gs_main_init_with_args01 /src/ghostpdl/./psi/imainarg.c:224:24
    #16 0x11ddb08 in gs_main_init_with_args /src/ghostpdl/./psi/imainarg.c:289:16
    #17 0xe7c742 in psapi_init_with_args /src/ghostpdl/./psi/psapi.c:281:12
    #18 0x56ec6a in gsapi_init_with_args /src/ghostpdl/./psi/iapi.c:253:12
    #19 0x56dd50 in fuzz_gs_device(unsigned char const*, unsigned long, int, char const*, char const*, int) /src/gs_fuzzlib.h:139:8
    #20 0x56e162 in LLVMFuzzerTestOneInput /src/gs_device_psdcmyk_fuzzer.cc:18:2
    #21 0x43f1d3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #22 0x43fcf5 in fuzzer::Fuzzer::TryDetectingAMemoryLeak(unsigned char const*, unsigned long, bool) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:687:3
    #23 0x42a97e in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:329:8
    #24 0x4301dc in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #25 0x459712 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #26 0x7e750572b082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)

DEDUP_TOKEN: __interceptor_malloc--gs_heap_alloc_bytes--chunk_obj_alloc
SUMMARY: AddressSanitizer: heap-use-after-free /src/ghostpdl/./pdf/pdf_colour.c:329:14 in pdfi_cspace_free_callback
Shadow bytes around the buggy address:
  0x0c62800138b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c62800138c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c62800138d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c62800138e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c62800138f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
=>0x0c6280013900: fd fd fd fd fd fd fd fd fd fd fd fd fd[fd]fd fd
  0x0c6280013910: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c6280013920: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c6280013930: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c6280013940: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c6280013950: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==13==ABORTING
