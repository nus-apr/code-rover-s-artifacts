INFO: Seed: 2331236877
INFO: Loaded 1 modules   (202722 inline 8-bit counters): 202722 [0x176b848, 0x179d02a), 
INFO: Loaded 1 PC tables (202722 PCs): 202722 [0x179d030,0x1ab4e50), 
/out/encoder_heic_fuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
decctx.h:301:45: runtime error: index 31 out of bounds for type 'std::shared_ptr<seq_parameter_set> const[16]'
    #0 0x9cbdc5 in decoder_context::has_sps(int) const /src/libde265/libde265/./decctx.h:301:45
    #1 0x9c7990 in pic_parameter_set::read(bitreader*, decoder_context*) /src/libde265/libde265/pps.cc:310:13
    #2 0x999336 in decoder_context::read_pps_NAL(bitreader&) /src/libde265/libde265/decctx.cc:574:27
    #3 0x9a0f55 in decoder_context::decode_NAL(NAL_unit*) /src/libde265/libde265/decctx.cc:1244:13
    #4 0x9a1d10 in decoder_context::decode(int*) /src/libde265/libde265/decctx.cc:1318:16
    #5 0x935729 in libde265_v1_decode_image(void*, heif_image**) /src/libheif/libheif/heif_decoder_libde265.cc:285:18
    #6 0x91f474 in heif::HeifContext::decode_image(unsigned int, std::__1::shared_ptr<heif::HeifPixelImage>&, heif_decoding_options const*) const /src/libheif/libheif/heif_context.cc:791:11
    #7 0x91e993 in heif::HeifContext::Image::decode_image(std::__1::shared_ptr<heif::HeifPixelImage>&, heif_colorspace, heif_chroma, heif_decoding_options const*) const /src/libheif/libheif/heif_context.cc:727:31
    #8 0x909896 in heif_decode_image /src/libheif/libheif/heif.cc:458:33
    #9 0x7b2ae6 in ReadHEICImage /src/imagemagick/coders/heic.c:267:9
    #10 0x544790 in ReadImage /src/imagemagick/MagickCore/constitute.c:500:13
    #11 0x5084d7 in BlobToImage /src/imagemagick/MagickCore/blob.c:473:13
    #12 0x4652ef in Magick::Image::read(Magick::Blob const&) /src/imagemagick/Magick++/lib/Image.cpp:4029:12
    #13 0x432cfd in LLVMFuzzerTestOneInput /src/imagemagick/Magick++/fuzz/encoder_fuzzer.cc:46:11
    #14 0x4410c0 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:526:13
    #15 0x4333ac in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:280:6
    #16 0x436b57 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:707:9
    #17 0x4330b8 in main /src/libfuzzer/FuzzerMain.cpp:20:10
    #18 0x7dc01597683f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #19 0x408c18 in _start (/out/encoder_heic_fuzzer+0x408c18)

DEDUP_TOKEN: decoder_context::has_sps(int) const--pic_parameter_set::read(bitreader*, decoder_context*)--decoder_context::read_pps_NAL(bitreader&)
SUMMARY: UndefinedBehaviorSanitizer: undefined-behavior decctx.h:301:45 in 
