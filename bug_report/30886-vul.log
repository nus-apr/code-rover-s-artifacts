INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2260570067
INFO: Loaded 1 modules   (13651 inline 8-bit counters): 13651 [0xa458d0, 0xa48e23), 
INFO: Loaded 1 PC tables (13651 PCs): 13651 [0x747da0,0x77d2d0), 
/out/mruby_fuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
line 12:6: string too long (truncated)
=================================================================
==13==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x631000060820 at pc 0x000000522337 bp 0x7ffc8c1870f0 sp 0x7ffc8c1868b8
READ of size 65536 at 0x631000060820 thread T0
SCARINESS: 26 (multi-byte-read-heap-buffer-overflow)
    #0 0x522336 in __asan_memcpy /src/llvm-project/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3
    #1 0x5ba4af in heredoc_remove_indent /src/mruby/mrbgems/mruby-compiler/core/parse.y:4697:9
    #2 0x5b67f0 in parse_string /src/mruby/mrbgems/mruby-compiler/core/parse.y:4756:11
    #3 0x5acaa3 in parser_yylex /src/mruby/mrbgems/mruby-compiler/core/parse.y
    #4 0x5a81c1 in yylex /src/mruby/mrbgems/mruby-compiler/core/parse.y:6447:10
    #5 0x595401 in yyparse /src/mruby/mrbgems/mruby-compiler/core/y.tab.c:6176:16
    #6 0x594810 in mrb_parser_parse /src/mruby/mrbgems/mruby-compiler/core/parse.y:6519:13
    #7 0x5a65f0 in mrb_parse_nstring /src/mruby/mrbgems/mruby-compiler/core/parse.y:6725:3
    #8 0x5a76bf in mrb_load_nstring_cxt /src/mruby/mrbgems/mruby-compiler/core/parse.y:6863:29
    #9 0x5a7753 in mrb_load_string_cxt /src/mruby/mrbgems/mruby-compiler/core/parse.y:6875:10
    #10 0x5a7782 in mrb_load_string /src/mruby/mrbgems/mruby-compiler/core/parse.y:6881:10
    #11 0x555c51 in LLVMFuzzerTestOneInput /src/mruby/oss-fuzz/mruby_fuzzer.c:14:5
    #12 0x45a8e1 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15
    #13 0x444672 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6
    #14 0x44a9b5 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:856:9
    #15 0x474862 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #16 0x7e483de1683f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #17 0x41f588 in _start (/out/mruby_fuzzer+0x41f588)

DEDUP_TOKEN: __asan_memcpy--heredoc_remove_indent--parse_string
0x631000060820 is located 0 bytes to the right of 65568-byte region [0x631000050800,0x631000060820)
allocated by thread T0 here:
    #0 0x5232a9 in realloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:164:3
    #1 0x555e55 in mrb_default_allocf /src/mruby/src/state.c:68:12
    #2 0x55b173 in mrb_realloc_simple /src/mruby/src/gc.c:227:8
    #3 0x55b6a5 in mrb_malloc_simple /src/mruby/src/gc.c:263:10
    #4 0x5cb82b in page_alloc /src/mruby/src/pool.c:98:34
    #5 0x5cb6ec in mrb_pool_alloc /src/mruby/src/pool.c:125:10
    #6 0x5a632c in parser_palloc /src/mruby/mrbgems/mruby-compiler/core/parse.y:105:13
    #7 0x5baee0 in parser_strndup /src/mruby/mrbgems/mruby-compiler/core/parse.y:199:21
    #8 0x5ab73f in new_str /src/mruby/mrbgems/mruby-compiler/core/parse.y:1006:10
    #9 0x5b6531 in parse_string /src/mruby/mrbgems/mruby-compiler/core/parse.y:4775:18
    #10 0x5acaa3 in parser_yylex /src/mruby/mrbgems/mruby-compiler/core/parse.y
    #11 0x5a81c1 in yylex /src/mruby/mrbgems/mruby-compiler/core/parse.y:6447:10
    #12 0x595401 in yyparse /src/mruby/mrbgems/mruby-compiler/core/y.tab.c:6176:16
    #13 0x594810 in mrb_parser_parse /src/mruby/mrbgems/mruby-compiler/core/parse.y:6519:13
    #14 0x5a65f0 in mrb_parse_nstring /src/mruby/mrbgems/mruby-compiler/core/parse.y:6725:3
    #15 0x5a76bf in mrb_load_nstring_cxt /src/mruby/mrbgems/mruby-compiler/core/parse.y:6863:29
    #16 0x5a7753 in mrb_load_string_cxt /src/mruby/mrbgems/mruby-compiler/core/parse.y:6875:10
    #17 0x5a7782 in mrb_load_string /src/mruby/mrbgems/mruby-compiler/core/parse.y:6881:10
    #18 0x555c51 in LLVMFuzzerTestOneInput /src/mruby/oss-fuzz/mruby_fuzzer.c:14:5
    #19 0x45a8e1 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15
    #20 0x444672 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6
    #21 0x44a9b5 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:856:9
    #22 0x474862 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #23 0x7e483de1683f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: realloc--mrb_default_allocf--mrb_realloc_simple
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/llvm-project/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3 in __asan_memcpy
Shadow bytes around the buggy address:
  0x0c62800040b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c62800040c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c62800040d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c62800040e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c62800040f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0c6280004100: 00 00 00 00[fa]fa fa fa fa fa fa fa fa fa fa fa
  0x0c6280004110: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c6280004120: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c6280004130: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c6280004140: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c6280004150: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==13==ABORTING
