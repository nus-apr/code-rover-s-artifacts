INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2312821733
INFO: Loaded 1 modules   (50596 inline 8-bit counters): 50596 [0x1029cc8, 0x103626c), 
INFO: Loaded 1 PC tables (50596 PCs): 50596 [0x1036270,0x10fbcb0), 
/out/FuzzJs: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: use-after-poison on address 0x62d0002dec50 at pc 0x000000656353 bp 0x7ffdf43e2590 sp 0x7ffdf43e2588
WRITE of size 8 at 0x62d0002dec50 thread T0
SCARINESS: 52 (8-byte-write-use-after-poison)
    #0 0x656352 in AK::Atomic<unsigned long, (AK::MemoryOrder)5>::fetch_or(unsigned long, AK::MemoryOrder) volatile /src/serenity/Meta/Lagom/build/../../../AK/Atomic.h:226:16
    #1 0x656352 in AK::RefPtrTraits<AK::StringImpl>::lock(AK::Atomic<unsigned long, (AK::MemoryOrder)5>&) /src/serenity/Meta/Lagom/build/../../../AK/RefPtr.h:93:31
    #2 0x656352 in AK::RefPtr<AK::StringImpl, AK::RefPtrTraits<AK::StringImpl> >::add_ref_raw() const /src/serenity/Meta/Lagom/build/../../../AK/RefPtr.h:413:24
    #3 0x656352 in AK::RefPtr<AK::StringImpl, AK::RefPtrTraits<AK::StringImpl> >::RefPtr(AK::RefPtr<AK::StringImpl, AK::RefPtrTraits<AK::StringImpl> > const&) /src/serenity/Meta/Lagom/build/../../../AK/RefPtr.h:171:24
    #4 0x6562c0 in AK::String::String(AK::String const&) /src/serenity/Meta/Lagom/build/../../../AK/String.h:52:11
    #5 0x944500 in JS::abstract_relation(JS::GlobalObject&, bool, JS::Value, JS::Value) /src/serenity/Userland/Libraries/LibJS/Runtime/Value.cpp:1405:25
    #6 0x945d4d in JS::less_than(JS::GlobalObject&, JS::Value, JS::Value) /src/serenity/Userland/Libraries/LibJS/Runtime/Value.cpp:806:25
    #7 0xa2b74f in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:602:16
    #8 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #9 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #10 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #11 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #12 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #13 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #14 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #15 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #16 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #17 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #18 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #19 0xa4db27 in JS::SequenceExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:2250:33
    #20 0xa1de27 in JS::ExpressionStatement::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:109:26
    #21 0x6617a4 in JS::Interpreter::execute_statement(JS::GlobalObject&, JS::Statement const&, JS::ScopeType) /src/serenity/Userland/Libraries/LibJS/Interpreter.cpp:172:27
    #22 0xa1d686 in JS::Program::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:91:24
    #23 0x65da59 in JS::Interpreter::run(JS::GlobalObject&, JS::Program const&) /src/serenity/Userland/Libraries/LibJS/Interpreter.cpp:58:26
    #24 0x654cda in LLVMFuzzerTestOneInput /src/serenity/Meta/Lagom/build/../Fuzzers/FuzzJs.cpp:24:22
    #25 0x557533 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15
    #26 0x542c72 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6
    #27 0x54891e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:856:9
    #28 0x572052 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #29 0x71493187983f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #30 0x51df88 in _start (/out/FuzzJs+0x51df88)

DEDUP_TOKEN: AK::Atomic<unsigned long, (AK::MemoryOrder)5>::fetch_or(unsigned long, AK::MemoryOrder) volatile--AK::RefPtrTraits<AK::StringImpl>::lock(AK::Atomic<unsigned long, (AK::MemoryOrder)5>&)--AK::RefPtr<AK::StringImpl, AK::RefPtrTraits<AK::StringImpl> >::add_ref_raw() const
0x62d0002dec50 is located 11344 bytes inside of 16384-byte region [0x62d0002dc000,0x62d0002e0000)
allocated by thread T0 here:
    #0 0x621bc2 in aligned_alloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:192:3
    #1 0xa69cfc in JS::BlockAllocator::allocate_block(char const*) /src/serenity/Userland/Libraries/LibJS/Heap/BlockAllocator.cpp:58:31
    #2 0x7bd9bd in JS::HeapBlock::create_with_cell_size(JS::Heap&, unsigned long) /src/serenity/Userland/Libraries/LibJS/Heap/HeapBlock.cpp:29:66
    #3 0xa6ad73 in JS::CellAllocator::allocate_cell(JS::Heap&) /src/serenity/Userland/Libraries/LibJS/Heap/CellAllocator.cpp:27:22
    #4 0x7a85c3 in JS::Heap::allocate_cell(unsigned long) /src/serenity/Userland/Libraries/LibJS/Heap/Heap.cpp:67:22
    #5 0x85d914 in JS::PrimitiveString* JS::Heap::allocate_without_global_object<JS::PrimitiveString, AK::String>(AK::String&&) /src/serenity/Meta/Lagom/build/../../../Userland/Libraries/LibJS/Heap/Heap.h:35:24
    #6 0x85d6e6 in JS::js_string(JS::Heap&, AK::String) /src/serenity/Userland/Libraries/LibJS/Runtime/PrimitiveString.cpp:29:17
    #7 0x85dac1 in JS::js_string(JS::VM&, AK::String) /src/serenity/Userland/Libraries/LibJS/Runtime/PrimitiveString.cpp:34:12
    #8 0x882a43 in JS::RegExpPrototype::to_string(JS::VM&, JS::GlobalObject&) /src/serenity/Userland/Libraries/LibJS/Runtime/RegExpPrototype.cpp:248:12
    #9 0x7c0bb1 in AK::Function<JS::Value (JS::VM&, JS::GlobalObject&)>::CallableWrapper<JS::Value (*)(JS::VM&, JS::GlobalObject&)>::call(JS::VM&, JS::GlobalObject&) /src/serenity/Meta/Lagom/build/../../../AK/Function.h:151:20
    #10 0x82ba5a in AK::Function<JS::Value (JS::VM&, JS::GlobalObject&)>::operator()(JS::VM&, JS::GlobalObject&) const /src/serenity/Meta/Lagom/build/../../../AK/Function.h:91:25
    #11 0x82b8ec in JS::NativeFunction::call() /src/serenity/Userland/Libraries/LibJS/Runtime/NativeFunction.cpp:42:12
    #12 0x931bdd in JS::VM::call_internal(JS::Function&, JS::Value, AK::Optional<JS::MarkedValueList>) /src/serenity/Userland/Libraries/LibJS/Runtime/VM.cpp:553:28
    #13 0x84986a in JS::Value JS::VM::call<AK::Optional<JS::MarkedValueList> >(JS::Function&, JS::Value, AK::Optional<JS::MarkedValueList>) /src/serenity/Meta/Lagom/build/../../../Userland/Libraries/LibJS/Runtime/VM.h:299:128
    #14 0x84986a in JS::Value JS::VM::call<>(JS::Function&, JS::Value) /src/serenity/Meta/Lagom/build/../../../Userland/Libraries/LibJS/Runtime/VM.h:302:91
    #15 0x84986a in JS::Object::ordinary_to_primitive(JS::Value::PreferredType) const /src/serenity/Userland/Libraries/LibJS/Runtime/Object.cpp:1048:30
    #16 0x93fa1c in JS::Value::to_primitive(JS::GlobalObject&, JS::Value::PreferredType) const /src/serenity/Userland/Libraries/LibJS/Runtime/Value.cpp:424:28
    #17 0x93fa1c in JS::Value::to_numeric(JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/Runtime/Value.cpp:459:22
    #18 0x94b7f1 in JS::sub(JS::GlobalObject&, JS::Value, JS::Value) /src/serenity/Userland/Libraries/LibJS/Runtime/Value.cpp:1058:28
    #19 0xa2b931 in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:580:16
    #20 0xa2b3fb in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:572:30
    #21 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #22 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #23 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #24 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #25 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #26 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #27 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #28 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #29 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #30 0xa2b30a in JS::BinaryExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:569:30
    #31 0xa4db27 in JS::SequenceExpression::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:2250:33
    #32 0xa1de27 in JS::ExpressionStatement::execute(JS::Interpreter&, JS::GlobalObject&) const /src/serenity/Userland/Libraries/LibJS/AST.cpp:109:26

DEDUP_TOKEN: aligned_alloc--JS::BlockAllocator::allocate_block(char const*)--JS::HeapBlock::create_with_cell_size(JS::Heap&, unsigned long)
SUMMARY: AddressSanitizer: use-after-poison /src/serenity/Meta/Lagom/build/../../../AK/Atomic.h:226:16 in AK::Atomic<unsigned long, (AK::MemoryOrder)5>::fetch_or(unsigned long, AK::MemoryOrder) volatile
Shadow bytes around the buggy address:
  0x0c5a80053d30: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
  0x0c5a80053d40: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
  0x0c5a80053d50: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
  0x0c5a80053d60: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
  0x0c5a80053d70: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
=>0x0c5a80053d80: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7[f7]f7 f7 f7 f7 f7
  0x0c5a80053d90: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
  0x0c5a80053da0: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
  0x0c5a80053db0: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
  0x0c5a80053dc0: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
  0x0c5a80053dd0: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==13==ABORTING
