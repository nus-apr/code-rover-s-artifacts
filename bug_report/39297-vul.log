INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2309928388
INFO: Loaded 2 modules   (193114 inline 8-bit counters): 160696 [0x1f8e6e0, 0x1fb5a98), 32418 [0x70e096d6c8c0, 0x70e096d74762), 
INFO: Loaded 2 PC tables (193114 PCs): 160696 [0x1fb5a98,0x2229618), 32418 [0x70e096d74768,0x70e096df3188), 
/out/php-fuzz-function-jit: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: heap-use-after-free on address 0x60b0000017a0 at pc 0x000000f0eb1f bp 0x7fff5de56f20 sp 0x7fff5de56f18
READ of size 4 at 0x60b0000017a0 thread T0
SCARINESS: 45 (4-byte-read-heap-use-after-free)
    #0 0xf0eb1e in zend_gc_delref /src/php-src/Zend/zend_types.h:1183:2
    #1 0xf0eb1e in i_zval_ptr_dtor /src/php-src/Zend/zend_variables.h:43:8
    #2 0xf0eb1e in zval_ptr_dtor /src/php-src/Zend/zend_variables.c:84:2
    #3 0xf6a193 in _zend_hash_del_el_ex /src/php-src/Zend/zend_hash.c:1354:3
    #4 0xf70edf in _zend_hash_del_el /src/php-src/Zend/zend_hash.c:1377:2
    #5 0xf70edf in zend_hash_graceful_reverse_destroy /src/php-src/Zend/zend_hash.c:1831:3
    #6 0xeca9e2 in zend_shutdown_executor_values /src/php-src/Zend/zend_execute_API.c:277:3
    #7 0xecc937 in shutdown_executor /src/php-src/Zend/zend_execute_API.c:391:2
    #8 0xf17125 in zend_deactivate /src/php-src/Zend/zend.c:1259:2
    #9 0xd5f039 in php_request_shutdown /src/php-src/main/main.c:1831:2
    #10 0x13858e1 in fuzzer_request_shutdown /src/php-src/sapi/fuzzer/fuzzer-sapi.c:208:2
    #11 0x1385f78 in fuzzer_do_request_from_buffer /src/php-src/sapi/fuzzer/fuzzer-sapi.c:288:2
    #12 0x138459c in LLVMFuzzerTestOneInput /src/php-src/sapi/fuzzer/fuzzer-function-jit.c:42:3
    #13 0x639853 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) cxa_noexception.cpp
    #14 0x6251b2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #15 0x62ac2d in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) cxa_noexception.cpp
    #16 0x653ba2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #17 0x70e097f23082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)
    #18 0x6023bd in _start (/out/php-fuzz-function-jit+0x6023bd)

DEDUP_TOKEN: zend_gc_delref--i_zval_ptr_dtor--zval_ptr_dtor
0x60b0000017a0 is located 0 bytes inside of 104-byte region [0x60b0000017a0,0x60b000001808)
freed by thread T0 here:
    #0 0x707bd2 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3
    #1 0xe4d215 in tracked_free /src/php-src/Zend/zend_alloc.c:2761:2
    #2 0xe45128 in _efree_custom /src/php-src/Zend/zend_alloc.c:2428:3
    #3 0xe45128 in _efree /src/php-src/Zend/zend_alloc.c:2548:3
    #4 0xf0f6b3 in zend_string_destroy /src/php-src/Zend/zend_variables.c:67:2
    #5 0xf0e874 in rc_dtor_func /src/php-src/Zend/zend_variables.c:57:2
    #6 0x120a9aa in i_zval_ptr_dtor /src/php-src/Zend/zend_variables.h:44:4
    #7 0x120a9aa in zend_object_std_dtor /src/php-src/Zend/zend_objects.c:70:5
    #8 0x12205dd in zend_objects_store_del /src/php-src/Zend/zend_objects_API.c:200:4
    #9 0xf0ea5f in rc_dtor_func /src/php-src/Zend/zend_variables.c:57:2
    #10 0xf0ea5f in i_zval_ptr_dtor /src/php-src/Zend/zend_variables.h:44:4
    #11 0xf0ea5f in zval_ptr_dtor /src/php-src/Zend/zend_variables.c:84:2
    #12 0xf6a193 in _zend_hash_del_el_ex /src/php-src/Zend/zend_hash.c:1354:3
    #13 0xf724c6 in _zend_hash_del_el /src/php-src/Zend/zend_hash.c:1377:2
    #14 0xf724c6 in zend_hash_reverse_apply /src/php-src/Zend/zend_hash.c:1948:4
    #15 0xeca151 in shutdown_destructors /src/php-src/Zend/zend_execute_API.c:252:4
    #16 0xf16e8d in zend_call_destructors /src/php-src/Zend/zend.c:1242:3
    #17 0xd5ec81 in php_request_shutdown /src/php-src/main/main.c:1793:3
    #18 0x13858e1 in fuzzer_request_shutdown /src/php-src/sapi/fuzzer/fuzzer-sapi.c:208:2
    #19 0x1385f78 in fuzzer_do_request_from_buffer /src/php-src/sapi/fuzzer/fuzzer-sapi.c:288:2
    #20 0x138459c in LLVMFuzzerTestOneInput /src/php-src/sapi/fuzzer/fuzzer-function-jit.c:42:3
    #21 0x639853 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) cxa_noexception.cpp
    #22 0x6251b2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #23 0x62ac2d in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) cxa_noexception.cpp
    #24 0x653ba2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #25 0x70e097f23082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)

DEDUP_TOKEN: free--tracked_free--_efree_custom
previously allocated by thread T0 here:
LLVMSymbolizer: error reading file: No such file or directory
    #0 0x707e3d in __interceptor_malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:129:3
    #1 0xe4262a in __zend_malloc /src/php-src/Zend/zend_alloc.c:3043:14
    #2 0xe4262a in tracked_malloc /src/php-src/Zend/zend_alloc.c:2746:14
    #3 0xe44e47 in _malloc_custom /src/php-src/Zend/zend_alloc.c:2419:10
    #4 0xe44e47 in _emalloc /src/php-src/Zend/zend_alloc.c:2538:10
    #5 0x118c517 in zend_string_alloc /src/php-src/Zend/zend_string.h:149:36
    #6 0x118c517 in zend_string_init /src/php-src/Zend/zend_string.h:171:21
    #7 0x118c517 in zend_throw_exception /src/php-src/Zend/zend_exceptions.c:833:35
    #8 0xf1acaf in zend_type_error /src/php-src/Zend/zend.c:1654:2
    #9 0xfa3737 in zend_throw_ref_type_error_zval /src/php-src/Zend/zend_execute.c:3185:2
    #10 0xfa42d2 in zend_verify_ref_assignable_zval /src/php-src/Zend/zend_execute.c:3270:4
    #11 0xfa4e01 in zend_assign_to_typed_ref /src/php-src/Zend/zend_execute.c:3346:8
    #12 0x70e096ca2159 in zend_assign_to_variable /src/php-src/Zend/zend_execute.h:146:13
    #13 0x70e096ca2159 in zend_jit_assign_to_typed_ref_helper /src/php-src/ext/opcache/jit/zend_jit_helpers.c:1744:2
    #14 0x70e096ca1b25 in zend_jit_assign_const_to_typed_ref /src/php-src/ext/opcache/jit/zend_jit_helpers.c:1749:2
    #15 0x49b6f44a  (/dev/zero (deleted)+0x800144a)
    #16 0xfae1c8 in zend_execute /src/php-src/Zend/zend_vm_execute.h:58962:2
    #17 0x1385e9d in fuzzer_do_request_from_buffer /src/php-src/sapi/fuzzer/fuzzer-sapi.c:276:5
    #18 0x138459c in LLVMFuzzerTestOneInput /src/php-src/sapi/fuzzer/fuzzer-function-jit.c:42:3
    #19 0x639853 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) cxa_noexception.cpp
    #20 0x6251b2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #21 0x62ac2d in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) cxa_noexception.cpp
    #22 0x653ba2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #23 0x70e097f23082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)

DEDUP_TOKEN: __interceptor_malloc--__zend_malloc--tracked_malloc
SUMMARY: AddressSanitizer: heap-use-after-free /src/php-src/Zend/zend_types.h:1183:2 in zend_gc_delref
Shadow bytes around the buggy address:
  0x0c167fff82a0: 00 00 00 00 00 00 00 00 00 00 fa fa fa fa fa fa
  0x0c167fff82b0: fa fa fd fd fd fd fd fd fd fd fd fd fd fd fd fa
  0x0c167fff82c0: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x0c167fff82d0: fd fd fd fd fd fa fa fa fa fa fa fa fa fa fd fd
  0x0c167fff82e0: fd fd fd fd fd fd fd fd fd fd fd fa fa fa fa fa
=>0x0c167fff82f0: fa fa fa fa[fd]fd fd fd fd fd fd fd fd fd fd fd
  0x0c167fff8300: fd fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c167fff8310: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c167fff8320: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c167fff8330: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c167fff8340: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==13==ABORTING
