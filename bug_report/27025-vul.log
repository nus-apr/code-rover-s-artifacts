INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2252148322
INFO: Loaded 1 modules   (25036 inline 8-bit counters): 25036 [0xb676a0, 0xb6d86c), 
INFO: Loaded 1 PC tables (25036 PCs): 25036 [0xb6d870,0xbcf530), 
/out/flb-it-fuzz-config_map_fuzzer_OSSFUZZ: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: attempting double-free on 0x603000000160 in thread T0:
SCARINESS: 42 (double-free)
    #0 0x53f742 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:127:3
    #1 0x575850 in flb_free /src/fluent-bit/include/fluent-bit/flb_mem.h:122:5
    #2 0x575820 in flb_sds_destroy /src/fluent-bit/src/flb_sds.c:393:5
    #3 0x5705a5 in flb_kv_item_destroy /src/fluent-bit/src/flb_kv.c:87:9
    #4 0x5706c0 in flb_kv_release /src/fluent-bit/src/flb_kv.c:102:9
    #5 0x570002 in LLVMFuzzerTestOneInput /src/fluent-bit/tests/internal/fuzzers/config_map_fuzzer.c:186:9
    #6 0x478851 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15
    #7 0x462552 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6
    #8 0x468885 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:854:9
    #9 0x492792 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #10 0x73180a22183f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #11 0x43d588 in _start (/out/flb-it-fuzz-config_map_fuzzer_OSSFUZZ+0x43d588)

DEDUP_TOKEN: free--flb_free--flb_sds_destroy
0x603000000160 is located 0 bytes inside of 32-byte region [0x603000000160,0x603000000180)
freed by thread T0 here:
    #0 0x53f742 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:127:3
    #1 0x575850 in flb_free /src/fluent-bit/include/fluent-bit/flb_mem.h:122:5
    #2 0x575820 in flb_sds_destroy /src/fluent-bit/src/flb_sds.c:393:5
    #3 0x57971d in destroy_map_val /src/fluent-bit/src/flb_config_map.c:352:9
    #4 0x578dc5 in flb_config_map_destroy /src/fluent-bit/src/flb_config_map.c:380:17
    #5 0x56fff7 in LLVMFuzzerTestOneInput /src/fluent-bit/tests/internal/fuzzers/config_map_fuzzer.c:185:9
    #6 0x478851 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15
    #7 0x462552 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6
    #8 0x468885 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:854:9
    #9 0x492792 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #10 0x73180a22183f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: free--flb_free--flb_sds_destroy
previously allocated by thread T0 here:
    #0 0x53f9ad in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3
    #1 0x575897 in flb_malloc /src/fluent-bit/include/fluent-bit/flb_mem.h:62:11
    #2 0x572e09 in sds_alloc /src/fluent-bit/src/flb_sds.c:40:11
    #3 0x572d10 in flb_sds_create_len /src/fluent-bit/src/flb_sds.c:61:9
    #4 0x5702f4 in flb_kv_item_create_len /src/fluent-bit/src/flb_kv.c:50:19
    #5 0x57051a in flb_kv_item_create /src/fluent-bit/src/flb_kv.c:77:12
    #6 0x56ffa6 in LLVMFuzzerTestOneInput /src/fluent-bit/tests/internal/fuzzers/config_map_fuzzer.c:179:9
    #7 0x478851 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15
    #8 0x462552 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6
    #9 0x468885 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:854:9
    #10 0x492792 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #11 0x73180a22183f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: malloc--flb_malloc--sds_alloc
SUMMARY: AddressSanitizer: double-free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:127:3 in free
==13==ABORTING
