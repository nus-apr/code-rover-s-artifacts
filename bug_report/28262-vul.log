======================= INFO =========================
This binary is built for AFL-fuzz.
To run the target function on individual input(s) execute this:
  /out/qpdf_fuzzer < INPUT_FILE
or
  /out/qpdf_fuzzer INPUT_FILE1 [INPUT_FILE2 ... ]
To fuzz with afl-fuzz execute this:
  afl-fuzz [afl-flags] /out/qpdf_fuzzer [-N]
afl-fuzz will run N iterations before re-spawning the process (default: 1000)
======================================================
Reading 40395 bytes from /tmp/poc
WARNING: fuzz input: can't find PDF header
WARNING: fuzz input: file is damaged
WARNING: fuzz input (offset 78063): xref not found
WARNING: fuzz input: Attempting to reconstruct cross-reference table
WARNING: fuzz input, object 22 0 at offset 34424 -> dictionary key /Pages: operation for dictionary attempted on object of type null: returning null for attempted key retrieval
WARNING: fuzz input, object 22 0 at offset 34424 -> dictionary key /Pages: operation for dictionary attempted on object of type null: returning false for a key containment request
WARNING: fuzz input, object 22 0 at offset 34424 -> dictionary key /Pages: operation for dictionary attempted on object of type null: returning null for attempted key retrieval
WARNING: fuzz input (object 4 0, offset 36604): unknown token while reading object; treating as string
WARNING: fuzz input (object 5 0, offset 4453): expected endstream
WARNING: fuzz input (object 5 0, offset 3769): attempting to recover stream length
WARNING: fuzz input (object 5 0, offset 3769): recovered stream length: 403
WARNING: fuzz input (object 34 0, offset 35870): expected dictionary key but found non-name object; inserting key /QPDFFake1
WARNING: fuzz input (object 53 0, offset 14474): /Length key in stream dictionary is not an integer
WARNING: fuzz input (object 53 0, offset 14526): attempting to recover stream length
WARNING: fuzz input (object 53 0, offset 14526): recovered stream length: 69
WARNING: fuzz input (object 73 0, offset 31090): unknown token while reading object; treating as string
WARNING: fuzz input (object 73 0, offset 31050): expected dictionary key but found non-name object; inserting key /QPDFFake1
WARNING: fuzz input (object 73 0, offset 31050): expected dictionary key but found non-name object; inserting key /QPDFFake2
WARNING: fuzz input (object 81 0, offset 32041): expected endobj
WARNING: fuzz input (object 82 0, offset 17979): unknown token while reading object; treating as string
WARNING: fuzz input (object 82 0, offset 17947): expected dictionary key but found non-name object; inserting key /QPDFFake1
WARNING: fuzz input (object 82 0, offset 18005): expected endobj
WARNING: fuzz input (object 94 0, offset 33577): unexpected dictionary close token
WARNING: fuzz input (object 94 0, offset 33581): unknown token while reading object; treating as string
WARNING: fuzz input (object 94 0, offset 33594): unknown token while reading object; treating as string
WARNING: fuzz input (object 94 0, offset 33745): unknown token while reading object; treating as string
WARNING: fuzz input (object 94 0, offset 33758): unknown token while reading object; treating as string
WARNING: fuzz input (object 94 0, offset 33806): unknown token while reading object; treating as string
WARNING: fuzz input (object 94 0, offset 33814): unknown token while reading object; treating as string
WARNING: fuzz input (object 94 0, offset 33818): unknown token while reading object; treating as string
WARNING: fuzz input (object 94 0, offset 33857): unknown token while reading object; treating as string
WARNING: fuzz input (object 94 0, offset 33862): unknown token while reading object; treating as string
WARNING: fuzz input (object 94 0, offset 33865): unknown token while reading object; treating as string
WARNING: fuzz input (object 94 0, offset 33865): too many errors; giving up on reading object
WARNING: fuzz input (object 94 0, offset 33867): expected endobj
WARNING: fuzz input (object 111 0, offset 23820): expected endstream
WARNING: fuzz input (object 111 0, offset 23738): attempting to recover stream length
WARNING: fuzz input (object 111 0, offset 23738): recovered stream length: 166
WARNING: fuzz input (object 125 0, offset 11873): expected endstream
WARNING: fuzz input (object 125 0, offset 11790): attempting to recover stream length
WARNING: fuzz input (object 125 0, offset 11790): recovered stream length: 10
WARNING: fuzz input (object 134 0, offset 25007): /Length key in stream dictionary is not an integer
WARNING: fuzz input (object 134 0, offset 25141): attempting to recover stream length
WARNING: fuzz input (object 134 0, offset 25141): recovered stream length: 84
WARNING: fuzz input (object 141 0, offset 26019): expected endstream
WARNING: fuzz input (object 141 0, offset 25935): attempting to recover stream length
WARNING: fuzz input (object 141 0, offset 25935): recovered stream length: 94
WARNING: fuzz input (object 146 0, offset 26598): expected dictionary key but found non-name object; inserting key /QPDFFake1
WARNING: fuzz input (object 158 0, offset 8218): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 8349): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 8362): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 8519): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 8532): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 8563): invalid character (") in hexstring
WARNING: fuzz input (object 158 0, offset 8570): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 8720): unexpected >
WARNING: fuzz input (object 158 0, offset 8538): expected dictionary key but found non-name object; inserting key /QPDFFake1
WARNING: fuzz input (object 158 0, offset 8538): expected dictionary key but found non-name object; inserting key /QPDFFake2
WARNING: fuzz input (object 158 0, offset 8827): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 8840): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 8992): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 9005): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 9155): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 9168): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 9339): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 9352): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 9542): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 9555): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 9667): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 9675): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 9679): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 9687): unexpected >
WARNING: fuzz input (object 158 0, offset 9688): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 9741): unknown token while reading object; treating as string
WARNING: fuzz input (object 158 0, offset 9741): too many errors; giving up on reading object
WARNING: fuzz input (object 158 0, offset 9744): expected endobj
WARNING: fuzz input (object 161 0, offset 8563): invalid character (") in hexstring
WARNING: fuzz input (object 161 0, offset 8570): unknown token while reading object; treating as string
WARNING: fuzz input (object 161 0, offset 8720): unexpected >
WARNING: fuzz input (object 161 0, offset 8538): expected dictionary key but found non-name object; inserting key /QPDFFake1
WARNING: fuzz input (object 161 0, offset 8538): expected dictionary key but found non-name object; inserting key /QPDFFake2
WARNING: fuzz input (object 167 0, offset 21524): unknown token while reading object; treating as string
WARNING: fuzz input (object 167 0, offset 21548): treating unexpected array close token as null
WARNING: fuzz input (object 167 0, offset 21384): expected dictionary key but found non-name object; inserting key /QPDFFake1
WARNING: fuzz input (object 171 0, offset 34014): expected endobj
WARNING: fuzz input (object 173 0, offset 7465): /Length key in stream dictionary is not an integer
WARNING: fuzz input (object 173 0, offset 7539): attempting to recover stream length
WARNING: fuzz input (object 173 0, offset 7539): recovered stream length: 144
WARNING: fuzz input (offset 34684): error decoding stream data for object 23 0: stream inflate: inflate: data: incorrect header check
WARNING: fuzz input (offset 34684): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 22947): error decoding stream data for object 104 0: character out of range during base 85 decode
WARNING: fuzz input (offset 22947): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 36470): error decoding stream data for object 2 0: stream inflate: inflate: data: incorrect header check
WARNING: fuzz input (offset 36470): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 33175): error decoding stream data for object 90 0: character out of range during base 85 decode
WARNING: fuzz input (offset 33175): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 33814): error decoding stream data for object 169 0: stream inflate: inflate: data: incorrect header check
WARNING: fuzz input (offset 33814): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 32913): error decoding stream data for object 88 0: character out of range during base 85 decode
WARNING: fuzz input (offset 32913): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 3769): error decoding stream data for object 5 0: stream inflate: inflate: data: incorrect header check
WARNING: fuzz input (offset 3769): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 34323): error decoding stream data for object 20 0: stream inflate: inflate: data: incorrect header check
WARNING: fuzz input (offset 34323): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 22688): error decoding stream data for object 102 0: character out of range during base 85 decode
WARNING: fuzz input (offset 22688): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 35045): error decoding stream data for object 26 0: stream inflate: inflate: data: incorrect header check
WARNING: fuzz input (offset 35045): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 23214): error decoding stream data for object 106 0: character out of range during base 85 decode
WARNING: fuzz input (offset 23214): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 35406): error decoding stream data for object 29 0: stream inflate: inflate: data: incorrect header check
WARNING: fuzz input (offset 35406): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 23474): error decoding stream data for object 108 0: character out of range during base 85 decode
WARNING: fuzz input (offset 23474): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 35768): error decoding stream data for object 32 0: stream inflate: inflate: data: incorrect header check
WARNING: fuzz input (offset 35768): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 23738): error decoding stream data for object 110 0: character out of range during base 85 decode
WARNING: fuzz input (offset 23738): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 36068): error decoding stream data for object 35 0: stream inflate: inflate: data: incorrect header check
WARNING: fuzz input (offset 36068): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 11971): error decoding stream data for object 112 0: character out of range during base 85 decode
WARNING: fuzz input (offset 11971): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 12716): error decoding stream data for object 38 0: stream inflate: inflate: data: incorrect header check
WARNING: fuzz input (offset 12716): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 13078): error decoding stream data for object 41 0: stream inflate: inflate: data: incorrect header check
WARNING: fuzz input (offset 13078): stream will be re-processed without filtering to avoid data loss
WARNING: fuzz input (offset 10732): error decoding stream data for object 116 0: stream inflate: inflate: data: incorrect header check
WARNING: fuzz input (offset 10732): stream will be re-processed without filtering to avoid data loss
=================================================================
==12==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6060000b784a at pc 0x00000065e27a bp 0x7ffc67d7fb10 sp 0x7ffc67d7fb08
WRITE of size 1 at 0x6060000b784a thread T0
SCARINESS: 41 (1-byte-write-heap-buffer-overflow-far-from-bounds)
    #0 0x65e279 in Pl_ASCII85Decoder::write(unsigned char*, unsigned long) /src/qpdf/libqpdf/Pl_ASCII85Decoder.cc:85:32
    #1 0x65d665 in Pl_AES_PDF::flush(bool) /src/qpdf/libqpdf/Pl_AES_PDF.cc:263:16
    #2 0x65da41 in Pl_AES_PDF::finish() /src/qpdf/libqpdf/Pl_AES_PDF.cc
    #3 0x4fe12f in QPDF::pipeStreamData(PointerHolder<QPDF::EncryptionParameters>, PointerHolder<InputSource>, QPDF&, int, int, long long, unsigned long, QPDFObjectHandle, bool, Pipeline*, bool, bool) /src/qpdf/libqpdf/QPDF.cc:2718:23
    #4 0x4fe72d in QPDF::pipeStreamData(int, int, long long, unsigned long, QPDFObjectHandle, Pipeline*, bool, bool) /src/qpdf/libqpdf/QPDF.cc:2738:12
    #5 0x5e0fa6 in QPDF::Pipe::pipeStreamData(QPDF*, int, int, long long, unsigned long, QPDFObjectHandle, Pipeline*, bool, bool) /src/qpdf/include/qpdf/QPDF.hh:670:19
    #6 0x5dbe1c in QPDF_Stream::pipeStreamData(Pipeline*, unsigned long, qpdf_stream_decode_level_e, bool, bool) /src/qpdf/libqpdf/QPDF_Stream.cc:664:8
    #7 0x5ac963 in QPDFWriter::unparseObject(QPDFObjectHandle, int, unsigned int, unsigned long, bool) /src/qpdf/libqpdf/QPDFWriter.cc:1782:24
    #8 0x5a715b in QPDFWriter::unparseObject(QPDFObjectHandle, int, unsigned int) /src/qpdf/libqpdf/QPDFWriter.cc:1436:5
    #9 0x5b258c in QPDFWriter::writeObject(QPDFObjectHandle, int) /src/qpdf/libqpdf/QPDFWriter.cc:2103:2
    #10 0x5bad96 in QPDFWriter::writeStandard() /src/qpdf/libqpdf/QPDFWriter.cc:3555:2
    #11 0x5b706e in QPDFWriter::write() /src/qpdf/libqpdf/QPDFWriter.cc:2686:2
    #12 0x4c7cb2 in FuzzHelper::doWrite(PointerHolder<QPDFWriter>) /src/qpdf/fuzz/qpdf_fuzzer.cc:72:12
    #13 0x4c8084 in FuzzHelper::testWrite() /src/qpdf/fuzz/qpdf_fuzzer.cc:90:5
    #14 0x4ca42a in FuzzHelper::doChecks() /src/qpdf/fuzz/qpdf_fuzzer.cc:179:5
    #15 0x4ca46b in FuzzHelper::run() /src/qpdf/fuzz/qpdf_fuzzer.cc:195:9
    #16 0x4ca70e in LLVMFuzzerTestOneInput /src/qpdf/fuzz/qpdf_fuzzer.cc:210:7
    #17 0x4d1b9a in ExecuteFilesOnyByOne /src/libfuzzer/afl/afl_driver.cpp:216:5
    #18 0x4d1b9a in main /src/libfuzzer/afl/afl_driver.cpp:253
    #19 0x7df74193783f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #20 0x41dec8 in _start (/out/qpdf_fuzzer+0x41dec8)

DEDUP_TOKEN: Pl_ASCII85Decoder::write(unsigned char*, unsigned long)--Pl_AES_PDF::flush(bool)--Pl_AES_PDF::finish()
0x6060000b784a is located 10 bytes to the right of 64-byte region [0x6060000b7800,0x6060000b7840)
allocated by thread T0 here:
    #0 0x4c4bbd in operator new(unsigned long) /src/llvm/projects/compiler-rt/lib/asan/asan_new_delete.cc:99:3
    #1 0x5db6a4 in QPDF_Stream::pipeStreamData(Pipeline*, unsigned long, qpdf_stream_decode_level_e, bool, bool) /src/qpdf/libqpdf/QPDF_Stream.cc:578:14
    #2 0x5ac963 in QPDFWriter::unparseObject(QPDFObjectHandle, int, unsigned int, unsigned long, bool) /src/qpdf/libqpdf/QPDFWriter.cc:1782:24
    #3 0x5a715b in QPDFWriter::unparseObject(QPDFObjectHandle, int, unsigned int) /src/qpdf/libqpdf/QPDFWriter.cc:1436:5
    #4 0x5b258c in QPDFWriter::writeObject(QPDFObjectHandle, int) /src/qpdf/libqpdf/QPDFWriter.cc:2103:2
    #5 0x5bad96 in QPDFWriter::writeStandard() /src/qpdf/libqpdf/QPDFWriter.cc:3555:2
    #6 0x5b706e in QPDFWriter::write() /src/qpdf/libqpdf/QPDFWriter.cc:2686:2
    #7 0x4c7cb2 in FuzzHelper::doWrite(PointerHolder<QPDFWriter>) /src/qpdf/fuzz/qpdf_fuzzer.cc:72:12
    #8 0x4c8084 in FuzzHelper::testWrite() /src/qpdf/fuzz/qpdf_fuzzer.cc:90:5
    #9 0x4ca42a in FuzzHelper::doChecks() /src/qpdf/fuzz/qpdf_fuzzer.cc:179:5
    #10 0x4ca46b in FuzzHelper::run() /src/qpdf/fuzz/qpdf_fuzzer.cc:195:9
    #11 0x4ca70e in LLVMFuzzerTestOneInput /src/qpdf/fuzz/qpdf_fuzzer.cc:210:7
    #12 0x4d1b9a in ExecuteFilesOnyByOne /src/libfuzzer/afl/afl_driver.cpp:216:5
    #13 0x4d1b9a in main /src/libfuzzer/afl/afl_driver.cpp:253
    #14 0x7df74193783f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: operator new(unsigned long)--QPDF_Stream::pipeStreamData(Pipeline*, unsigned long, qpdf_stream_decode_level_e, bool, bool)--QPDFWriter::unparseObject(QPDFObjectHandle, int, unsigned int, unsigned long, bool)
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/qpdf/libqpdf/Pl_ASCII85Decoder.cc:85:32 in Pl_ASCII85Decoder::write(unsigned char*, unsigned long)
Shadow bytes around the buggy address:
  0x0c0c8000eeb0: fd fd fd fd fa fa fa fa fd fd fd fd fd fd fd fa
  0x0c0c8000eec0: fa fa fa fa fd fd fd fd fd fd fd fa fa fa fa fa
  0x0c0c8000eed0: 00 00 00 00 00 00 00 00 fa fa fa fa fd fd fd fd
  0x0c0c8000eee0: fd fd fd fd fa fa fa fa 00 00 00 00 00 00 00 fa
  0x0c0c8000eef0: fa fa fa fa fd fd fd fd fd fd fd fd fa fa fa fa
=>0x0c0c8000ef00: 00 00 00 00 00 00 00 00 fa[fa]fa fa fd fd fd fd
  0x0c0c8000ef10: fd fd fd fd fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c8000ef20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c8000ef30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c8000ef40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c8000ef50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==12==ABORTING
