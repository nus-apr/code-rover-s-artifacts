INFO: Seed: 2309838239
INFO: Loaded 1 modules   (159783 inline 8-bit counters): 159783 [0x25f1550, 0x2618577), 
INFO: Loaded 1 PC tables (159783 PCs): 159783 [0x2618578,0x28887e8), 
/out/ia_fuzz: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
3
=================================================================
==13==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000035351 at pc 0x000000b7bebe bp 0x7fff6feda950 sp 0x7fff6feda948
READ of size 1 at 0x602000035351 thread T0
SCARINESS: 12 (1-byte-read-heap-buffer-overflow)
    #0 0xb7bebd in check_buffer /src/radare2/libr/../libr/bin/p/bin_omf.c:37:18
    #1 0xaf863d in r_bin_get_binplugin_by_buffer /src/radare2/libr/bin/bin.c:457:8
    #2 0xaf012f in get_plugin_from_buffer /src/radare2/libr/bin/bfile.c:363:11
    #3 0xaf0229 in r_bin_file_new_from_buffer /src/radare2/libr/bin/bfile.c:421:24
    #4 0xaf7304 in r_bin_open_io /src/radare2/libr/bin/bin.c:396:8
    #5 0x671cb0 in cmd_open_bin /src/radare2/libr/core/./cmd_open.c:252:6
    #6 0x5ba2f8 in cmd_open /src/radare2/libr/core/./cmd_open.c:1342:3
    #7 0x69f8f8 in r_cmd_call /src/radare2/libr/core/cmd_api.c:244:10
    #8 0x5e6a33 in r_core_cmd_subst_i /src/radare2/libr/core/cmd.c:3240:12
    #9 0x58beca in r_core_cmd_subst /src/radare2/libr/core/cmd.c:2136:9
    #10 0x584ac2 in r_core_cmd /src/radare2/libr/core/cmd.c:4075:9
    #11 0x56ba13 in LLVMFuzzerTestOneInput /src/radare2/targets/ia_fuzz.cc:13:2
    #12 0x474ce1 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:556:15
    #13 0x45ffc1 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:286:6
    #14 0x46598a in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:767:9
    #15 0x48e572 in main /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerMain.cpp:19:10
    #16 0x7e28db93983f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #17 0x41f998 in _start (/out/ia_fuzz+0x41f998)

DEDUP_TOKEN: check_buffer--r_bin_get_binplugin_by_buffer--get_plugin_from_buffer
0x602000035351 is located 0 bytes to the right of 1-byte region [0x602000035350,0x602000035351)
allocated by thread T0 here:
    #0 0x53a4ad in malloc /src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:145:3
    #1 0x846876 in get_whole_buf /src/radare2/libr/util/buf.c:66:17
    #2 0x846535 in r_buf_data /src/radare2/libr/util/buf.c:192:17
    #3 0xb7bc9f in check_buffer /src/radare2/libr/../libr/bin/p/bin_omf.c:36:19
    #4 0xaf863d in r_bin_get_binplugin_by_buffer /src/radare2/libr/bin/bin.c:457:8
    #5 0xaf012f in get_plugin_from_buffer /src/radare2/libr/bin/bfile.c:363:11
    #6 0xaf0229 in r_bin_file_new_from_buffer /src/radare2/libr/bin/bfile.c:421:24
    #7 0xaf7304 in r_bin_open_io /src/radare2/libr/bin/bin.c:396:8
    #8 0x671cb0 in cmd_open_bin /src/radare2/libr/core/./cmd_open.c:252:6
    #9 0x5ba2f8 in cmd_open /src/radare2/libr/core/./cmd_open.c:1342:3
    #10 0x69f8f8 in r_cmd_call /src/radare2/libr/core/cmd_api.c:244:10
    #11 0x5e6a33 in r_core_cmd_subst_i /src/radare2/libr/core/cmd.c:3240:12
    #12 0x58beca in r_core_cmd_subst /src/radare2/libr/core/cmd.c:2136:9
    #13 0x584ac2 in r_core_cmd /src/radare2/libr/core/cmd.c:4075:9
    #14 0x56ba13 in LLVMFuzzerTestOneInput /src/radare2/targets/ia_fuzz.cc:13:2
    #15 0x474ce1 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:556:15
    #16 0x45ffc1 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:286:6
    #17 0x46598a in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:767:9
    #18 0x48e572 in main /src/llvm/projects/compiler-rt/lib/fuzzer/FuzzerMain.cpp:19:10
    #19 0x7e28db93983f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: malloc--get_whole_buf--r_buf_data
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/radare2/libr/../libr/bin/p/bin_omf.c:37:18 in check_buffer
Shadow bytes around the buggy address:
  0x0c047fffea10: fa fa 02 fa fa fa fd fa fa fa fd fa fa fa fd fa
  0x0c047fffea20: fa fa 05 fa fa fa fd fa fa fa 02 fa fa fa fd fd
  0x0c047fffea30: fa fa 00 01 fa fa 00 01 fa fa 07 fa fa fa 04 fa
  0x0c047fffea40: fa fa 00 fa fa fa fd fa fa fa fd fd fa fa fd fa
  0x0c047fffea50: fa fa 00 00 fa fa 06 fa fa fa 01 fa fa fa 02 fa
=>0x0c047fffea60: fa fa 00 00 fa fa 00 03 fa fa[01]fa fa fa fa fa
  0x0c047fffea70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fffea80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fffea90: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fffeaa0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fffeab0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==13==ABORTING
