INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2333134030
INFO: Loaded 1 modules   (552384 inline 8-bit counters): 552384 [0x48d46c0, 0x495b480), 
INFO: Loaded 1 PC tables (552384 PCs): 552384 [0x3dddca8,0x464b8a8), 
/out/llvmfuzz: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
forbidden 0 key
forbidden 0 key
forbidden 0 key
forbidden 0 key
forbidden 0 key
forbidden 0 key
forbidden 0 key
=================================================================
==12==ERROR: AddressSanitizer: attempting double-free on 0x604000032590 in thread T0:
SCARINESS: 42 (double-free)
    #0 0x523932 in __interceptor_free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3
    #1 0x1102a55 in dwg_free_XRECORD_private /src/libredwg/src/./dwg.spec:6709:3
    #2 0x1037910 in dwg_free_XRECORD /src/libredwg/src/./dwg.spec:6656:1
    #3 0x11057b5 in dwg_free_object /src/libredwg/src/free.c:1050:7
    #4 0x1107794 in dwg_free /src/libredwg/src/free.c:1502:13
    #5 0x55b1d7 in LLVMFuzzerTestOneInput /src/libredwg/examples/llvmfuzz.c:202:5
    #6 0x4552b3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #7 0x440f42 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #8 0x44678c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #9 0x46f382 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #10 0x7c5e7b101082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)
    #11 0x41f76d in _start (/out/llvmfuzz+0x41f76d)

DEDUP_TOKEN: __interceptor_free--dwg_free_XRECORD_private--dwg_free_XRECORD
0x604000032590 is located 0 bytes inside of 48-byte region [0x604000032590,0x6040000325c0)
freed by thread T0 here:
    #0 0x523932 in __interceptor_free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3
    #1 0x97c716 in dwg_decode_XRECORD_private /src/libredwg/src/./dwg.spec:6698:17
    #2 0x69297d in dwg_decode_XRECORD /src/libredwg/src/./dwg.spec:6656:1
    #3 0x681fea in dwg_decode_add_object /src/libredwg/src/decode.c:5098:15
    #4 0x5817e9 in decode_R13_R2000 /src/libredwg/src/decode.c:728:19
    #5 0x57579f in dwg_decode /src/libredwg/src/decode.c:210:36
    #6 0x55ab53 in LLVMFuzzerTestOneInput /src/libredwg/examples/llvmfuzz.c:91:13
    #7 0x4552b3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #8 0x440f42 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #9 0x44678c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #10 0x46f382 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #11 0x7c5e7b101082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)

DEDUP_TOKEN: __interceptor_free--dwg_decode_XRECORD_private--dwg_decode_XRECORD
previously allocated by thread T0 here:
    #0 0x523b9d in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:129:3
    #1 0x97c060 in dwg_decode_XRECORD_private /src/libredwg/src/./dwg.spec:6693:27
    #2 0x69297d in dwg_decode_XRECORD /src/libredwg/src/./dwg.spec:6656:1
    #3 0x681fea in dwg_decode_add_object /src/libredwg/src/decode.c:5098:15
    #4 0x5817e9 in decode_R13_R2000 /src/libredwg/src/decode.c:728:19
    #5 0x57579f in dwg_decode /src/libredwg/src/decode.c:210:36
    #6 0x55ab53 in LLVMFuzzerTestOneInput /src/libredwg/examples/llvmfuzz.c:91:13
    #7 0x4552b3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #8 0x440f42 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #9 0x44678c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #10 0x46f382 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #11 0x7c5e7b101082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)

DEDUP_TOKEN: malloc--dwg_decode_XRECORD_private--dwg_decode_XRECORD
SUMMARY: AddressSanitizer: double-free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3 in __interceptor_free
==12==ABORTING
