Accepting input from '/tmp/poc'
Usage for fuzzing: honggfuzz -P [flags] -- /out/flb-it-fuzz-parser_fuzzer_OSSFUZZ
[2024/10/25 05:39:25] [ info] Configuration:
[2024/10/25 05:39:25] [ info]  flush time     | 5.000000 seconds
[2024/10/25 05:39:25] [ info]  grace          | 5 seconds
[2024/10/25 05:39:25] [ info]  daemon         | 0
[2024/10/25 05:39:25] [ info] ___________
[2024/10/25 05:39:25] [ info]  inputs:
[2024/10/25 05:39:25] [ info] ___________
[2024/10/25 05:39:25] [ info]  filters:
[2024/10/25 05:39:25] [ info] ___________
[2024/10/25 05:39:25] [ info]  outputs:
[2024/10/25 05:39:25] [ info] ___________
[2024/10/25 05:39:25] [ info]  collectors:
=================================================================
==13==ERROR: AddressSanitizer: attempting double-free on 0x625000002900 in thread T0:
SCARINESS: 42 (double-free)
    #0 0x4bf872 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:127:3
    #1 0x513d5c in flb_free /src/fluent-bit/include/fluent-bit/flb_mem.h:122:5
    #2 0x513443 in flb_parser_json_do /src/fluent-bit/src/flb_parser_json.c:145:13
    #3 0x50d991 in flb_parser_do /src/fluent-bit/src/flb_parser.c:650:16
    #4 0x4fb951 in LLVMFuzzerTestOneInput /src/fluent-bit/tests/internal/fuzzers/parser_fuzzer.c:141:9
    #5 0x4f0deb in main (/out/flb-it-fuzz-parser_fuzzer_OSSFUZZ+0x4f0deb)
    #6 0x7effe5f9483f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #7 0x4450e8 in _start (/out/flb-it-fuzz-parser_fuzzer_OSSFUZZ+0x4450e8)

DEDUP_TOKEN: free--flb_free--flb_parser_json_do
0x625000002900 is located 0 bytes inside of 8192-byte region [0x625000002900,0x625000004900)
freed by thread T0 here:
    #0 0x4bf872 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:127:3
    #1 0x513d5c in flb_free /src/fluent-bit/include/fluent-bit/flb_mem.h:122:5
    #2 0x51341b in flb_parser_json_do /src/fluent-bit/src/flb_parser_json.c:144:13
    #3 0x50d991 in flb_parser_do /src/fluent-bit/src/flb_parser.c:650:16
    #4 0x4fb951 in LLVMFuzzerTestOneInput /src/fluent-bit/tests/internal/fuzzers/parser_fuzzer.c:141:9
    #5 0x4f0deb in main (/out/flb-it-fuzz-parser_fuzzer_OSSFUZZ+0x4f0deb)

DEDUP_TOKEN: free--flb_free--flb_parser_json_do
previously allocated by thread T0 here:
    #0 0x4bfdd3 in realloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:164:3
    #1 0x52a495 in msgpack_sbuffer_write /src/fluent-bit/lib/msgpack-c/include/msgpack/sbuffer.h:81:15
    #2 0x52aa41 in msgpack_pack_map /src/fluent-bit/lib/msgpack-c/include/msgpack/pack_template.h:745:9
    #3 0x527127 in tokens_to_msgpack /src/fluent-bit/src/flb_pack.c:178:13
    #4 0x526050 in pack_json_to_msgpack /src/fluent-bit/src/flb_pack.c:252:11
    #5 0x526254 in flb_pack_json_recs /src/fluent-bit/src/flb_pack.c:285:12
    #6 0x512c25 in flb_parser_json_do /src/fluent-bit/src/flb_parser_json.c:61:11
    #7 0x50d991 in flb_parser_do /src/fluent-bit/src/flb_parser.c:650:16
    #8 0x4fb951 in LLVMFuzzerTestOneInput /src/fluent-bit/tests/internal/fuzzers/parser_fuzzer.c:141:9
    #9 0x4f0deb in main (/out/flb-it-fuzz-parser_fuzzer_OSSFUZZ+0x4f0deb)

DEDUP_TOKEN: realloc--msgpack_sbuffer_write--msgpack_pack_map
SUMMARY: AddressSanitizer: double-free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:127:3 in free
==13==ABORTING
