INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2324286309
INFO: Loaded 1 modules   (160615 inline 8-bit counters): 160615 [0x4268c11, 0x428ff78), 
INFO: Loaded 1 PC tables (160615 PCs): 160615 [0x1f2cdf0,0x21a0460), 
/out/pdf_fuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
==13==WARNING: MemorySanitizer: use-of-uninitialized-value
    #0 0x73b503 in fmtuint32 /src/mupdf/source/fitz/printf.c:128:6
    #1 0x73b503 in fz_format_string /src/mupdf/source/fitz/printf.c:487:6
    #2 0x73dc4f in fz_vsnprintf /src/mupdf/source/fitz/printf.c:575:2
    #3 0x610df9 in fz_vthrow /src/mupdf/source/fitz/error.c:327:2
    #4 0x611600 in fz_throw /src/mupdf/source/fitz/error.c:338:2
    #5 0x681001 in fz_load_bmp_subimage_count /src/mupdf/source/fitz/load-bmp.c:1319:4
    #6 0x8eadfb in img_open_document_with_stream /src/mupdf/source/cbz/muimg.c:219:22
    #7 0x556a20 in fz_open_accelerated_document_with_stream /src/mupdf/source/fitz/document.c:222:9
    #8 0x556a20 in fz_open_document_with_stream /src/mupdf/source/fitz/document.c:228:9
    #9 0x535b2a in LLVMFuzzerTestOneInput /src/pdf_fuzzer.cc:143:11
    #10 0x43ee93 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #11 0x42a5f2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #12 0x42fe9c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #13 0x4593d2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #14 0x7b2f882b6082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #15 0x4207bd in _start (/out/pdf_fuzzer+0x4207bd)

DEDUP_TOKEN: fmtuint32--fz_format_string--fz_vsnprintf
  Uninitialized value was created by a heap allocation
    #0 0x4e34b0 in __interceptor_malloc /src/llvm-project/compiler-rt/lib/msan/msan_interceptors.cpp:895:3
    #1 0x5362a0 in fz_malloc_ossfuzz(void*, unsigned long) /src/pdf_fuzzer.cc:55:18
    #2 0x6e8ffe in do_scavenging_malloc /src/mupdf/source/fitz/memory.c:51:7
    #3 0x6e8925 in fz_malloc /src/mupdf/source/fitz/memory.c:89:6
    #4 0x8ff284 in fz_new_buffer /src/mupdf/source/fitz/buffer.c:39:13
    #5 0x7814e9 in fz_read_best /src/mupdf/source/fitz/stream-read.c:102:9
    #6 0x781005 in fz_read_all /src/mupdf/source/fitz/stream-read.c:77:9
    #7 0x8ea73f in img_open_document_with_stream /src/mupdf/source/cbz/muimg.c:192:17
    #8 0x556a20 in fz_open_accelerated_document_with_stream /src/mupdf/source/fitz/document.c:222:9
    #9 0x556a20 in fz_open_document_with_stream /src/mupdf/source/fitz/document.c:228:9
    #10 0x535b2a in LLVMFuzzerTestOneInput /src/pdf_fuzzer.cc:143:11
    #11 0x43ee93 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #12 0x42a5f2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #13 0x42fe9c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #14 0x4593d2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #15 0x7b2f882b6082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)

DEDUP_TOKEN: __interceptor_malloc--fz_malloc_ossfuzz(void*, unsigned long)--do_scavenging_malloc
SUMMARY: MemorySanitizer: use-of-uninitialized-value /src/mupdf/source/fitz/printf.c:128:6 in fmtuint32
Unique heap origins: 83
Stack depot allocated bytes: 9764880
Unique origin histories: 5
History depot allocated bytes: 196608
Exiting
