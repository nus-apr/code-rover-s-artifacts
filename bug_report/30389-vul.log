INFO: Seed: 2254516971
INFO: Loaded 1 modules   (13096 inline 8-bit counters): 13096 [0xaba520, 0xabd848), 
INFO: Loaded 1 PC tables (13096 PCs): 13096 [0xabd848,0xaf0ac8), 
/out/fuzz_process_packet: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61a000000b57 at pc 0x00000050cf9d bp 0x7ffd223716f0 sp 0x7ffd22370ea8
READ of size 885 at 0x61a000000b57 thread T0
SCARINESS: 26 (multi-byte-read-heap-buffer-overflow)
    #0 0x50cf9c in strncpy /src/llvm-project/compiler-rt/lib/asan/asan_interceptors.cpp:482:5
    #1 0x5bbb40 in http_process_user_agent /src/ndpi/src/lib/protocols/http.c:350:7
    #2 0x58620b in process_chlo /src/ndpi/src/lib/protocols/quic.c:1132:7
    #3 0x584bd2 in ndpi_search_quic /src/ndpi/src/lib/protocols/quic.c:1288:5
    #4 0x56471a in check_ndpi_udp_flow_func /src/ndpi/src/lib/ndpi_main.c:3933:2
    #5 0x56647f in ndpi_check_flow_func /src/ndpi/src/lib/ndpi_main.c:4026:5
    #6 0x56c1a0 in ndpi_detection_process_packet /src/ndpi/src/lib/ndpi_main.c:4724:3
    #7 0x5536ea in LLVMFuzzerTestOneInput /src/ndpi/fuzz/fuzz_process_packet.c:24:3
    #8 0x458221 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:595:15
    #9 0x4432f2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6
    #10 0x4493ae in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:852:9
    #11 0x471392 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #12 0x712704bd083f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #13 0x41e5c8 in _start (/out/fuzz_process_packet+0x41e5c8)

DEDUP_TOKEN: strncpy--http_process_user_agent--process_chlo
0x61a000000b57 is located 0 bytes to the right of 1239-byte region [0x61a000000680,0x61a000000b57)
allocated by thread T0 here:
    #0 0x520fbd in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3
    #1 0x431e77 in operator new(unsigned long) (/out/fuzz_process_packet+0x431e77)
    #2 0x4432f2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6
    #3 0x4493ae in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:852:9
    #4 0x471392 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #5 0x712704bd083f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: malloc--operator new(unsigned long)--fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long)
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/llvm-project/compiler-rt/lib/asan/asan_interceptors.cpp:482:5 in strncpy
Shadow bytes around the buggy address:
  0x0c347fff8110: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c347fff8120: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c347fff8130: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c347fff8140: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c347fff8150: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0c347fff8160: 00 00 00 00 00 00 00 00 00 00[07]fa fa fa fa fa
  0x0c347fff8170: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c347fff8180: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c347fff8190: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c347fff81a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c347fff81b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==13==ABORTING
