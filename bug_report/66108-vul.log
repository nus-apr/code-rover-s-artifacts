INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2232849900
INFO: Loaded 1 modules   (236924 inline 8-bit counters): 236924 [0x1f52a80, 0x1f8c7fc), 
INFO: Loaded 1 PC tables (236924 PCs): 236924 [0x1f8c800,0x2329fc0), 
/out/fuzz_probe_analyze: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
[33m[MP3Dmx] invalid frame, resyncing
[0m[33m[MP3Dmx] invalid frame, resyncing
[0m[33m[MP3Dmx] invalid frame, resyncing
[0m=================================================================
==13==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62200000ec88 at pc 0x00000098ae1e bp 0x7ffd096263f0 sp 0x7ffd096263e8
READ of size 1 at 0x62200000ec88 thread T0
SCARINESS: 12 (1-byte-read-heap-buffer-overflow)
    #0 0x98ae1d in mp3_dmx_process /src/gpac/src/filters/reframe_mp3.c:645:54
    #1 0x5a6f13 in gf_filter_process_task /src/gpac/src/filter_core/filter.c:2971:7
    #2 0x57ea01 in gf_fs_thread_proc /src/gpac/src/filter_core/filter_session.c:2105:3
    #3 0x57c2e4 in gf_fs_run /src/gpac/src/filter_core/filter_session.c:2405:3
    #4 0x56ee2f in LLVMFuzzerTestOneInput /src/testsuite/oss-fuzzers/fuzz_probe_analyze.c:21:5
    #5 0x4406d3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #6 0x42be32 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #7 0x4316dc in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #8 0x45ac12 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #9 0x72d49ac7f082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #10 0x421ffd in _start (/out/fuzz_probe_analyze+0x421ffd)

DEDUP_TOKEN: mp3_dmx_process--gf_filter_process_task--gf_fs_thread_proc
0x62200000ec88 is located 0 bytes to the right of 5000-byte region [0x62200000d900,0x62200000ec88)
allocated by thread T0 here:
    #0 0x531c6c in __interceptor_realloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:85:3
    #1 0xd7278f in gf_realloc /src/gpac/src/utils/alloc.c:160:9
    #2 0x988042 in mp3_dmx_process /src/gpac/src/filters/reframe_mp3.c:560:22
    #3 0x5a6f13 in gf_filter_process_task /src/gpac/src/filter_core/filter.c:2971:7
    #4 0x57ea01 in gf_fs_thread_proc /src/gpac/src/filter_core/filter_session.c:2105:3
    #5 0x57c2e4 in gf_fs_run /src/gpac/src/filter_core/filter_session.c:2405:3
    #6 0x56ee2f in LLVMFuzzerTestOneInput /src/testsuite/oss-fuzzers/fuzz_probe_analyze.c:21:5
    #7 0x4406d3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #8 0x42be32 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #9 0x4316dc in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #10 0x45ac12 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #11 0x72d49ac7f082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)

DEDUP_TOKEN: __interceptor_realloc--gf_realloc--mp3_dmx_process
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/gpac/src/filters/reframe_mp3.c:645:54 in mp3_dmx_process
Shadow bytes around the buggy address:
  0x0c447fff9d40: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c447fff9d50: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c447fff9d60: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c447fff9d70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c447fff9d80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0c447fff9d90: 00[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c447fff9da0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c447fff9db0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c447fff9dc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c447fff9dd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c447fff9de0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==13==ABORTING
