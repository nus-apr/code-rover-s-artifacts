INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2218783905
INFO: Loaded 1 modules   (41905 inline 8-bit counters): 41905 [0xbafe00, 0xbba1b1), 
INFO: Loaded 1 PC tables (41905 PCs): 41905 [0x75b118,0x7fec28), 
/out/cli-received-fuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
UndefinedBehaviorSanitizer:DEADLYSIGNAL
==13==ERROR: UndefinedBehaviorSanitizer: SEGV on unknown address 0x00007f54ab0f (pc 0x0000004f2b53 bp 0x7ffcc02aa260 sp 0x7ffcc02aa240 T13)
==13==The signal is caused by a READ memory access.
    #0 0x4f2b53 in ot::StringLength(char const*, unsigned short) /src/openthread/build/../src/core/common/string.cpp:44:42
    #1 0x522ff9 in ot::Dns::Name::AppendLabel(char const*, ot::Message&) /src/openthread/build/../src/core/net/dns_types.cpp:151:53
    #2 0x520f92 in ot::Dns::Client::AllocateQuery(ot::Dns::Client::QueryInfo const&, char const*, char const*, ot::Message*&) /src/openthread/build/../src/core/net/dns_client.cpp:700:9
    #3 0x520d1f in ot::Dns::Client::StartQuery(ot::Dns::Client::QueryInfo&, ot::Dns::Client::QueryConfig const*, char const*, char const*, void*) /src/openthread/build/../src/core/net/dns_client.cpp:680:5
    #4 0x520e91 in ot::Dns::Client::ResolveService(char const*, char const*, void (*)(otError, otDnsServiceResponse const*, void*), void*, ot::Dns::Client::QueryConfig const*) /src/openthread/build/../src/core/net/dns_client.cpp:641:13
    #5 0x4d79da in otDnsClientResolveService /src/openthread/build/../src/core/api/dns_api.cpp:186:40
    #6 0x4b7dbd in ot::Cli::Interpreter::ProcessDns(unsigned char, ot::Utils::CmdLineParser::Arg*) /src/openthread/build/../src/cli/cli.cpp:1485:9
    #7 0x4c1991 in ot::Cli::Interpreter::ProcessLine(char*) /src/openthread/build/../src/cli/cli.cpp:4895:22
    #8 0x4c2a58 in otCliInputLine /src/openthread/build/../src/cli/cli.cpp:5259:35
    #9 0x4b4619 in LLVMFuzzerTestOneInput /src/openthread/build/../tests/fuzz/cli_received.cpp:79:5
    #10 0x442713 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15
    #11 0x42c522 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6
    #12 0x43236a in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:856:9
    #13 0x45e052 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #14 0x78cb7635283f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #15 0x407208 in _start (/out/cli-received-fuzzer+0x407208)

DEDUP_TOKEN: ot::StringLength(char const*, unsigned short)--ot::Dns::Name::AppendLabel(char const*, ot::Message&)--ot::Dns::Client::AllocateQuery(ot::Dns::Client::QueryInfo const&, char const*, char const*, ot::Message*&)
UndefinedBehaviorSanitizer can not provide additional info.
SUMMARY: UndefinedBehaviorSanitizer: SEGV /src/openthread/build/../src/core/common/string.cpp:44:42 in ot::StringLength(char const*, unsigned short)
==13==ABORTING
