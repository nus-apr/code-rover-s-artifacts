INFO: Seed: 2327620103
INFO: Loaded 1 modules   (164888 inline 8-bit counters): 164888 [0x32be6a0, 0x32e6ab8), 
INFO: Loaded 1 PC tables (164888 PCs): 164888 [0x2792e80,0x2a17000), 
/out/spectre_read_fuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62a000227050 at pc 0x000000f4c010 bp 0x7ffe86e02200 sp 0x7ffe86e021f8
READ of size 4 at 0x62a000227050 thread T0
SCARINESS: 17 (4-byte-read-heap-buffer-overflow)
    #0 0xf4c00f in gc_mark_string /src/libspectre/ghostscript-9.50/./psi/igcstr.c:80:27
    #1 0xf470d0 in gc_trace /src/libspectre/ghostscript-9.50/./psi/igc.c:895:25
    #2 0xf4439f in gs_gc_reclaim /src/libspectre/ghostscript-9.50/./psi/igc.c:338:21
    #3 0xe8bf17 in gs_vmreclaim /src/libspectre/ghostscript-9.50/./psi/ireclaim.c:163:9
    #4 0xe8b690 in ireclaim /src/libspectre/ghostscript-9.50/./psi/ireclaim.c:80:12
    #5 0xe79523 in interp_reclaim /src/libspectre/ghostscript-9.50/./psi/interp.c:450:12
    #6 0xe80606 in interp /src/libspectre/ghostscript-9.50/./psi/interp.c:1817:16
    #7 0xe79ea1 in gs_call_interp /src/libspectre/ghostscript-9.50/./psi/interp.c:520:12
    #8 0xe797da in gs_interpret /src/libspectre/ghostscript-9.50/./psi/interp.c:477:12
    #9 0x575fe3 in gs_main_run_string_continue /src/libspectre/ghostscript-9.50/./psi/imain.c:772:12
    #10 0x56edbb in spectre_gs_process /src/libspectre/libspectre/spectre-gs.c:132:11
    #11 0x56f88d in spectre_gs_send_page /src/libspectre/libspectre/spectre-gs.c:251:7
    #12 0x5707a9 in spectre_device_render /src/libspectre/libspectre/spectre-device.c:389:7
    #13 0x55935e in spectre_page_render /src/libspectre/libspectre/spectre-page.c:164:17
    #14 0x556d24 in spectre_document_render_full /src/libspectre/libspectre/spectre-document.c:351:2
    #15 0x555bf0 in spectre_document_render /src/libspectre/libspectre/spectre-document.c:367:2
    #16 0x55596d in spectre_document_load /src/libspectre/libspectre/spectre-document.c:87:3
    #17 0x555303 in LLVMFuzzerTestOneInput /src/libspectre/test/spectre_read_fuzzer.c:34:5
    #18 0x45aef1 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:556:15
    #19 0x445a11 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:292:6
    #20 0x44b6ce in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:774:9
    #21 0x4755f2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:19:10
    #22 0x736435a0783f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #23 0x41ee88 in _start (/out/spectre_read_fuzzer+0x41ee88)

DEDUP_TOKEN: gc_mark_string--gc_trace--gs_gc_reclaim
0x62a000227050 is located 0 bytes to the right of 20048-byte region [0x62a000222200,0x62a000227050)
allocated by thread T0 here:
    #0 0x522a8d in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3
    #1 0xb1b63a in gs_heap_alloc_bytes /src/libspectre/ghostscript-9.50/./base/gsmalloc.c:193:34
    #2 0x132dba7 in alloc_acquire_clump /src/libspectre/ghostscript-9.50/./base/gsalloc.c:2485:13
    #3 0x132a450 in alloc_add_clump /src/libspectre/ghostscript-9.50/./base/gsalloc.c:2435:19
    #4 0x132d01d in alloc_obj /src/libspectre/ghostscript-9.50/./base/gsalloc.c:2043:17
    #5 0x1327446 in i_alloc_struct /src/libspectre/ghostscript-9.50/./base/gsalloc.c:1231:15
    #6 0xf4ed9f in name_alloc_sub /src/libspectre/ghostscript-9.50/./psi/iname.c:496:11
    #7 0xf4fcc7 in names_ref /src/libspectre/ghostscript-9.50/./psi/iname.c:211:20
    #8 0xe9141b in gs_scan_token /src/libspectre/ghostscript-9.50/./psi/iscan.c
    #9 0xe7e303 in interp /src/libspectre/ghostscript-9.50/./psi/interp.c:1451:24
    #10 0xe79ea1 in gs_call_interp /src/libspectre/ghostscript-9.50/./psi/interp.c:520:12
    #11 0xe797da in gs_interpret /src/libspectre/ghostscript-9.50/./psi/interp.c:477:12
    #12 0x57376a in gs_run_init_file /src/libspectre/ghostscript-9.50/./psi/imain.c:707:12
    #13 0x573209 in gs_main_init2aux /src/libspectre/ghostscript-9.50/./psi/imain.c:301:16
    #14 0x573a44 in gs_main_init2 /src/libspectre/ghostscript-9.50/./psi/imain.c:338:12
    #15 0xfda779 in gs_main_init_with_args2 /src/libspectre/ghostscript-9.50/./psi/imainarg.c:276:12
    #16 0x56f355 in spectre_gs_run /src/libspectre/libspectre/spectre-gs.c:200:10
    #17 0x5706d5 in spectre_device_render /src/libspectre/libspectre/spectre-device.c:363:12
    #18 0x55935e in spectre_page_render /src/libspectre/libspectre/spectre-page.c:164:17
    #19 0x556d24 in spectre_document_render_full /src/libspectre/libspectre/spectre-document.c:351:2
    #20 0x555bf0 in spectre_document_render /src/libspectre/libspectre/spectre-document.c:367:2
    #21 0x55596d in spectre_document_load /src/libspectre/libspectre/spectre-document.c:87:3
    #22 0x555303 in LLVMFuzzerTestOneInput /src/libspectre/test/spectre_read_fuzzer.c:34:5
    #23 0x45aef1 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:556:15
    #24 0x445a11 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:292:6
    #25 0x44b6ce in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:774:9
    #26 0x4755f2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:19:10
    #27 0x736435a0783f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: malloc--gs_heap_alloc_bytes--alloc_acquire_clump
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/libspectre/ghostscript-9.50/./psi/igcstr.c:80:27 in gc_mark_string
Shadow bytes around the buggy address:
  0x0c548003cdb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c548003cdc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c548003cdd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c548003cde0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c548003cdf0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0c548003ce00: 00 00 00 00 00 00 00 00 00 00[fa]fa fa fa fa fa
  0x0c548003ce10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c548003ce20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c548003ce30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c548003ce40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c548003ce50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==13==ABORTING
