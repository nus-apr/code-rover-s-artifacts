Accepting input from '/tmp/poc'
Usage for fuzzing: honggfuzz -P [flags] -- /out/mruby_proto_fuzzer
==13==WARNING: AddressSanitizer failed to allocate 0x8000000011fffff0 bytes
==13==WARNING: AddressSanitizer failed to allocate 0x8000000011fffff0 bytes
=================================================================
==13==ERROR: AddressSanitizer: attempting double-free on 0x60300001afb0 in thread T0:
SCARINESS: 42 (double-free)
    #0 0x49794d in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:123:3
    #1 0x618cde in mrb_default_allocf /src/mruby/src/state.c:64:5
    #2 0x61e2c0 in mrb_free /src/mruby/src/gc.c:274:3
    #3 0x62108d in obj_free /src/mruby/src/gc.c
    #4 0x61ee2b in free_heap /src/mruby/src/gc.c:419:9
    #5 0x61ed31 in mrb_gc_destroy /src/mruby/src/gc.c:428:3
    #6 0x618ec9 in mrb_close /src/mruby/src/state.c:195:3
    #7 0x4ca206 in FuzzRB(unsigned char const*, unsigned long) /src/mruby/oss-fuzz/mruby_proto_fuzzer.cpp:34:2
    #8 0x4cac57 in TestOneProtoInput(ruby_fuzzer::Function const&) /src/mruby/oss-fuzz/mruby_proto_fuzzer.cpp:43:8
    #9 0x4ca9fb in LLVMFuzzerTestOneInput /src/mruby/oss-fuzz/mruby_proto_fuzzer.cpp:40:1
    #10 0x73fe2b in main (/out/mruby_proto_fuzzer+0x73fe2b)
    #11 0x76a1584f883f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #12 0x41f8c8 in _start (/out/mruby_proto_fuzzer+0x41f8c8)

DEDUP_TOKEN: free--mrb_default_allocf--mrb_free
0x60300001afb0 is located 0 bytes inside of 32-byte region [0x60300001afb0,0x60300001afd0)
freed by thread T0 here:
    #0 0x49794d in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:123:3
    #1 0x618cde in mrb_default_allocf /src/mruby/src/state.c:64:5
    #2 0x61e2c0 in mrb_free /src/mruby/src/gc.c:274:3
    #3 0x61e218 in mrb_realloc /src/mruby/src/gc.c:228:5
    #4 0x6aefbf in ary_expand_capa /src/mruby/src/array.c:224:44
    #5 0x6b1f5b in mrb_ary_splice /src/mruby/src/array.c:749:7
    #6 0x6b5968 in mrb_ary_aset /src/mruby/src/array.c:966:3
    #7 0x639cc2 in mrb_vm_exec /src/mruby/src/vm.c:1437:18
    #8 0x62bc75 in mrb_vm_run /src/mruby/src/vm.c:935:12
    #9 0x650188 in mrb_top_run /src/mruby/src/vm.c
    #10 0x67a63f in mrb_load_exec /src/mruby/mrbgems/mruby-compiler/core/parse.y:6512:7
    #11 0x67aa8f in mrb_load_nstring_cxt /src/mruby/mrbgems/mruby-compiler/core/parse.y:6534:10
    #12 0x67ab15 in mrb_load_string_cxt /src/mruby/mrbgems/mruby-compiler/core/parse.y:6546:10
    #13 0x67ab53 in mrb_load_string /src/mruby/mrbgems/mruby-compiler/core/parse.y:6552:10
    #14 0x4ca1fe in FuzzRB(unsigned char const*, unsigned long) /src/mruby/oss-fuzz/mruby_proto_fuzzer.cpp:33:6
    #15 0x4cac57 in TestOneProtoInput(ruby_fuzzer::Function const&) /src/mruby/oss-fuzz/mruby_proto_fuzzer.cpp:43:8
    #16 0x4ca9fb in LLVMFuzzerTestOneInput /src/mruby/oss-fuzz/mruby_proto_fuzzer.cpp:40:1
    #17 0x73fe2b in main (/out/mruby_proto_fuzzer+0x73fe2b)

DEDUP_TOKEN: free--mrb_default_allocf--mrb_free
previously allocated by thread T0 here:
    #0 0x497ee9 in realloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:164:3
    #1 0x618cca in mrb_default_allocf /src/mruby/src/state.c:68:12
    #2 0x61dd7b in mrb_realloc_simple /src/mruby/src/gc.c:211:8
    #3 0x61e19b in mrb_realloc /src/mruby/src/gc.c:225:8
    #4 0x61e303 in mrb_malloc /src/mruby/src/gc.c:242:10
    #5 0x6adf05 in ary_new_capa /src/mruby/src/array.c:37:35
    #6 0x6ae0b3 in ary_new_from_values /src/mruby/src/array.c:85:22
    #7 0x6ae06a in mrb_ary_new_from_values /src/mruby/src/array.c:96:22
    #8 0x632fb7 in mrb_vm_exec /src/mruby/src/vm.c:2425:21
    #9 0x62bc75 in mrb_vm_run /src/mruby/src/vm.c:935:12
    #10 0x650188 in mrb_top_run /src/mruby/src/vm.c
    #11 0x67a63f in mrb_load_exec /src/mruby/mrbgems/mruby-compiler/core/parse.y:6512:7
    #12 0x67aa8f in mrb_load_nstring_cxt /src/mruby/mrbgems/mruby-compiler/core/parse.y:6534:10
    #13 0x67ab15 in mrb_load_string_cxt /src/mruby/mrbgems/mruby-compiler/core/parse.y:6546:10
    #14 0x67ab53 in mrb_load_string /src/mruby/mrbgems/mruby-compiler/core/parse.y:6552:10
    #15 0x4ca1fe in FuzzRB(unsigned char const*, unsigned long) /src/mruby/oss-fuzz/mruby_proto_fuzzer.cpp:33:6
    #16 0x4cac57 in TestOneProtoInput(ruby_fuzzer::Function const&) /src/mruby/oss-fuzz/mruby_proto_fuzzer.cpp:43:8
    #17 0x4ca9fb in LLVMFuzzerTestOneInput /src/mruby/oss-fuzz/mruby_proto_fuzzer.cpp:40:1
    #18 0x73fe2b in main (/out/mruby_proto_fuzzer+0x73fe2b)

DEDUP_TOKEN: realloc--mrb_default_allocf--mrb_realloc_simple
SUMMARY: AddressSanitizer: double-free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:123:3 in free
==13==ABORTING
