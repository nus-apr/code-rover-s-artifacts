INFO: Seed: 2257021621
INFO: Loaded 1 modules   (13009 inline 8-bit counters): 13009 [0xa27830, 0xa2ab01), 
INFO: Loaded 1 PC tables (13009 PCs): 13009 [0xa2ab08,0xa5d818), 
/out/hb-subset-fuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x606000000180 at pc 0x00000062c544 bp 0x7ffd8f60b370 sp 0x7ffd8f60b368
READ of size 8 at 0x606000000180 thread T0
SCARINESS: 23 (8-byte-read-heap-buffer-overflow)
    #0 0x62c543 in OT::Coverage::intersects(hb_set_t const*) const /src/harfbuzz/src/./hb-ot-layout-common.hh:952:42
    #1 0x62c072 in OT::ContextFormat2::closure(OT::hb_closure_context_t*) const /src/harfbuzz/src/./hb-ot-layout-gsubgpos.hh:1411:26
    #2 0x62b3a9 in _hb_void_t const* OT::hb_closure_context_t::dispatch<OT::ContextFormat2>(OT::ContextFormat2 const&) /src/harfbuzz/src/./hb-ot-layout-gsubgpos.hh:49:49
    #3 0x6295d3 in OT::hb_closure_context_t::return_t OT::Context::dispatch<OT::hb_closure_context_t>(OT::hb_closure_context_t*) const /src/harfbuzz/src/./hb-ot-layout-gsubgpos.hh:1605:13
    #4 0x628cf1 in OT::hb_closure_context_t::return_t OT::SubstLookupSubTable::dispatch<OT::hb_closure_context_t>(OT::hb_closure_context_t*, unsigned int) const /src/harfbuzz/src/./hb-ot-layout-gsub-table.hh:1102:20
    #5 0x628a90 in OT::hb_closure_context_t::return_t OT::Lookup::dispatch<OT::SubstLookupSubTable, OT::hb_closure_context_t>(OT::hb_closure_context_t*) const /src/harfbuzz/src/./hb-ot-layout-common.hh:643:71
    #6 0x60c6c7 in OT::SubstLookup::closure(OT::hb_closure_context_t*, unsigned int) const /src/harfbuzz/src/./hb-ot-layout-gsub-table.hh:1157:42
    #7 0x6010a8 in hb_ot_layout_lookups_substitute_closure /src/harfbuzz/src/hb-ot-layout.cc:972:40
    #8 0x5deb16 in _gsub_closure(hb_face_t*, hb_set_t*) /src/harfbuzz/src/hb-subset-plan.cc:66:3
    #9 0x5de4d9 in _populate_gids_to_retain(hb_face_t*, hb_set_t const*, bool, hb_set_t*, hb_map_t*, hb_vector_t<unsigned int, 8u>*) /src/harfbuzz/src/hb-subset-plan.cc:104:5
    #10 0x5de041 in hb_subset_plan_create(hb_face_t*, hb_subset_profile_t*, hb_subset_input_t*) /src/harfbuzz/src/hb-subset-plan.cc:161:3
    #11 0x5bec4b in hb_subset /src/harfbuzz/src/hb-subset.cc:213:28
    #12 0x530365 in trySubset(hb_face_t*, unsigned int const*, int, bool, bool) /src/harfbuzz/./test/fuzzing/hb-subset-fuzzer.cc:27:23
    #13 0x530455 in trySubset(hb_face_t*, unsigned int const*, int) /src/harfbuzz/./test/fuzzing/hb-subset-fuzzer.cc:42:7
    #14 0x5305e7 in LLVMFuzzerTestOneInput /src/harfbuzz/./test/fuzzing/hb-subset-fuzzer.cc:60:3
    #15 0x568f42 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:575:15
    #16 0x54129a in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:280:6
    #17 0x54c965 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:715:9
    #18 0x53083c in main /src/libfuzzer/FuzzerMain.cpp:20:10
    #19 0x794c68c9c83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #20 0x41d048 in _start (/out/hb-subset-fuzzer+0x41d048)

DEDUP_TOKEN: OT::Coverage::intersects(hb_set_t const*) const--OT::ContextFormat2::closure(OT::hb_closure_context_t*) const--_hb_void_t const* OT::hb_closure_context_t::dispatch<OT::ContextFormat2>(OT::ContextFormat2 const&)
0x606000000180 is located 0 bytes to the right of 64-byte region [0x606000000140,0x606000000180)
allocated by thread T0 here:
    #0 0x52bf68 in operator new[](unsigned long) /src/llvm/projects/compiler-rt/lib/asan/asan_new_delete.cc:109
    #1 0x568cf4 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:562:23
    #2 0x54129a in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:280:6
    #3 0x54c965 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:715:9
    #4 0x53083c in main /src/libfuzzer/FuzzerMain.cpp:20:10
    #5 0x794c68c9c83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: operator new[](unsigned long)--fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long)--fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long)
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/harfbuzz/src/./hb-ot-layout-common.hh:952:42 in OT::Coverage::intersects(hb_set_t const*) const
Shadow bytes around the buggy address:
  0x0c0c7fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c0c7fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c0c7fff8000: fa fa fa fa fd fd fd fd fd fd fd fa fa fa fa fa
  0x0c0c7fff8010: 00 00 00 00 00 00 00 fa fa fa fa fa 00 00 00 00
  0x0c0c7fff8020: 00 00 00 00 fa fa fa fa 00 00 00 00 00 00 00 00
=>0x0c0c7fff8030:[fa]fa fa fa 00 00 00 00 00 00 00 fa fa fa fa fa
  0x0c0c7fff8040: 00 00 00 00 00 00 00 fa fa fa fa fa fa fa fa fa
  0x0c0c7fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff8060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff8070: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff8080: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==13==ABORTING
