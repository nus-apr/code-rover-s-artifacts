======================= INFO =========================
This binary is built for AFL-fuzz.
To run the target function on individual input(s) execute this:
  /out/hts_open_fuzzer < INPUT_FILE
or
  /out/hts_open_fuzzer INPUT_FILE1 [INPUT_FILE2 ... ]
To fuzz with afl-fuzz execute this:
  afl-fuzz [afl-flags] /out/hts_open_fuzzer [-N]
afl-fuzz will run N iterations before re-spawning the process (default: 1000)
======================================================
Reading 91 bytes from /tmp/poc
[W::cram_decode_compression_header] Codec for key IN defined more than once
[W::cram_decode_compression_header] Codec for key IN defined more than once
=================================================================
==13==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61d000001cf8 at pc 0x00000067641f bp 0x7ffd11143650 sp 0x7ffd11143648
WRITE of size 4 at 0x61d000001cf8 thread T0
SCARINESS: 36 (4-byte-write-heap-buffer-overflow)
    #0 0x67641e in cram_xpack_decode_init /src/htslib/cram/cram_codecs.c:1415:28
    #1 0x6764d3 in cram_decoder_init /src/htslib/cram/cram_codecs.c:3730:25
    #2 0x58a197 in cram_decode_compression_header /src/htslib/cram/cram_decode.c:466:34
    #3 0x5a522a in cram_first_slice /src/htslib/cram/cram_decode.c:3124:19
    #4 0x5a09d3 in cram_next_slice /src/htslib/cram/cram_decode.c:3143:24
    #5 0x5a0510 in cram_get_seq /src/htslib/cram/cram_decode.c:3415:23
    #6 0x5a2121 in cram_get_bam_seq /src/htslib/cram/cram_decode.c:3477:16
    #7 0x53505a in sam_read1_cram /src/htslib/sam.c:3506:15
    #8 0x534d05 in sam_read1 /src/htslib/sam.c:3624:19
    #9 0x4cec1d in view_sam /src/htslib/test/fuzz/hts_open_fuzzer.c:74:12
    #10 0x4ceb07 in LLVMFuzzerTestOneInput /src/htslib/test/fuzz/hts_open_fuzzer.c:142:13
    #11 0x4cf26e in ExecuteFilesOnyByOne /src/libfuzzer/afl/afl_driver.cpp:207:5
    #12 0x4cf26e in main /src/libfuzzer/afl/afl_driver.cpp:244:12
    #13 0x74bdb647983f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #14 0x41fe78 in _start (/out/hts_open_fuzzer+0x41fe78)

DEDUP_TOKEN: cram_xpack_decode_init--cram_decoder_init--cram_decode_compression_header
0x61d000001cf8 is located 0 bytes to the right of 2168-byte region [0x61d000001480,0x61d000001cf8)
allocated by thread T0 here:
    #0 0x49ad5d in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3
    #1 0x675e9e in cram_xpack_decode_init /src/htslib/cram/cram_codecs.c:1391:15
    #2 0x6764d3 in cram_decoder_init /src/htslib/cram/cram_codecs.c:3730:25
    #3 0x58a197 in cram_decode_compression_header /src/htslib/cram/cram_decode.c:466:34
    #4 0x5a522a in cram_first_slice /src/htslib/cram/cram_decode.c:3124:19
    #5 0x5a09d3 in cram_next_slice /src/htslib/cram/cram_decode.c:3143:24
    #6 0x5a0510 in cram_get_seq /src/htslib/cram/cram_decode.c:3415:23
    #7 0x5a2121 in cram_get_bam_seq /src/htslib/cram/cram_decode.c:3477:16
    #8 0x53505a in sam_read1_cram /src/htslib/sam.c:3506:15
    #9 0x534d05 in sam_read1 /src/htslib/sam.c:3624:19
    #10 0x4cec1d in view_sam /src/htslib/test/fuzz/hts_open_fuzzer.c:74:12
    #11 0x4ceb07 in LLVMFuzzerTestOneInput /src/htslib/test/fuzz/hts_open_fuzzer.c:142:13
    #12 0x4cf26e in ExecuteFilesOnyByOne /src/libfuzzer/afl/afl_driver.cpp:207:5
    #13 0x4cf26e in main /src/libfuzzer/afl/afl_driver.cpp:244:12
    #14 0x74bdb647983f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: malloc--cram_xpack_decode_init--cram_decoder_init
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/htslib/cram/cram_codecs.c:1415:28 in cram_xpack_decode_init
Shadow bytes around the buggy address:
  0x0c3a7fff8340: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c3a7fff8350: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c3a7fff8360: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c3a7fff8370: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c3a7fff8380: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0c3a7fff8390: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00[fa]
  0x0c3a7fff83a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c3a7fff83b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c3a7fff83c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c3a7fff83d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c3a7fff83e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==13==ABORTING
