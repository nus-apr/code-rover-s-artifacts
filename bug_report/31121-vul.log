Warning: AFL++ tools will need to set AFL_MAP_SIZE to 383296 to be able to run this instrumented program!
Running LLVMFuzzerInitialize ...
oss-fuzzshark: disabling: udp
oss-fuzzshark: disabling: udplite
oss-fuzzshark: disabling: ospf
oss-fuzzshark: disabling: bgp
oss-fuzzshark: disabling: dhcp
oss-fuzzshark: disabling: json
oss-fuzzshark: disabling: snort
oss-fuzzshark: configured for dissector: ip
continue...
=================================================================
==13==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6020000d9bd0 at pc 0x00000405493f bp 0x7fff627dc3d0 sp 0x7fff627dc3c8
READ of size 1 at 0x6020000d9bd0 thread T0
SCARINESS: 22 (1-byte-read-heap-buffer-overflow-far-from-bounds)
    #0 0x405493e in dissect_vjc_uncomp /src/wireshark/epan/dissectors/packet-vj-comp.c:305:25
    #1 0x83674b in call_dissector_through_handle /src/wireshark/epan/packet.c:720:9
    #2 0x81f995 in call_dissector_work /src/wireshark/epan/packet.c:813:9
    #3 0x81f2a6 in dissector_try_uint_new /src/wireshark/epan/packet.c:1413:8
    #4 0x8209a8 in dissector_try_uint /src/wireshark/epan/packet.c:1437:9
    #5 0x338c7aa in dissect_ppp_common /src/wireshark/epan/dissectors/packet-ppp.c:4786:10
    #6 0x336a39d in dissect_ppp_raw_hdlc /src/wireshark/epan/dissectors/packet-ppp.c:6002:17
    #7 0x83674b in call_dissector_through_handle /src/wireshark/epan/packet.c:720:9
    #8 0x81f995 in call_dissector_work /src/wireshark/epan/packet.c:813:9
    #9 0x81f2a6 in dissector_try_uint_new /src/wireshark/epan/packet.c:1413:8
    #10 0x1fd726e in dissect_gre /src/wireshark/epan/dissectors/packet-gre.c:491:14
    #11 0x83674b in call_dissector_through_handle /src/wireshark/epan/packet.c:720:9
    #12 0x81f995 in call_dissector_work /src/wireshark/epan/packet.c:813:9
    #13 0x81f2a6 in dissector_try_uint_new /src/wireshark/epan/packet.c:1413:8
    #14 0x25a27fd in ip_try_dissect /src/wireshark/epan/dissectors/packet-ip.c:1817:7
    #15 0x263397e in ipv6_dissect_next /src/wireshark/epan/dissectors/packet-ipv6.c:2609:9
    #16 0x26362d6 in dissect_ipv6 /src/wireshark/epan/dissectors/packet-ipv6.c:2557:5
    #17 0x83674b in call_dissector_through_handle /src/wireshark/epan/packet.c:720:9
    #18 0x81f995 in call_dissector_work /src/wireshark/epan/packet.c:813:9
    #19 0x8189f9 in call_dissector_with_data /src/wireshark/epan/packet.c:3246:8
    #20 0x83674b in call_dissector_through_handle /src/wireshark/epan/packet.c:720:9
    #21 0x81f995 in call_dissector_work /src/wireshark/epan/packet.c:813:9
    #22 0x833b07 in call_all_postdissectors /src/wireshark/epan/packet.c:3608:3
    #23 0x1edb88c in dissect_frame /src/wireshark/epan/dissectors/packet-frame.c:901:5
    #24 0x83674b in call_dissector_through_handle /src/wireshark/epan/packet.c:720:9
    #25 0x81f995 in call_dissector_work /src/wireshark/epan/packet.c:813:9
    #26 0x8189f9 in call_dissector_with_data /src/wireshark/epan/packet.c:3246:8
    #27 0x816a6d in dissect_record /src/wireshark/epan/packet.c:594:3
    #28 0x7fae47 in epan_dissect_run /src/wireshark/epan/epan.c:594:2
    #29 0x4d01c4 in LLVMFuzzerTestOneInput /src/wireshark/fuzz/fuzzshark.c:381:2
    #30 0x5660f73 in ExecuteFilesOnyByOne /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:185:7
    #31 0x5660f73 in main /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:237:12
    #32 0x7f535dada83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #33 0x41ec78 in _start (/out/fuzzshark_ip+0x41ec78)

DEDUP_TOKEN: dissect_vjc_uncomp--call_dissector_through_handle--call_dissector_work
0x6020000d9bd0 is located 48 bytes to the right of 16-byte region [0x6020000d9b90,0x6020000d9ba0)
allocated by thread T0 here:
    #0 0x499b5d in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3
    #1 0x56d05b8 in g_malloc (/out/fuzzshark_ip+0x56d05b8)
    #2 0xa11b78 in tvb_memdup /src/wireshark/epan/tvbuff.c:905:10
    #3 0x40542f1 in dissect_vjc_uncomp /src/wireshark/epan/dissectors/packet-vj-comp.c:296:49
    #4 0x83674b in call_dissector_through_handle /src/wireshark/epan/packet.c:720:9
    #5 0x81f995 in call_dissector_work /src/wireshark/epan/packet.c:813:9
    #6 0x81f2a6 in dissector_try_uint_new /src/wireshark/epan/packet.c:1413:8
    #7 0x8209a8 in dissector_try_uint /src/wireshark/epan/packet.c:1437:9
    #8 0x338c7aa in dissect_ppp_common /src/wireshark/epan/dissectors/packet-ppp.c:4786:10
    #9 0x336a39d in dissect_ppp_raw_hdlc /src/wireshark/epan/dissectors/packet-ppp.c:6002:17
    #10 0x83674b in call_dissector_through_handle /src/wireshark/epan/packet.c:720:9
    #11 0x81f995 in call_dissector_work /src/wireshark/epan/packet.c:813:9
    #12 0x81f2a6 in dissector_try_uint_new /src/wireshark/epan/packet.c:1413:8
    #13 0x1fd726e in dissect_gre /src/wireshark/epan/dissectors/packet-gre.c:491:14
    #14 0x83674b in call_dissector_through_handle /src/wireshark/epan/packet.c:720:9
    #15 0x81f995 in call_dissector_work /src/wireshark/epan/packet.c:813:9
    #16 0x81f2a6 in dissector_try_uint_new /src/wireshark/epan/packet.c:1413:8
    #17 0x25a27fd in ip_try_dissect /src/wireshark/epan/dissectors/packet-ip.c:1817:7
    #18 0x263397e in ipv6_dissect_next /src/wireshark/epan/dissectors/packet-ipv6.c:2609:9
    #19 0x26362d6 in dissect_ipv6 /src/wireshark/epan/dissectors/packet-ipv6.c:2557:5
    #20 0x83674b in call_dissector_through_handle /src/wireshark/epan/packet.c:720:9
    #21 0x81f995 in call_dissector_work /src/wireshark/epan/packet.c:813:9
    #22 0x8189f9 in call_dissector_with_data /src/wireshark/epan/packet.c:3246:8
    #23 0x83674b in call_dissector_through_handle /src/wireshark/epan/packet.c:720:9
    #24 0x81f995 in call_dissector_work /src/wireshark/epan/packet.c:813:9
    #25 0x833b07 in call_all_postdissectors /src/wireshark/epan/packet.c:3608:3
    #26 0x1edb88c in dissect_frame /src/wireshark/epan/dissectors/packet-frame.c:901:5
    #27 0x83674b in call_dissector_through_handle /src/wireshark/epan/packet.c:720:9
    #28 0x81f995 in call_dissector_work /src/wireshark/epan/packet.c:813:9
    #29 0x8189f9 in call_dissector_with_data /src/wireshark/epan/packet.c:3246:8

DEDUP_TOKEN: malloc--g_malloc--tvb_memdup
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/wireshark/epan/dissectors/packet-vj-comp.c:305:25 in dissect_vjc_uncomp
Shadow bytes around the buggy address:
  0x0c0480013320: fa fa 00 04 fa fa 02 fa fa fa 00 00 fa fa 02 fa
  0x0c0480013330: fa fa 00 00 fa fa 05 fa fa fa 00 00 fa fa fd fa
  0x0c0480013340: fa fa 00 00 fa fa 06 fa fa fa 06 fa fa fa 00 fa
  0x0c0480013350: fa fa 00 00 fa fa 00 00 fa fa 00 04 fa fa 00 00
  0x0c0480013360: fa fa 00 04 fa fa 00 04 fa fa 00 04 fa fa 00 00
=>0x0c0480013370: fa fa 00 00 fa fa fa fa fa fa[fa]fa fa fa fa fa
  0x0c0480013380: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0480013390: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c04800133a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c04800133b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c04800133c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==13==ABORTING
