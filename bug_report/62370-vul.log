oss-fuzzshark: disabling: ip
oss-fuzzshark: disabling: udplite
oss-fuzzshark: disabling: ospf
oss-fuzzshark: disabling: bgp
oss-fuzzshark: disabling: dhcp
oss-fuzzshark: disabling: json
oss-fuzzshark: disabling: snort
oss-fuzzshark: configured for dissector: udp in table: ip.proto
INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2203300748
INFO: Loaded 1 modules   (406587 inline 8-bit counters): 406587 [0x111bd450, 0x1122088b), 
INFO: Loaded 1 PC tables (406587 PCs): 406587 [0x11220890,0x11854c40), 
/out/fuzzshark_ip_proto-udp: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==12==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x616000011096 at pc 0x000000530bc1 bp 0x7ffe7ec1ff10 sp 0x7ffe7ec1f6e0
READ of size 6 at 0x616000011096 thread T0
SCARINESS: 20 (6-byte-read-heap-buffer-overflow)
    #0 0x530bc0 in __asan_memcpy /src/llvm-project/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3
    #1 0x8a5f36 in ws_manuf_lookup_str /src/wireshark/epan/manuf.c:128:5
    #2 0x8882b8 in get_manuf_name_if_known /src/wireshark/epan/addr_resolv.c:3506:18
    #3 0x8882b8 in tvb_get_manuf_name_if_known /src/wireshark/epan/addr_resolv.c:3545:12
    #4 0x12c4f0b in add_manuf /src/wireshark/epan/dissectors/packet-ieee80211.c:10118:16
    #5 0x12c4f0b in dissect_roaming_consortium /src/wireshark/epan/dissectors/packet-ieee80211.c:26902:3
    #6 0x7164eb in call_dissector_through_handle /src/wireshark/epan/packet.c:857:9
    #7 0x7164eb in call_dissector_work /src/wireshark/epan/packet.c:948:9
    #8 0x715fe2 in dissector_try_uint_new /src/wireshark/epan/packet.c:1551:8
    #9 0x12a3adb in add_tagged_field_with_validation /src/wireshark/epan/dissectors/packet-ieee80211.c:30204:8
    #10 0x12defb4 in add_tagged_field /src/wireshark/epan/dissectors/packet-ieee80211.c:30044:10
    #11 0x12defb4 in ieee_80211_add_tagged_parameters /src/wireshark/epan/dissectors/packet-ieee80211.c:35853:19
    #12 0x12defb4 in dissect_ieee80211_mgt /src/wireshark/epan/dissectors/packet-ieee80211.c:36162:9
    #13 0x12defb4 in dissect_ieee80211_pv0 /src/wireshark/epan/dissectors/packet-ieee80211.c:40018:7
    #14 0x12d4c2e in dissect_ieee80211_common /src/wireshark/epan/dissectors/packet-ieee80211.c:40354:5
    #15 0x12a7829 in dissect_ieee80211_withoutfcs /src/wireshark/epan/dissectors/packet-ieee80211.c:40424:3
    #16 0x7164eb in call_dissector_through_handle /src/wireshark/epan/packet.c:857:9
    #17 0x7164eb in call_dissector_work /src/wireshark/epan/packet.c:948:9
    #18 0x712e6a in call_dissector_only /src/wireshark/epan/packet.c:3450:8
    #19 0x712e6a in call_dissector_with_data /src/wireshark/epan/packet.c:3463:8
    #20 0x153c1ea in dissect_lwapp /src/wireshark/epan/dissectors/packet-lwapp.c:453:9
    #21 0x7164eb in call_dissector_through_handle /src/wireshark/epan/packet.c:857:9
    #22 0x7164eb in call_dissector_work /src/wireshark/epan/packet.c:948:9
    #23 0x7169bf in dissector_try_uint_new /src/wireshark/epan/packet.c:1551:8
    #24 0x7169bf in dissector_try_uint /src/wireshark/epan/packet.c:1575:9
    #25 0x1eb8529 in decode_udp_ports /src/wireshark/epan/dissectors/packet-udp.c:681:27
    #26 0x1ebd932 in dissect /src/wireshark/epan/dissectors/packet-udp.c:1251:9
    #27 0x1eba71c in dissect_udp /src/wireshark/epan/dissectors/packet-udp.c:1257:5
    #28 0x7164eb in call_dissector_through_handle /src/wireshark/epan/packet.c:857:9
    #29 0x7164eb in call_dissector_work /src/wireshark/epan/packet.c:948:9
    #30 0x72066f in call_dissector_only /src/wireshark/epan/packet.c:3450:8
    #31 0x72066f in call_all_postdissectors /src/wireshark/epan/packet.c:3879:3
    #32 0x1054863 in dissect_frame /src/wireshark/epan/dissectors/packet-frame.c:1481:5
    #33 0x7164eb in call_dissector_through_handle /src/wireshark/epan/packet.c:857:9
    #34 0x7164eb in call_dissector_work /src/wireshark/epan/packet.c:948:9
    #35 0x712e6a in call_dissector_only /src/wireshark/epan/packet.c:3450:8
    #36 0x712e6a in call_dissector_with_data /src/wireshark/epan/packet.c:3463:8
    #37 0x712524 in dissect_record /src/wireshark/epan/packet.c:661:3
    #38 0x704934 in epan_dissect_run /src/wireshark/epan/epan.c:626:2
    #39 0x56eea0 in LLVMFuzzerTestOneInput /src/wireshark/fuzz/fuzzshark.c:382:2
    #40 0x4406a3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #41 0x42be02 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #42 0x4316ac in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #43 0x45abe2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #44 0x74fcd5784082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #45 0x421fcd in _start (/out/fuzzshark_ip_proto-udp+0x421fcd)

DEDUP_TOKEN: __asan_memcpy--ws_manuf_lookup_str--get_manuf_name_if_known
0x616000011096 is located 0 bytes to the right of 534-byte region [0x616000010e80,0x616000011096)
allocated by thread T0 here:
    #0 0x531836 in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:69:3
    #1 0x4b0237 in operator new(unsigned long) cxa_noexception.cpp
    #2 0x42be02 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #3 0x4316ac in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #4 0x45abe2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #5 0x74fcd5784082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)

DEDUP_TOKEN: malloc--operator new(unsigned long)--fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long)
SUMMARY: AddressSanitizer: heap-buffer-overflow /src/llvm-project/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3 in __asan_memcpy
Shadow bytes around the buggy address:
  0x0c2c7fffa1c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2c7fffa1d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c2c7fffa1e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c2c7fffa1f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c2c7fffa200: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0c2c7fffa210: 00 00[06]fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2c7fffa220: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2c7fffa230: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2c7fffa240: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2c7fffa250: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2c7fffa260: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==12==ABORTING
