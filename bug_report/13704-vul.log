INFO: Seed: 2195683111
INFO: Loaded 1 modules   (157248 inline 8-bit counters): 157248 [0x25791d0, 0x259f810), 
INFO: Loaded 1 PC tables (157248 PCs): 157248 [0x259f810,0x2805c10), 
/out/ia_fuzz: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
3
=================================================================
==12==ERROR: AddressSanitizer: heap-use-after-free on address 0x62600031dda0 at pc 0x0000008a6a85 bp 0x7ffe58783ef0 sp 0x7ffe58783ee8
READ of size 8 at 0x62600031dda0 thread T0
SCARINESS: 51 (8-byte-read-heap-use-after-free)
    #0 0x8a6a84 in sdb_free /src/radare2/shlr/sdb/src/sdb.c:217:14
    #1 0x85d6a6 in ns_free /src/radare2/shlr/sdb/src/ns.c:50:9
    #2 0x85cff8 in sdb_ns_free /src/radare2/shlr/sdb/src/ns.c:80:2
    #3 0x8a6e03 in sdb_fini /src/radare2/shlr/sdb/src/sdb.c:196:2
    #4 0x8a6c43 in sdb_free /src/radare2/shlr/sdb/src/sdb.c:221:4
    #5 0x85d881 in ns_free /src/radare2/shlr/sdb/src/ns.c:59:4
    #6 0x85cff8 in sdb_ns_free /src/radare2/shlr/sdb/src/ns.c:80:2
    #7 0x8a6e03 in sdb_fini /src/radare2/shlr/sdb/src/sdb.c:196:2
    #8 0x8a6c43 in sdb_free /src/radare2/shlr/sdb/src/sdb.c:221:4
    #9 0x85d6a6 in ns_free /src/radare2/shlr/sdb/src/ns.c:50:9
    #10 0x85cff8 in sdb_ns_free /src/radare2/shlr/sdb/src/ns.c:80:2
    #11 0x8a6e03 in sdb_fini /src/radare2/shlr/sdb/src/sdb.c:196:2
    #12 0x8a6c43 in sdb_free /src/radare2/shlr/sdb/src/sdb.c:221:4
    #13 0x632564 in r_core_fini /src/radare2/libr/core/core.c:2796:2
    #14 0x632a64 in r_core_free /src/radare2/libr/core/core.c:2806:3
    #15 0x4f5d98 in LLVMFuzzerTestOneInput /src/radare2/targets/ia_fuzz.cc:16:2
    #16 0x10c2fa5 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:529:15
    #17 0x10832f6 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:286:6
    #18 0x108ee23 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:715:9
    #19 0x108296c in main /src/libfuzzer/FuzzerMain.cpp:19:10
    #20 0x7a834724583f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #21 0x41f018 in _start (/out/ia_fuzz+0x41f018)

DEDUP_TOKEN: sdb_free--ns_free--sdb_ns_free
0x62600031dda0 is located 11424 bytes inside of 11568-byte region [0x62600031b100,0x62600031de30)
freed by thread T0 here:
    #0 0x4b1948 in __interceptor_free /src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:123
    #1 0x8a6c85 in sdb_free /src/radare2/shlr/sdb/src/sdb.c:223:4
    #2 0xbe9ab6 in object_delete_items /src/radare2/libr/bin/obj.c:52:2
    #3 0xbe988a in r_bin_object_free /src/radare2/libr/bin/obj.c:69:2
    #4 0x8533fc in r_list_delete /src/radare2/libr/util/list.c:107:3
    #5 0x853309 in r_list_purge /src/radare2/libr/util/list.c:74:3
    #6 0x8534b4 in r_list_free /src/radare2/libr/util/list.c:83:3
    #7 0xa9e590 in r_bin_file_free /src/radare2/libr/bin/bfile.c:694:2
    #8 0x8533fc in r_list_delete /src/radare2/libr/util/list.c:107:3
    #9 0x853309 in r_list_purge /src/radare2/libr/util/list.c:74:3
    #10 0x8534b4 in r_list_free /src/radare2/libr/util/list.c:83:3
    #11 0xaa581a in r_bin_free /src/radare2/libr/bin/bin.c:550:2
    #12 0x6322fb in r_core_fini /src/radare2/libr/core/core.c:2778:11
    #13 0x632a64 in r_core_free /src/radare2/libr/core/core.c:2806:3
    #14 0x4f5d98 in LLVMFuzzerTestOneInput /src/radare2/targets/ia_fuzz.cc:16:2
    #15 0x10c2fa5 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:529:15
    #16 0x10832f6 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:286:6
    #17 0x108ee23 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:715:9
    #18 0x108296c in main /src/libfuzzer/FuzzerMain.cpp:19:10
    #19 0x7a834724583f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: __interceptor_free--sdb_free--object_delete_items
previously allocated by thread T0 here:
    #0 0x4b1dfa in calloc /src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:154
    #1 0x8a2ff2 in sdb_new /src/radare2/shlr/sdb/src/sdb.c:56:11
    #2 0x8a2f70 in sdb_new0 /src/radare2/shlr/sdb/src/sdb.c:52:9
    #3 0xaad3e8 in load_buffer /src/radare2/libr/../libr/bin/p/bin_art.c:73:11
    #4 0xbe9fcf in r_bin_object_new /src/radare2/libr/bin/obj.c:180:16
    #5 0xa9ccaf in r_bin_file_new_from_bytes /src/radare2/libr/bin/bfile.c:469:18
    #6 0xaa3934 in r_bin_open_io /src/radare2/libr/bin/bin.c:407:13
    #7 0x5f59b0 in cmd_open_bin /src/radare2/libr/core/./cmd_open.c:302:6
    #8 0x542007 in cmd_open /src/radare2/libr/core/./cmd_open.c:1360:3
    #9 0x61fa5f in r_cmd_call /src/radare2/libr/core/cmd_api.c:235:10
    #10 0x56bfc1 in r_core_cmd_subst_i /src/radare2/libr/core/cmd.c:3027:12
    #11 0x51653b in r_core_cmd_subst /src/radare2/libr/core/cmd.c:2036:9
    #12 0x50f952 in r_core_cmd /src/radare2/libr/core/cmd.c:3761:9
    #13 0x4f5d83 in LLVMFuzzerTestOneInput /src/radare2/targets/ia_fuzz.cc:13:2
    #14 0x10c2fa5 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:529:15
    #15 0x10832f6 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:286:6
    #16 0x108ee23 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:715:9
    #17 0x108296c in main /src/libfuzzer/FuzzerMain.cpp:19:10
    #18 0x7a834724583f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

DEDUP_TOKEN: calloc--sdb_new--sdb_new0
SUMMARY: AddressSanitizer: heap-use-after-free /src/radare2/shlr/sdb/src/sdb.c:217:14 in sdb_free
Shadow bytes around the buggy address:
  0x0c4c8005bb60: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c4c8005bb70: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c4c8005bb80: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c4c8005bb90: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c4c8005bba0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
=>0x0c4c8005bbb0: fd fd fd fd[fd]fd fd fd fd fd fd fd fd fd fd fd
  0x0c4c8005bbc0: fd fd fd fd fd fd fa fa fa fa fa fa fa fa fa fa
  0x0c4c8005bbd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4c8005bbe0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4c8005bbf0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c4c8005bc00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==12==ABORTING
