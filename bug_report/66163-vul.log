INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2263445839
INFO: Loaded 1 modules   (314706 inline 8-bit counters): 314706 [0x1497628, 0x14e437a), 
INFO: Loaded 1 PC tables (314706 PCs): 314706 [0x14e4380,0x19b18a0), 
/out/fuzz_probe_analyze: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
[31m[HEVC] 21 layers in VPS but only 4 supported in GPAC
[0m[31m[HEVC] Error parsing NAL unit type 32
[0m[31m[HEVC] Error parsing Video Param Set
[0m[31m[HEVC] 21 layers in VPS but only 4 supported in GPAC
[0m[31m[HEVC] wrong PPS ID 10560417 in PPS
[0m[31m[HEVC] VPS max layer ID 19 but GPAC only supports 4
[0m[31m[BS] Attempt to overread bitstream
[0m[31m[Core] exp-golomb read failed, not enough bits in bitstream !
[0m[31m[HEVC] 21 layers in VPS but only 4 supported in GPAC
[0m[31m[HEVC] Error parsing NAL unit type 32
[0m[31m[HEVC] Error parsing Video Param Set
[0m[31m[HEVC] Error parsing NAL Unit 2 (size 11 type 32 frame 0 last POC 0) - skipping
[0m[31m[Core] exp-golomb read failed, not enough bits in bitstream !
[0m[31m[HEVC] Error parsing NAL unit type 34
[0m[31m[HEVC] Error parsing Picture Param Set
[0m[31m[HEVC] Error parsing NAL Unit 4 (size 2 type 34 frame 1 last POC 0) - skipping
[0m[31m[Core] exp-golomb read failed, not enough bits in bitstream !
[0m[31m[HEVC] Error parsing NAL unit type 33
[0m[31m[HEVC] Error parsing Sequence Param Set
[0m[31m[HEVC] Error parsing NAL Unit 5 (size 4 type 33 frame 1 last POC 0) - skipping
[0m[31m[Core] exp-golomb read failed, not enough bits in bitstream !
[0m[31m[HEVC] Error parsing NAL unit type 34
[0m[31m[HEVC] Error parsing Picture Param Set
[0m[31m[HEVC] Error parsing NAL Unit 7 (size 12 type 34 frame 1 last POC -6) - skipping
[0m[31m[HEVC] 21 layers in VPS but only 4 supported in GPAC
[0m[31m[HEVC] Error parsing NAL unit type 32
[0m[31m[HEVC] Error parsing Video Param Set
[0m[31m[HEVC] Error parsing NAL Unit 8 (size 4 type 32 frame 1 last POC -6) - skipping
[0m[31m[HEVC] Error parsing NAL Unit 10 (size 1 type 26 frame 1 last POC -6) - skipping
[0m[31m[HEVC] Error parsing NAL unit type 3
[0m[31m[HEVC] Error parsing NAL Unit 11 (size 39 type 3 frame 1 last POC -6) - skipping
[0m[31m[HEVC] Error parsing NAL unit type 0
[0m[31m[HEVC] Error parsing NAL Unit 13 (size 25 type 0 frame 2 last POC -1) - skipping
[0m[31m[Core] exp-golomb read failed, not enough bits in bitstream !
[0m[31m[HEVC] Error parsing NAL unit type 32
[0m[31m[HEVC] Error parsing NAL Unit 14 (size 2 type 32 frame 2 last POC -1) - skipping
[0m[31m[Core] exp-golomb read failed, not enough bits in bitstream !
[0m[31m[HEVC] Error parsing NAL unit type 33
[0m[31m[HEVC] Error parsing Sequence Param Set
[0m[31m[HEVC] Error parsing NAL Unit 15 (size 4 type 33 frame 2 last POC -1) - skipping
[0m[31m[HEVC] Error parsing NAL unit type 34
[0m[31m[HEVC] Error parsing NAL Unit 17 (size 12 type 34 frame 3 last POC -7) - skipping
[0m[33mError parsing slice header: byte_align not found at end of header !
[0m<?xml version="1.0" encoding="UTF-8"?>
<GPACInspect>
<PIDConfigure PID="1" name="libfuzzer.13" SourcePath="/tmp/libfuzzer.13" URL="/tmp/libfuzzer.13" Extension="13" MIMEType="video/hevc" Cached="true" DownloadSize="562" StreamType="Visual" ID="1" Width="0" Height="0" FPS="25" Timescale="25000" CodecID="HEVC Video Layered Extensions" DecoderConfig="6 bytes (CRC32 0xB42F1D47)" Bitrate="112400" Duration="1000/25000" PlaybackMode="forward">
<HEVCParameterSets>
</HEVCParameterSets>
</PIDConfigure>
<Packet number="1" PID="1" framing="complete" dts="0" cts="0" dur="1000" sap="0" ilace="0" corr="0" seek="0" bo="N/A" roll="0" crypt="0" vers="0" size="99" lp="0" depo="0" depf="0" red="0" CRC32="0x8459966E">
   <NALU size="4"  forbidden_zero="0" nuh_type="40" layerID="40" temporalID="7" type="SEI Suffix">
    <SEIMessage ptype="69" psize="79" type="Unknown"/>
   </NALU>
   <NALU size="4"  forbidden_zero="0" nuh_type="0" layerID="40" temporalID="7" first_slice_segment_in_pic_flag="0" pps_id="0" slice_type="9" short_term_ref_pic_set_sps_flag="1" slice_qp_delta="1" byte_align="0" type="TRAIL_N slice segment"/>
   <NALU size="4"  forbidden_zero="0" nuh_type="40" layerID="40" temporalID="7" type="SEI Suffix">
    <SEIMessage ptype="69" psize="79" type="Unknown"/>
   </NALU>
   <NALU size="71"  forbidden_zero="0" nuh_type="34" layerID="40" temporalID="5" pps_id="1" sps_id="0" dependent_slice_segments_enabled_flag="0" output_flag_present_flag="0" num_extra_slice_header_bits="2" sign_data_hiding_flag="0" cabac_init_present_flag="0" num_ref_idx_l0_default_active="62" num_ref_idx_l1_default_active="0" pic_init_qp_minus26="0" constrained_intra_pred_flag="1" transform_skip_enabled_flag="1" cu_qp_delta_enabled_flag="1" diff_cu_qp_delta_depth="0" pic_cb_qp_offset="0" pic_cr_qp_offset="0" slice_chroma_qp_offsets_present_flag="1" weighted_pred_flag="1" weighted_bipred_flag="1" transquant_bypass_enable_flag="1" tiles_enabled_flag="1" entropy_coding_sync_enabled_flag="1" num_tile_columns_minus1="0" num_tile_rows_minus1="0" uniform_spacing_flag="1" loop_filter_across_tiles_enabled_flag="1" loop_filter_across_slices_enabled_flag="0" deblocking_filter_control_present_flag="1" deblocking_filter_override_enabled_flag="1" pic_disable_deblocking_filter_flag="1" pic_scaling_list_data_present_flag="1" scaling_list_pred_mode_flag_sizeId_matrixId_0="1" scaling_list_delta_coef_0_0="0" scaling_list_delta_coef_0_1="0" scaling_list_delta_coef_0_2="-5" scaling_list_delta_coef_0_3="28" scaling_list_delta_coef_0_4="-3" scaling_list_delta_coef_0_5="-29" scaling_list_delta_coef_0_6="0" scaling_list_delta_coef_0_7="0" scaling_list_delta_coef_0_8="-7" scaling_list_delta_coef_0_9="0" scaling_list_delta_coef_0_10="0" scaling_list_delta_coef_0_11="0" scaling_list_delta_coef_0_12="0" scaling_list_delta_coef_0_13="0" scaling_list_delta_coef_0_14="0" scaling_list_delta_coef_0_15="0" scaling_list_pred_mode_flag_sizeId_matrixId_10="1" scaling_list_delta_coef_10_0="0" scaling_list_delta_coef_10_1="0" scaling_list_delta_coef_10_2="0" scaling_list_delta_coef_10_3="-1" scaling_list_delta_coef_10_4="0" scaling_list_delta_coef_10_5="0" scaling_list_delta_coef_10_6="0" scaling_list_delta_coef_10_7="0" scaling_list_delta_coef_10_8="0" scaling_list_delta_coef_10_9="1" scaling_list_delta_coef_10_10="16" scaling_list_delta_coef_10_11="2" scaling_list_delta_coef_10_12="16" scaling_list_delta_coef_10_13="2" scaling_list_delta_coef_10_14="7" scaling_list_delta_coef_10_15="14" scaling_list_pred_mode_flag_sizeId_matrixId_20="0" scaling_list_pred_matrix_id_delta_20="65936" scaling_list_pred_mode_flag_sizeId_matrixId_30="1" scaling_list_delta_coef_30_0="1" scaling_list_delta_coef_30_1="6" scaling_list_delta_coef_30_2="0" scaling_list_delta_coef_30_3="6" scaling_list_delta_coef_30_4="0" scaling_list_delta_coef_30_5="0" scaling_list_delta_coef_30_6="3" scaling_list_delta_coef_30_7="-2" scaling_list_delta_coef_30_8="1" scaling_list_delta_coef_30_9="1" scaling_list_delta_coef_30_10="1" scaling_list_delta_coef_30_11="0" scaling_list_delta_coef_30_12="2" scaling_list_delta_coef_30_13="0" scaling_list_d[31m[Core] exp-golomb read failed, not enough bits in bitstream !
[0m[31m[HEVC] Error parsing NAL unit type 34
[0m[31m[HEVC] Error parsing Picture Param Set
[0m[31m[HEVC] Error parsing NAL Unit 20 (size 12 type 34 frame 5 last POC 2) - skipping
[0m[31m[HEVC] 21 layers in VPS but only 4 supported in GPAC
[0m[31m[HEVC] Error parsing NAL unit type 32
[0m[31m[HEVC] Error parsing Video Param Set
[0m[31m[HEVC] Error parsing NAL Unit 21 (size 4 type 32 frame 5 last POC 2) - skipping
[0m[31m[HEVC] Error parsing NAL unit type 33
[0m[31m[HEVC] Error parsing Sequence Param Set
[0m[31m[HEVC] Error parsing NAL Unit 23 (size 4 type 33 frame 5 last POC 2) - skipping
[0melta_coef_30_14="1" scaling_list_delta_coef_30_15="1" scaling_list_pred_mode_flag_sizeId_matrixId_40="0" scaling_list_pred_matrix_id_delta_40="0" scaling_list_pred_mode_flag_sizeId_matrixId_50="0" scaling_list_pred_matrix_id_delta_50="0" scaling_list_pred_mode_flag_sizeId_matrixId_100="0" scaling_list_pred_matrix_id_delta_100="1" scaling_list_pred_mode_flag_sizeId_matrixId_110="0" scaling_list_pred_matrix_id_delta_110="0" scaling_list_pred_mode_flag_sizeId_matrixId_120="0" scaling_list_pred_matrix_id_delta_120="0" scaling_list_pred_mode_flag_sizeId_matrixId_130="0" scaling_list_pred_matrix_id_delta_130="1" scaling_list_pred_mode_flag_sizeId_matrixId_140="0" scaling_list_pred_matrix_id_delta_140="0" scaling_list_pred_mode_flag_sizeId_matrixId_150="0" scaling_list_pred_matrix_id_delta_150="0" scaling_list_pred_mode_flag_sizeId_matrixId_200="0" scaling_list_pred_matrix_id_delta_200="1" scaling_list_pred_mode_flag_sizeId_matrixId_210="0" scaling_list_pred_matrix_id_delta_210="0" scaling_list_pred_mode_flag_sizeId_matrixId_220="0" scaling_list_pred_matrix_id_delta_220="0" scaling_list_pred_mode_flag_sizeId_matrixId_230="0" scaling_list_pred_matrix_id_delta_230="1" scaling_list_pred_mode_flag_sizeId_matrixId_240="0" scaling_list_pred_matrix_id_delta_240="0" scaling_list_pred_mode_flag_sizeId_matrixId_250="0" scaling_list_pred_matrix_id_delta_250="0" scaling_list_pred_mode_flag_sizeId_matrixId_300="0" scaling_list_pred_matrix_id_delta_300="1" scaling_list_pred_mode_flag_sizeId_matrixId_330="0" scaling_list_pred_matrix_id_delta_330="0" lists_modification_present_flag="0" log2_parallel_merge_level_minus2="0" slice_segment_header_extension_present_flag="0" pps_extension_flag="0" type="Picture Parameter Set"/>
</Packet>
<PIDReconfigure PID="1" name="libfuzzer.13" packetsSinceLastConfig="1" SourcePath="/tmp/libfuzzer.13" URL="/tmp/libfuzzer.13" Extension="13" MIMEType="video/hevc" Cached="true" DownloadSize="562" StreamType="Visual" ID="1" Width="0" Height="0" FPS="25" Timescale="25000" DSISuperset="true" CodecID="HEVC Video Layered Extensions" DecoderConfig="6 bytes (CRC32 0x3E675E15)" Bitrate="112400" Duration="1000/25000" PlaybackMode="forward">
<HEVCParameterSets>
</HEVCParameterSets>
</PIDReconfigure>
<Packet number="2" PID="1" framing="complete" dts="1000" cts="6000" dur="1000" sap="0" ilace="0" corr="0" seek="0" bo="N/A" roll="0" crypt="0" vers="0" size="186" lp="0" depo="0" depf="0" red="0" CRC32="0xB77EF77B">
   <NALU size="182"  forbidden_zero="0" nuh_type="4" layerID="4" temporalID="6" first_slice_segment_in_pic_flag="0" pps_id="13" slice_type="0" short_term_ref_pic_set_sps_flag="1" num_ref_idx_active_override_flag="1" num_ref_idx_l0_active="0" num_ref_idx_l1_active="0" mvd_l1_zero_flag="1" five_minus_max_num_merge_cand="0" slice_qp_delta="0" byte_align="1" type="STSA_N slice segment"/>
</Packet>
<Packet number="3" PID="1" framing="complete" dts="2000" cts="0" dur="1000" sap="0" ilace="0" corr="0" seek="0" bo="N/A" roll="0" crypt="0" vers="0" size="8" lp="0" depo="0" depf="0" red="0" CRC32="0x3C0F85CB">
   <NALU size="4"  forbidden_zero="0" nuh_type="0" layerID="40" temporalID="7" first_slice_segment_in_pic_flag="0" pps_id="0" slice_type="9" short_term_ref_pic_set_sps_flag="1" slice_qp_delta="-3" byte_align="1" type="TRAIL_N slice segment"/>
</Packet>
<Packet number="4" PID="1" framing="complete" dts="3000" cts="8000" dur="1000" sap="0" ilace="0" corr="0" seek="0" bo="N/A" roll="0" crypt="0" vers="0" size="50" lp="0" depo="0" depf="0" red="0" CRC32="0x980B556F">
   <NALU size="46"  forbidden_zero="0" nuh_type="0" layerID="40" temporalID="7" first_slice_segment_in_pic_flag="0" pps_id="1" slice_reserved_undetermined_flag="2" slice_type="0" short_term_ref_pic_set_sps_flag="0" num_negative_pics_0="4" num_positive_pics_0="1" delta_poc_s0_minus1_0_0="4" delta_poc_s0_minus1_0_0="0" delta_poc_s0_minus1_0_1="0" delta_poc_s0_minus1_0_1="0" delta_poc_s0_minus1_0_2="4" delta_poc_s0_minus1_0_2="0" delta_poc_s0_minus1_0_3="0" delta_poc_s0_minus1_0_3="0" delta_poc_s1_minus1_0_0="32830" used_by_curr_pic_s1_flag_0_0="1" num_ref_idx_activemedia_tools/av_parsers.c:7140:3: runtime error: index 20 out of bounds for type 'u8[20]' (aka 'unsigned char[20]')
    #0 0xc56420 in hevc_pred_weight_table /src/gpac/src/media_tools/av_parsers.c:7140:19
    #1 0xc5d219 in hevc_parse_slice_segment /src/gpac/src/media_tools/av_parsers.c:7375:5
    #2 0xc5d219 in gf_hevc_parse_nalu_bs /src/gpac/src/media_tools/av_parsers.c:8750:9
    #3 0x5f731e in gf_inspect_dump_nalu_internal /src/gpac/src/filters/inspect.c:829:10
    #4 0x5ff00f in inspect_dump_packet /src/gpac/src/filters/inspect.c:3225:5
    #5 0x5ff00f in inspect_process /src/gpac/src/filters/inspect.c:4502:6
    #6 0x4e52b8 in gf_filter_process_task /src/gpac/src/filter_core/filter.c:2971:7
    #7 0x4cd8e7 in gf_fs_thread_proc /src/gpac/src/filter_core/filter_session.c:2105:3
    #8 0x4cbe08 in gf_fs_run /src/gpac/src/filter_core/filter_session.c:2405:3
    #9 0x4c3fde in LLVMFuzzerTestOneInput /src/testsuite/oss-fuzzers/fuzz_probe_analyze.c:21:5
    #10 0x429e73 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #11 0x4155d2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #12 0x41ae7c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #13 0x4443b2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #14 0x714e84894082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #15 0x40b79d in _start (/out/fuzz_probe_analyze+0x40b79d)

DEDUP_TOKEN: hevc_pred_weight_table--hevc_parse_slice_segment--gf_hevc_parse_nalu_bs
SUMMARY: UndefinedBehaviorSanitizer: undefined-behavior media_tools/av_parsers.c:7140:3 in 
