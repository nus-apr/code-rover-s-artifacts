Reading 955 bytes from /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: attempting double-free on 0x604000000110 in thread T0:
SCARINESS: 42 (double-free)
    #0 0x4a01d2 in __interceptor_free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3
    #1 0x5d018e in sc_pkcs15_encode_df /src/opensc/src/libopensc/pkcs15.c:2035:4
    #2 0x512718 in sc_pkcs15init_update_any_df /src/opensc/src/tests/fuzzing/../../../src/pkcs15init/pkcs15-lib.c:3229:6
    #3 0x4ec5bb in sc_pkcs15init_add_object /src/opensc/src/tests/fuzzing/../../../src/pkcs15init/pkcs15-lib.c:3311:7
    #4 0x4f0177 in sc_pkcs15init_store_pin /src/opensc/src/tests/fuzzing/../../../src/pkcs15init/pkcs15-lib.c:1076:6
    #5 0x531d67 in do_store_pin /src/opensc/src/tests/fuzzing/fuzz_pkcs15init.c:158:5
    #6 0x5346a1 in LLVMFuzzerTestOneInput /src/opensc/src/tests/fuzzing/fuzz_pkcs15init.c:337:9
    #7 0x54ca55 in ExecuteFilesOnyByOne /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:191:7
    #8 0x54c8c5 in main /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c
    #9 0x7c31f8dcc082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)
    #10 0x41fe2d in _start (/out/fuzz_pkcs15init+0x41fe2d)

DEDUP_TOKEN: __interceptor_free--sc_pkcs15_encode_df--sc_pkcs15init_update_any_df
0x604000000110 is located 0 bytes inside of 35-byte region [0x604000000110,0x604000000133)
freed by thread T0 here:
    #0 0x4a01d2 in __interceptor_free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3
    #1 0x5d046b in sc_pkcs15_encode_df /src/opensc/src/libopensc/pkcs15.c:2049:3
    #2 0x512718 in sc_pkcs15init_update_any_df /src/opensc/src/tests/fuzzing/../../../src/pkcs15init/pkcs15-lib.c:3229:6
    #3 0x4ec5bb in sc_pkcs15init_add_object /src/opensc/src/tests/fuzzing/../../../src/pkcs15init/pkcs15-lib.c:3311:7
    #4 0x4f0177 in sc_pkcs15init_store_pin /src/opensc/src/tests/fuzzing/../../../src/pkcs15init/pkcs15-lib.c:1076:6
    #5 0x531d67 in do_store_pin /src/opensc/src/tests/fuzzing/fuzz_pkcs15init.c:158:5
    #6 0x5346a1 in LLVMFuzzerTestOneInput /src/opensc/src/tests/fuzzing/fuzz_pkcs15init.c:337:9
    #7 0x54ca55 in ExecuteFilesOnyByOne /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:191:7

DEDUP_TOKEN: __interceptor_free--sc_pkcs15_encode_df--sc_pkcs15init_update_any_df
previously allocated by thread T0 here:
    #0 0x4a0733 in __interceptor_realloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:148:3
    #1 0x5767ec in asn1_encode /src/opensc/src/libopensc/asn1.c:2022:16
    #2 0x576249 in sc_asn1_encode /src/opensc/src/libopensc/asn1.c:2044:9
    #3 0x5efb2d in sc_pkcs15_encode_aodf_entry /src/opensc/src/libopensc/pkcs15-pin.c:253:6
    #4 0x5d010e in sc_pkcs15_encode_df /src/opensc/src/libopensc/pkcs15.c:2033:7
    #5 0x512718 in sc_pkcs15init_update_any_df /src/opensc/src/tests/fuzzing/../../../src/pkcs15init/pkcs15-lib.c:3229:6
    #6 0x4ec5bb in sc_pkcs15init_add_object /src/opensc/src/tests/fuzzing/../../../src/pkcs15init/pkcs15-lib.c:3311:7
    #7 0x4f0177 in sc_pkcs15init_store_pin /src/opensc/src/tests/fuzzing/../../../src/pkcs15init/pkcs15-lib.c:1076:6
    #8 0x531d67 in do_store_pin /src/opensc/src/tests/fuzzing/fuzz_pkcs15init.c:158:5
    #9 0x5346a1 in LLVMFuzzerTestOneInput /src/opensc/src/tests/fuzzing/fuzz_pkcs15init.c:337:9
    #10 0x54ca55 in ExecuteFilesOnyByOne /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:191:7

DEDUP_TOKEN: __interceptor_realloc--asn1_encode--sc_asn1_encode
SUMMARY: AddressSanitizer: double-free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3 in __interceptor_free
==13==ABORTING
