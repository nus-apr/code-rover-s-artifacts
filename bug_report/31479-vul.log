INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2328768792
INFO: Loaded 1 modules   (4528 inline 8-bit counters): 4528 [0x82ab23, 0x82bcd3), 
INFO: Loaded 1 PC tables (4528 PCs): 4528 [0x82bcd8,0x83d7d8), 
/out/pdu_parse_fuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
Oct 25 05:39:26.987 WARN coap_pdu_parse: 1.00: offset 1 option 4 has bad length 0
Oct 25 05:39:26.987 WARN coap_pdu_parse: 1.00: offset 7 option 16 has bad length 0
=================================================================
==12==ERROR: AddressSanitizer: global-buffer-overflow on address 0x000001164608 at pc 0x0000004db11c bp 0x7ffe83cc2b30 sp 0x7ffe83cc2b28
WRITE of size 1 at 0x000001164608 thread T0
SCARINESS: 31 (1-byte-write-global-buffer-overflow)
    #0 0x4db11b in coap_pdu_parse_opt /src/libcoap/src/pdu.c:1067:14
    #1 0x4dc34e in coap_pdu_parse /src/libcoap/src/pdu.c:1113:47
    #2 0x4cd71d in LLVMFuzzerTestOneInput (/out/pdu_parse_fuzzer+0x4cd71d)
    #3 0x55f0f1 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15
    #4 0x548db2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6
    #5 0x54f106 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:856:9
    #6 0x5790d2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #7 0x7c11c199c83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)
    #8 0x41eb48 in _start (/out/pdu_parse_fuzzer+0x41eb48)

DEDUP_TOKEN: coap_pdu_parse_opt--coap_pdu_parse--LLVMFuzzerTestOneInput
0x000001164608 is located 0 bytes to the right of global variable 'outbuf' defined in 'src/pdu.c:1024:19' (0x1163e00) of size 2056
SUMMARY: AddressSanitizer: global-buffer-overflow /src/libcoap/src/pdu.c:1067:14 in coap_pdu_parse_opt
Shadow bytes around the buggy address:
  0x000080224870: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x000080224880: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x000080224890: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0000802248a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0000802248b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0000802248c0: 00[f9]f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9
  0x0000802248d0: f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9
  0x0000802248e0: f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9
  0x0000802248f0: f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9 f9
  0x000080224900: f9 f9 f9 f9 04 f9 f9 f9 f9 f9 f9 f9 00 00 00 00
  0x000080224910: f9 f9 f9 f9 00 00 00 00 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==12==ABORTING
