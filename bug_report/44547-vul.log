=================================================================
==13==ERROR: AddressSanitizer: heap-use-after-free on address 0x6080000000e0 at pc 0x000000576ad8 bp 0x7ffe222d0e30 sp 0x7ffe222d0e28
READ of size 4 at 0x6080000000e0 thread T0
SCARINESS: 45 (4-byte-read-heap-use-after-free)
    #0 0x576ad7 in run_filters /src/libarchive/libarchive/archive_read_support_format_rar.c:3334:30
    #1 0x576ad7 in read_data_compressed /src/libarchive/libarchive/archive_read_support_format_rar.c:2082:12
    #2 0x576ad7 in archive_read_format_rar_read_data /src/libarchive/libarchive/archive_read_support_format_rar.c:1126:11
    #3 0x4e8509 in _archive_read_data_block /src/libarchive/libarchive/archive_read.c:987:9
    #4 0x4dfb6c in archive_read_data /src/libarchive/libarchive/archive_read.c:841:8
    #5 0x4d83d6 in LLVMFuzzerTestOneInput /src/libarchive_fuzzer.cc:55:17
    #6 0x4dad35 in ExecuteFilesOnyByOne /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:191:7
    #7 0x4daba5 in main /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c
    #8 0x75639a1ca082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)
    #9 0x41f9ed in _start (/out/libarchive_fuzzer+0x41f9ed)

DEDUP_TOKEN: run_filters--read_data_compressed--archive_read_format_rar_read_data
0x6080000000e0 is located 64 bytes inside of 88-byte region [0x6080000000a0,0x6080000000f8)
freed by thread T0 here:
    #0 0x49ea82 in __interceptor_free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3
    #1 0x5847cf in delete_filter /src/libarchive/libarchive/archive_read_support_format_rar.c:3430:5
    #2 0x5847cf in parse_filter /src/libarchive/libarchive/archive_read_support_format_rar.c:3187:7
    #3 0x5847cf in read_filter /src/libarchive/libarchive/archive_read_support_format_rar.c:3537:8
    #4 0x5847cf in expand /src/libarchive/libarchive/archive_read_support_format_rar.c:2920:12
    #5 0x571725 in run_filters /src/libarchive/libarchive/archive_read_support_format_rar.c:3333:17
    #6 0x571725 in read_data_compressed /src/libarchive/libarchive/archive_read_support_format_rar.c:2082:12
    #7 0x571725 in archive_read_format_rar_read_data /src/libarchive/libarchive/archive_read_support_format_rar.c:1126:11
    #8 0x4e8509 in _archive_read_data_block /src/libarchive/libarchive/archive_read.c:987:9
    #9 0x4dfb6c in archive_read_data /src/libarchive/libarchive/archive_read.c:841:8
    #10 0x4d83d6 in LLVMFuzzerTestOneInput /src/libarchive_fuzzer.cc:55:17
    #11 0x4dad35 in ExecuteFilesOnyByOne /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:191:7

DEDUP_TOKEN: __interceptor_free--delete_filter--parse_filter
previously allocated by thread T0 here:
    #0 0x49ee72 in __interceptor_calloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:138:3
    #1 0x586ac8 in create_filter /src/libarchive/libarchive/archive_read_support_format_rar.c:3302:12
    #2 0x586ac8 in parse_filter /src/libarchive/libarchive/archive_read_support_format_rar.c:3275:12
    #3 0x586ac8 in read_filter /src/libarchive/libarchive/archive_read_support_format_rar.c:3537:8
    #4 0x586ac8 in expand /src/libarchive/libarchive/archive_read_support_format_rar.c:2920:12
    #5 0x572529 in read_data_compressed /src/libarchive/libarchive/archive_read_support_format_rar.c:2182:24
    #6 0x572529 in archive_read_format_rar_read_data /src/libarchive/libarchive/archive_read_support_format_rar.c:1126:11
    #7 0x4e8509 in _archive_read_data_block /src/libarchive/libarchive/archive_read.c:987:9
    #8 0x4dfb6c in archive_read_data /src/libarchive/libarchive/archive_read.c:841:8
    #9 0x4d83d6 in LLVMFuzzerTestOneInput /src/libarchive_fuzzer.cc:55:17
    #10 0x4dad35 in ExecuteFilesOnyByOne /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:191:7

DEDUP_TOKEN: __interceptor_calloc--create_filter--parse_filter
SUMMARY: AddressSanitizer: heap-use-after-free /src/libarchive/libarchive/archive_read_support_format_rar.c:3334:30 in run_filters
Shadow bytes around the buggy address:
  0x0c107fff7fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c107fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c107fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c107fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c107fff8000: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 02
=>0x0c107fff8010: fa fa fa fa fd fd fd fd fd fd fd fd[fd]fd fd fa
  0x0c107fff8020: fa fa fa fa fd fd fd fd fd fd fd fd fd fd fd fa
  0x0c107fff8030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c107fff8040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c107fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c107fff8060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==13==ABORTING
