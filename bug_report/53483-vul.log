INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2278867384
INFO: Loaded 1 modules   (552384 inline 8-bit counters): 552384 [0x48d46c0, 0x495b480), 
INFO: Loaded 1 PC tables (552384 PCs): 552384 [0x3dddca8,0x464b8a8), 
/out/llvmfuzz: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: attempting double-free on 0x604000000110 in thread T0:
SCARINESS: 42 (double-free)
    #0 0x523932 in __interceptor_free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3
    #1 0x110f79f in dwg_free /src/libredwg/src/free.c:1553:15
    #2 0x55ab7b in LLVMFuzzerTestOneInput /src/libredwg/examples/llvmfuzz.c
    #3 0x4552b3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #4 0x440f42 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #5 0x44678c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #6 0x46f382 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #7 0x7d12d41ee082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)
    #8 0x41f76d in _start (/out/llvmfuzz+0x41f76d)

DEDUP_TOKEN: __interceptor_free--dwg_free--LLVMFuzzerTestOneInput
0x604000000110 is located 0 bytes inside of 48-byte region [0x604000000110,0x604000000140)
freed by thread T0 here:
    #0 0x523932 in __interceptor_free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3
    #1 0x110fcbe in dwg_free_preR13_header_vars /src/libredwg/src/./header_variables_r11.spec:252:5
    #2 0x110fcbe in dwg_free /src/libredwg/src/free.c:1505:9
    #3 0x55ab7b in LLVMFuzzerTestOneInput /src/libredwg/examples/llvmfuzz.c
    #4 0x4552b3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #5 0x440f42 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #6 0x44678c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #7 0x46f382 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #8 0x7d12d41ee082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)

DEDUP_TOKEN: __interceptor_free--dwg_free_preR13_header_vars--dwg_free
previously allocated by thread T0 here:
    #0 0x523d22 in __interceptor_calloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:138:3
    #1 0x5bc520 in dwg_new_ref /src/libredwg/src/decode.c:4027:43
    #2 0x3a05da1 in dwg_add_handleref /src/libredwg/src/dwg.c:2019:9
    #3 0x11a79c1 in dwg_add_Document /src/libredwg/src/dwg_api.c:22338:35
    #4 0xf6bd93 in decode_preR13 /src/libredwg/src/decode_r11.c:669:12
    #5 0x575771 in dwg_decode /src/libredwg/src/decode.c:209:23
    #6 0x55ab53 in LLVMFuzzerTestOneInput /src/libredwg/examples/llvmfuzz.c:91:13
    #7 0x4552b3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #8 0x440f42 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #9 0x44678c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #10 0x46f382 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #11 0x7d12d41ee082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)

DEDUP_TOKEN: __interceptor_calloc--dwg_new_ref--dwg_add_handleref
SUMMARY: AddressSanitizer: double-free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3 in __interceptor_free
==13==ABORTING
