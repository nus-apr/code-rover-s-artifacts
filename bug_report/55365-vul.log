Accepting input from '/tmp/poc'
Usage for fuzzing: honggfuzz -P [flags] -- /out/zip_read_fuzzer
=================================================================
==13==ERROR: AddressSanitizer: heap-use-after-free on address 0x6080000000d8 at pc 0x0000005059ca bp 0x7ffcad6a5370 sp 0x7ffcad6a5368
READ of size 1 at 0x6080000000d8 thread T0
SCARINESS: 40 (1-byte-read-heap-use-after-free)
    #0 0x5059c9 in zip_source_open /src/libzip/lib/zip_source_open.c:39:14
    #1 0x50585e in zip_source_open /src/libzip/lib/zip_source_open.c:55:17
    #2 0x4faebf in zip_check_torrentzip /src/libzip/lib/zip_open.c:932:13
    #3 0x4faebf in _zip_open /src/libzip/lib/zip_open.c:187:5
    #4 0x4f86f8 in zip_open_from_source /src/libzip/lib/zip_open.c:134:18
    #5 0x4dc041 in LLVMFuzzerTestOneInput /src/libzip/regress/zip_read_fuzzer.cc:22:15
    #6 0x4dc77b in main (/out/zip_read_fuzzer+0x4dc77b)
    #7 0x7d0a85c48082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #8 0x41d69d in _start (/out/zip_read_fuzzer+0x41d69d)

DEDUP_TOKEN: zip_source_open--zip_source_open--zip_check_torrentzip
0x6080000000d8 is located 56 bytes inside of 88-byte region [0x6080000000a0,0x6080000000f8)
freed by thread T0 here:
    #0 0x49e832 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3
    #1 0x504164 in zip_source_free /src/libzip/lib/zip_source_free.c:70:5
    #2 0x4faeb2 in zip_check_torrentzip /src/libzip/lib/zip_open.c
    #3 0x4faeb2 in _zip_open /src/libzip/lib/zip_open.c:187:5
    #4 0x4f86f8 in zip_open_from_source /src/libzip/lib/zip_open.c:134:18
    #5 0x4dc041 in LLVMFuzzerTestOneInput /src/libzip/regress/zip_read_fuzzer.cc:22:15
    #6 0x4dc77b in main (/out/zip_read_fuzzer+0x4dc77b)

DEDUP_TOKEN: free--zip_source_free--zip_check_torrentzip
previously allocated by thread T0 here:
    #0 0x49ead6 in __interceptor_malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:69:3
    #1 0x504531 in _zip_source_new /src/libzip/lib/zip_source_function.c:80:32
    #2 0x5055b7 in zip_source_layered_create /src/libzip/lib/zip_source_layered.c:62:15
    #3 0x5088fd in _zip_source_window_new /src/libzip/lib/zip_source_window.c:117:21
    #4 0x4fae8c in zip_check_torrentzip /src/libzip/lib/zip_open.c:924:27
    #5 0x4fae8c in _zip_open /src/libzip/lib/zip_open.c:187:5
    #6 0x4f86f8 in zip_open_from_source /src/libzip/lib/zip_open.c:134:18
    #7 0x4dc041 in LLVMFuzzerTestOneInput /src/libzip/regress/zip_read_fuzzer.cc:22:15
    #8 0x4dc77b in main (/out/zip_read_fuzzer+0x4dc77b)

DEDUP_TOKEN: __interceptor_malloc--_zip_source_new--zip_source_layered_create
SUMMARY: AddressSanitizer: heap-use-after-free /src/libzip/lib/zip_source_open.c:39:14 in zip_source_open
Shadow bytes around the buggy address:
  0x0c107fff7fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c107fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c107fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c107fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c107fff8000: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa
=>0x0c107fff8010: fa fa fa fa fd fd fd fd fd fd fd[fd]fd fd fd fa
  0x0c107fff8020: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa
  0x0c107fff8030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c107fff8040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c107fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c107fff8060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==13==ABORTING
