INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2270619470
INFO: Loaded 2 modules   (171596 inline 8-bit counters): 142700 [0x98bd2a0, 0x98e000c), 28896 [0xe7bb4200, 0xe7bbb2e0), 
INFO: Loaded 2 PC tables (171596 PCs): 142700 [0x98e000c,0x99f6b6c), 28896 [0xe7bbb2e0,0xe7bf39e0), 
/out/php-fuzz-tracing-jit: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: heap-use-after-free on address 0xe770a2f4 at pc 0x08c2f40e bp 0xffea4868 sp 0xffea4860
READ of size 4 at 0xe770a2f4 thread T0
SCARINESS: 45 (4-byte-read-heap-use-after-free)
    #0 0x8c2f40d in _zend_hash_del_el /src/php-src/Zend/zend_hash.c:1435:9
    #1 0x8c2f40d in zend_hash_reverse_apply /src/php-src/Zend/zend_hash.c:2156:5
    #2 0x8b60171 in shutdown_destructors /src/php-src/Zend/zend_execute_API.c:252:4
    #3 0x8bbfe22 in zend_call_destructors /src/php-src/Zend/zend.c:1225:3
    #4 0x89bfdd0 in php_request_shutdown /src/php-src/main/main.c:1808:3
    #5 0x911026a in fuzzer_request_shutdown /src/php-src/sapi/fuzzer/fuzzer-sapi.c:208:2
    #6 0x91109c0 in fuzzer_do_request_from_buffer /src/php-src/sapi/fuzzer/fuzzer-sapi.c:288:2
    #7 0x910ecc8 in LLVMFuzzerTestOneInput /src/php-src/sapi/fuzzer/fuzzer-tracing-jit.c:34:2
    #8 0x82395ce in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #9 0x8224a4e in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #10 0x822a600 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned int)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #11 0x82537e7 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #12 0xeb096ed4 in __libc_start_main (/lib32/libc.so.6+0x1aed4)
    #13 0x8202655 in _start (/out/php-fuzz-tracing-jit+0x8202655)

DEDUP_TOKEN: _zend_hash_del_el--zend_hash_reverse_apply--shutdown_destructors
0xe770a2f4 is located 628 bytes inside of 2048-byte region [0xe770a080,0xe770a880)
freed by thread T0 here:
    #0 0x8310796 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3
    #1 0x8acef99 in tracked_free /src/php-src/Zend/zend_alloc.c:2779:2
    #2 0x8ac58b5 in _efree_custom /src/php-src/Zend/zend_alloc.c:2436:3
    #3 0x8ac58b5 in _efree /src/php-src/Zend/zend_alloc.c:2556:3
    #4 0x8c3a2b0 in zend_hash_do_resize /src/php-src/Zend/zend_hash.c:1239:3
    #5 0x8c18634 in _zend_hash_add_or_update_i /src/php-src/Zend/zend_hash.c:799:2
    #6 0x8c18293 in zend_hash_add_new /src/php-src/Zend/zend_hash.c:930:9
    #7 0x8e99268 in zend_fetch_var_address_helper_SPEC_TMPVAR_UNUSED /src/php-src/Zend/zend_vm_execute.h:17635:13
    #8 0x8d84cb1 in ZEND_FETCH_W_SPEC_TMPVAR_UNUSED_HANDLER /src/php-src/Zend/zend_vm_execute.h:17694:2
    #9 0x910f652 in fuzzer_execute_ex /src/php-src/sapi/fuzzer/fuzzer-execute-common.h:53:14
    #10 0x8b6a4a4 in zend_call_function /src/php-src/Zend/zend_execute_API.c:903:3
    #11 0x8b6d1b2 in zend_call_known_function /src/php-src/Zend/zend_execute_API.c:992:23
    #12 0x8f579fa in zend_call_known_instance_method /src/php-src/Zend/zend_API.h:676:2
    #13 0x8f579fa in zend_call_known_instance_method_with_0_params /src/php-src/Zend/zend_API.h:682:2
    #14 0x8f579fa in zend_objects_destroy_object /src/php-src/Zend/zend_objects.c:170:3
    #15 0x8f70f08 in zend_objects_store_del /src/php-src/Zend/zend_objects_API.c:184:4
    #16 0x8bb5dd2 in rc_dtor_func /src/php-src/Zend/zend_variables.c:57:2
    #17 0x8bb5dd2 in i_zval_ptr_dtor /src/php-src/Zend/zend_variables.h:44:4
    #18 0x8bb5dd2 in zval_ptr_dtor /src/php-src/Zend/zend_variables.c:84:2
    #19 0x8c1ecbd in _zend_hash_del_el_ex /src/php-src/Zend/zend_hash.c:1411:3
    #20 0x8c2e36a in _zend_hash_del_el /src/php-src/Zend/zend_hash.c:1434:2
    #21 0x8c2e36a in zend_hash_reverse_apply /src/php-src/Zend/zend_hash.c:2156:5
    #22 0x8b60171 in shutdown_destructors /src/php-src/Zend/zend_execute_API.c:252:4
    #23 0x8bbfe22 in zend_call_destructors /src/php-src/Zend/zend.c:1225:3
    #24 0x89bfdd0 in php_request_shutdown /src/php-src/main/main.c:1808:3
    #25 0x911026a in fuzzer_request_shutdown /src/php-src/sapi/fuzzer/fuzzer-sapi.c:208:2
    #26 0x91109c0 in fuzzer_do_request_from_buffer /src/php-src/sapi/fuzzer/fuzzer-sapi.c:288:2
    #27 0x910ecc8 in LLVMFuzzerTestOneInput /src/php-src/sapi/fuzzer/fuzzer-tracing-jit.c:34:2
    #28 0x82395ce in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #29 0x8224a4e in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #30 0x822a600 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned int)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #31 0x82537e7 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #32 0xeb096ed4 in __libc_start_main (/lib32/libc.so.6+0x1aed4)

DEDUP_TOKEN: free--tracked_free--_efree_custom
previously allocated by thread T0 here:
    #0 0x8310a15 in __interceptor_malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:129:3
    #1 0x8ac2792 in tracked_malloc /src/php-src/Zend/zend_alloc.c:2760:14
    #2 0x8ac559e in _malloc_custom /src/php-src/Zend/zend_alloc.c:2427:10
    #3 0x8ac559e in _emalloc /src/php-src/Zend/zend_alloc.c:2546:10
    #4 0x8c0f6c8 in zend_hash_real_init_mixed_ex /src/php-src/Zend/zend_hash.c:214:10
    #5 0x8c0f6c8 in zend_hash_real_init_mixed /src/php-src/Zend/zend_hash.c:330:2
    #6 0x8c18b2c in _zend_hash_add_or_update_i /src/php-src/Zend/zend_hash.c:756:4
    #7 0x8c182d3 in zend_hash_update /src/php-src/Zend/zend_hash.c:920:9
    #8 0x89f84e4 in php_auto_globals_create_get /src/php-src/main/php_variables.c:739:2
    #9 0x8ad7e1e in zend_activate_auto_globals /src/php-src/Zend/zend_compile.c:1733:25
    #10 0x89f7d51 in php_hash_environment /src/php-src/main/php_variables.c:722:2
    #11 0x89bf86f in php_request_startup /src/php-src/main/main.c:1767:3
    #12 0x911069c in fuzzer_request_startup /src/php-src/sapi/fuzzer/fuzzer-sapi.c:179:6
    #13 0x911069c in fuzzer_do_request_from_buffer /src/php-src/sapi/fuzzer/fuzzer-sapi.c:254:6
    #14 0x910ecc8 in LLVMFuzzerTestOneInput /src/php-src/sapi/fuzzer/fuzzer-tracing-jit.c:34:2
    #15 0x82395ce in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #16 0x8224a4e in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #17 0x822a600 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned int)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #18 0x82537e7 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #19 0xeb096ed4 in __libc_start_main (/lib32/libc.so.6+0x1aed4)

DEDUP_TOKEN: __interceptor_malloc--tracked_malloc--_malloc_custom
SUMMARY: AddressSanitizer: heap-use-after-free /src/php-src/Zend/zend_hash.c:1435:9 in _zend_hash_del_el
Shadow bytes around the buggy address:
  0x3cee1400: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x3cee1410: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3cee1420: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3cee1430: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3cee1440: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
=>0x3cee1450: fd fd fd fd fd fd fd fd fd fd fd fd fd fd[fd]fd
  0x3cee1460: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3cee1470: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3cee1480: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3cee1490: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x3cee14a0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==13==ABORTING
