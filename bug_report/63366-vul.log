INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2211190759
INFO: Loaded 1 modules   (320155 inline 8-bit counters): 320155 [0x2ee5c30, 0x2f33ecb), 
INFO: Loaded 1 PC tables (320155 PCs): 320155 [0x2f33ed0,0x3416880), 
/out/encoder_miff_fuzzer: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: attempting free on address which was not malloc()-ed: 0x631000000800 in thread T0
SCARINESS: 40 (bad-free)
    #0 0x907702 in __interceptor_free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3
    #1 0xc793af in RelinquishMagickMemory /src/imagemagick/MagickCore/memory.c:1167:3
    #2 0xab5f98 in ImagesToBlob /src/imagemagick/MagickCore/blob.c:2503:29
    #3 0x9ac5cf in Magick::Image::write(Magick::Blob*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) /src/imagemagick/Magick++/lib/Image.cpp:4925:8
    #4 0x946b12 in LLVMFuzzerTestOneInput /src/imagemagick/Magick++/fuzz/encoder_fuzzer.cc:90:11
    #5 0x816633 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15
    #6 0x801142 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #7 0x8069ec in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9
    #8 0x830b72 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #9 0x704dd83b1082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 87b331c034a6458c64ce09c03939e947212e18ce)
    #10 0x7f730d in _start (/out/encoder_miff_fuzzer+0x7f730d)

DEDUP_TOKEN: __interceptor_free--RelinquishMagickMemory--ImagesToBlob
Address 0x631000000800 is a wild pointer inside of access range of size 0x000000000001.
SUMMARY: AddressSanitizer: bad-free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3 in __interceptor_free
==13==ABORTING
