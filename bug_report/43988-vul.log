INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 2257129090
INFO: Loaded 2 modules   (174777 inline 8-bit counters): 141679 [0x1b5d400, 0x1b7fd6f), 33098 [0x712634d69de0, 0x712634d71f2a), 
INFO: Loaded 2 PC tables (174777 PCs): 141679 [0x1b7fd70,0x1da9460), 33098 [0x712634d71f30,0x712634df33d0), 
/out/php-fuzz-function-jit: Running 1 inputs 1 time(s) each.
Running: /tmp/poc
=================================================================
==13==ERROR: AddressSanitizer: heap-use-after-free on address 0x604000028470 at pc 0x00000116bf72 bp 0x7ffff09f8ef0 sp 0x7ffff09f8ee8
READ of size 8 at 0x604000028470 thread T0
SCARINESS: 51 (8-byte-read-heap-use-after-free)
    #0 0x116bf71 in zend_std_get_property_ptr_ptr /src/php-src/Zend/zend_object_handlers.c:1065:8
    #1 0x10b68e9 in zend_fetch_property_address /src/php-src/Zend/zend_execute.c:2878:8
    #2 0xfe9129 in ZEND_FETCH_OBJ_W_SPEC_CV_CONST_HANDLER /src/php-src/Zend/zend_vm_execute.h:40112:2
    #3 0x12d9f99 in fuzzer_execute_ex /src/php-src/sapi/fuzzer/fuzzer-execute-common.h:53:14
    #4 0xf1852b in zend_execute /src/php-src/Zend/zend_vm_execute.h:59037:2
    #5 0x12db0dd in fuzzer_do_request_from_buffer /src/php-src/sapi/fuzzer/fuzzer-sapi.c:276:5
    #6 0x12d9735 in LLVMFuzzerTestOneInput /src/php-src/sapi/fuzzer/fuzzer-function-jit.c:34:2
    #7 0x639813 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) cxa_noexception.cpp
    #8 0x625122 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #9 0x62abea in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) cxa_noexception.cpp
    #10 0x653b12 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #11 0x712635eb8082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)
    #12 0x6023ad in _start (/out/php-fuzz-function-jit+0x6023ad)

DEDUP_TOKEN: zend_std_get_property_ptr_ptr--zend_fetch_property_address--ZEND_FETCH_OBJ_W_SPEC_CV_CONST_HANDLER
0x604000028470 is located 32 bytes inside of 40-byte region [0x604000028450,0x604000028478)
freed by thread T0 here:
    #0 0x708772 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:111:3
    #1 0xdaf325 in tracked_free /src/php-src/Zend/zend_alloc.c:2771:2
    #2 0xda7288 in _efree_custom /src/php-src/Zend/zend_alloc.c:2428:3
    #3 0xda7288 in _efree /src/php-src/Zend/zend_alloc.c:2548:3
    #4 0x1174a3b in zend_objects_store_del /src/php-src/Zend/zend_objects_API.c:204:3
    #5 0xe719f4 in rc_dtor_func /src/php-src/Zend/zend_variables.c:57:2
    #6 0x10af0e8 in zend_assign_to_variable /src/php-src/Zend/zend_execute.h:158:5
    #7 0xf4243a in ZEND_ASSIGN_SPEC_VAR_CONST_RETVAL_UNUSED_HANDLER /src/php-src/Zend/zend_vm_execute.h:23865:10
    #8 0x12d9f99 in fuzzer_execute_ex /src/php-src/sapi/fuzzer/fuzzer-execute-common.h:53:14
    #9 0xe33b36 in zend_call_function /src/php-src/Zend/zend_execute_API.c:903:3
    #10 0xe312c7 in _call_user_function_impl /src/php-src/Zend/zend_execute_API.c:701:9
    #11 0xe7b68d in zend_error_zstr_at /src/php-src/Zend/zend.c:1408:8
    #12 0xe7c780 in zend_error_va_list /src/php-src/Zend/zend.c:1456:2
    #13 0xe7cb19 in zend_error /src/php-src/Zend/zend.c:1523:2
    #14 0x116bf5a in zend_deprecated_dynamic_property /src/php-src/Zend/zend_object_handlers.c:282:2
    #15 0x116bf5a in zend_std_get_property_ptr_ptr /src/php-src/Zend/zend_object_handlers.c:1063:5
    #16 0x10b68e9 in zend_fetch_property_address /src/php-src/Zend/zend_execute.c:2878:8
    #17 0xfe9129 in ZEND_FETCH_OBJ_W_SPEC_CV_CONST_HANDLER /src/php-src/Zend/zend_vm_execute.h:40112:2
    #18 0x12d9f99 in fuzzer_execute_ex /src/php-src/sapi/fuzzer/fuzzer-execute-common.h:53:14
    #19 0xf1852b in zend_execute /src/php-src/Zend/zend_vm_execute.h:59037:2
    #20 0x12db0dd in fuzzer_do_request_from_buffer /src/php-src/sapi/fuzzer/fuzzer-sapi.c:276:5
    #21 0x12d9735 in LLVMFuzzerTestOneInput /src/php-src/sapi/fuzzer/fuzzer-function-jit.c:34:2
    #22 0x639813 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) cxa_noexception.cpp
    #23 0x625122 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #24 0x62abea in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) cxa_noexception.cpp
    #25 0x653b12 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #26 0x712635eb8082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)

DEDUP_TOKEN: free--tracked_free--_efree_custom
previously allocated by thread T0 here:
    #0 0x7089dd in __interceptor_malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:129:3
    #1 0xda47af in tracked_malloc /src/php-src/Zend/zend_alloc.c:2752:14
    #2 0xda6fa7 in _malloc_custom /src/php-src/Zend/zend_alloc.c:2419:10
    #3 0xda6fa7 in _emalloc /src/php-src/Zend/zend_alloc.c:2538:10
    #4 0x115fdad in zend_objects_new /src/php-src/Zend/zend_objects.c:186:24
    #5 0xe94179 in _object_and_properties_init /src/php-src/Zend/zend_API.c:1662:22
    #6 0xe94a22 in object_init_ex /src/php-src/Zend/zend_API.c:1685:9
    #7 0xfbffc3 in ZEND_NEW_SPEC_VAR_UNUSED_HANDLER /src/php-src/Zend/zend_vm_execute.h:28461:6
    #8 0x12d9f99 in fuzzer_execute_ex /src/php-src/sapi/fuzzer/fuzzer-execute-common.h:53:14
    #9 0xf1852b in zend_execute /src/php-src/Zend/zend_vm_execute.h:59037:2
    #10 0x12db0dd in fuzzer_do_request_from_buffer /src/php-src/sapi/fuzzer/fuzzer-sapi.c:276:5
    #11 0x12d9735 in LLVMFuzzerTestOneInput /src/php-src/sapi/fuzzer/fuzzer-function-jit.c:34:2
    #12 0x639813 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) cxa_noexception.cpp
    #13 0x625122 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6
    #14 0x62abea in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) cxa_noexception.cpp
    #15 0x653b12 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10
    #16 0x712635eb8082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)

DEDUP_TOKEN: __interceptor_malloc--tracked_malloc--_malloc_custom
SUMMARY: AddressSanitizer: heap-use-after-free /src/php-src/Zend/zend_object_handlers.c:1065:8 in zend_std_get_property_ptr_ptr
Shadow bytes around the buggy address:
  0x0c087fffd030: fa fa fd fd fd fd fd fa fa fa 00 00 00 00 00 00
  0x0c087fffd040: fa fa 00 00 00 00 00 00 fa fa 00 00 00 00 00 fa
  0x0c087fffd050: fa fa 00 00 00 00 07 fa fa fa fd fd fd fd fd fa
  0x0c087fffd060: fa fa fd fd fd fd fd fa fa fa fd fd fd fd fd fd
  0x0c087fffd070: fa fa fd fd fd fd fd fa fa fa fd fd fd fd fd fd
=>0x0c087fffd080: fa fa 00 00 00 00 00 00 fa fa fd fd fd fd[fd]fa
  0x0c087fffd090: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c087fffd0a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c087fffd0b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c087fffd0c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c087fffd0d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==13==ABORTING
